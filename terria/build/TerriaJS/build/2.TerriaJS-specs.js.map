{"version":3,"sources":["webpack:///./node_modules/terriajs-cesium/Source/Core/CornerType.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositeProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositePositionProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/ReferenceProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/ScaledPositionProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PositionPropertyArray.js","webpack:///./node_modules/terriajs-cesium/Source/Core/HermitePolynomialApproximation.js","webpack:///./node_modules/terriajs-cesium/Source/Core/LagrangePolynomialApproximation.js","webpack:///./node_modules/terriajs-cesium/Source/Core/Spherical.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CheckerboardMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CompositeMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/GridMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineArrowMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineDashMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PolylineOutlineMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/PropertyArray.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/Rotation.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/StripeOrientation.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/StripeMaterialProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/VelocityVectorProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/VelocityOrientationProperty.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/CzmlDataSource.js","webpack:///./node_modules/terriajs-cesium/Source/ThirdParty/Autolinker.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlCamera.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlLookAt.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTour.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTourFlyTo.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlTourWait.js","webpack:///./node_modules/terriajs-cesium/Source/DataSources/KmlDataSource.js"],"names":["ROUNDED","MITERED","BEVELED","CompositeProperty","this","_eventHelper","_definitionChanged","_intervals","changedEvent","addEventListener","prototype","_intervalsChanged","isConstant","get","isEmpty","definitionChanged","intervals","getValue","time","result","innerProperty","findDataForIntervalContainingDate","equals","other","property","eventHelper","callback","raiseEvent","items","removeAll","length","i","interval","data","indexOf","add","subscribeAll","CompositePositionProperty","referenceFrame","_referenceFrame","FIXED","_composite","_raiseDefinitionChanged","set","value","getValueInReferenceFrame","resolve","that","targetProperty","_targetProperty","_resolveProperty","entityIsResolved","_resolveEntity","targetEntity","_targetCollection","getById","_targetId","ReferenceProperty","_onTargetEntityDefinitionChanged","_targetEntity","resolveEntity","names","_targetPropertyNames","join","targetCollection","targetId","targetPropertyNames","undefined","collectionChanged","_onCollectionChanged","resolvedProperty","fromString","referenceString","identifier","values","inIdentifier","isEscaped","token","c","charAt","push","getType","otherNames","name","oldValue","collection","added","removed","removeEventListener","ScaledPositionProperty","_value","_removeSubscription","setValue","WGS84","scaleToGeodeticSurface","PositionPropertyArray","Array","x","itemValue","slice","arrayEquals","factorial","calculateCoefficientTerm","zIndices","xTable","derivOrder","termOrder","reservedIndices","reserved","j","splice","HermitePolynomialApproximation","type","degree","inputOrder","defaultValue","Math","max","floor","yTable","yStride","d","s","index","defined","coefficients","l","zIndicesLength","highestNonZeroCoef","nonZeroCoefficients","numerator","zj","zn","tempTerm","coeff","arrayScratch","interpolate","outputOrder","resultLength","r","zIndiceslength","highestNonZero","tmp","dimOne","coefIndex","dimTwo","coefficient","dimTwoMinusOne","fillCoefficientList","loopStop","min","coef","LagrangePolynomialApproximation","diffX","Spherical","clock","cone","magnitude","fromCartesian3","cartesian3","y","z","radialSquared","atan2","sqrt","clone","spherical","normalize","left","right","equalsEpsilon","epsilon","abs","toString","defaultEvenColor","Color","WHITE","defaultOddColor","BLACK","defaultRepeat","Cartesian2","CheckerboardMaterialProperty","options","EMPTY_OBJECT","Event","_evenColor","_evenColorSubscription","_oddColor","_oddColorSubscription","_repeat","_repeatSubscription","evenColor","oddColor","repeat","defineProperties","Property","createPropertyDescriptor","lightColor","getValueOrClonedDefault","darkColor","getValueOrDefault","CompositeMaterialProperty","defaultColor","defaultLineCount","defaultLineOffset","defaultLineThickness","GridMaterialProperty","_color","_colorSubscription","_cellAlpha","_cellAlphaSubscription","_lineCount","_lineCountSubscription","_lineThickness","_lineThicknessSubscription","_lineOffset","_lineOffsetSubscription","color","cellAlpha","lineCount","lineThickness","lineOffset","PolylineArrowMaterialProperty","defaultGapColor","TRANSPARENT","PolylineDashMaterialProperty","_gapColor","_gapColorSubscription","_dashLength","_dashLengthSubscription","_dashPattern","_dashPatternSubscription","gapColor","dashLength","dashPattern","defaultOutlineColor","PolylineOutlineMaterialProperty","_outlineColor","_outlineColorSubscription","_outlineWidth","_outlineWidthSubscription","outlineColor","outlineWidth","PropertyArray","EventHelper","packedLength","pack","array","startingIndex","unpack","convertPackedArrayForInterpolation","packedArray","lastIndex","previousValue","len","PI","TWO_PI","unpackInterpolationResult","sourceArray","firstIndex","freezeObject","HORIZONTAL","VERTICAL","defaultOrientation","StripeMaterialProperty","_orientation","_orientationSubscription","_offset","_offsetSubscription","orientation","offset","horizontal","VelocityVectorProperty","position","_position","_subscription","_normalize","position1Scratch","Cartesian3","position2Scratch","timeScratch","JulianDate","_getValue","velocityResult","positionResult","ZERO","position1","position2","addSeconds","velocity","subtract","divideByScalar","VelocityOrientationProperty","ellipsoid","_velocityVectorProperty","_ellipsoid","Ellipsoid","positionScratch","velocityScratch","rotationScratch","Matrix3","Transforms","rotationMatrixFromPositionVelocity","Quaternion","fromRotationMatrix","currentId","UnitCartesian3","createReferenceProperty","entityCollection","createSpecializedProperty","packetData","reference","velocityReference","referenceProperty","RuntimeError","JSON","stringify","scratchCartesian","scratchSpherical","scratchCartographic","Cartographic","scratchTimeInterval","TimeInterval","scratchQuaternion","unwrapUriInterval","czmlInterval","sourceUri","uri","getDerivedResource","url","Resource","createIfNeeded","unwrapCartesianInterval","cartesian","cartesianVelocity","unitCartesian","unitSpherical","fromSpherical","convertUnitSphericalToCartesian","convertSphericalToCartesian","cartographicRadians","longitude","latitude","height","cartographicToCartesian","convertCartographicRadiansToCartesian","cartographicDegrees","toRadians","convertCartographicDegreesToCartesian","normalizePackedCartesianArray","normalizePackedQuaternionArray","getPropertyType","Boolean","Number","String","hasOwnProperty","BoundingRectangle","ArcType","ClassificationType","ColorBlendMode","CornerType","HeightReference","HorizontalOrigin","LabelStyle","NearFarScalar","DistanceDisplayCondition","Object","ShadowMode","Rectangle","Uri","VerticalOrigin","unwrapInterval","arcType","boundingRectangle","cartesian2","unwrapUnitCartesianInterval","rgbaf","rgba","byteToFloat","unwrapColorInterval","classificationType","colorBlendMode","cornerType","heightReference","horizontalOrigin","Image","fromIso8601","date","labelStyle","number","nearFarScalar","distanceDisplayCondition","object","unitQuaternion","unwrapQuaternionInterval","wsen","wsenDegrees","unwrapRectangleInterval","shadowMode","shadows","string","stripeOrientation","verticalOrigin","interpolators","HERMITE","LAGRANGE","LINEAR","LinearApproximation","updateInterpolationSettings","interpolationAlgorithm","interpolationDegree","setInterpolationOptions","forwardExtrapolationType","ExtrapolationType","forwardExtrapolationDuration","backwardExtrapolationType","backwardExtrapolationDuration","iso8601Scratch","iso8601","intervalFromString","intervalString","wrapPropertyInInfiniteInterval","Iso8601","MAXIMUM_INTERVAL","convertPropertyToComposite","composite","addInterval","convertPositionPropertyToComposite","processProperty","propertyName","constrainedInterval","unwrappedInterval","unwrappedIntervalLength","combinedInterval","intersect","isValue","hasInterval","delete","removePropertyData","SampledProperty","removeSamples","TimeIntervalCollectionProperty","removeInterval","intersection","isSampled","needsUnpacking","epoch","packetEpoch","addSamplesPackedArray","ConstantProperty","findInterval","processPacketData","isArray","processPositionProperty","numberOfDerivatives","removePositionPropertyData","SampledPositionProperty","TimeIntervalCollectionPositionProperty","ReferenceFrame","ConstantPositionProperty","processPositionPacketData","processMaterialProperty","existingMaterial","existingInterval","materialData","thisIntervals","start","stop","solidColor","ColorMaterialProperty","grid","image","ImageMaterialProperty","transparent","stripe","polylineOutline","polylineGlow","PolylineGlowMaterialProperty","glowPower","taperPower","polylineArrow","polylineDash","checkerboard","processMaterialPacketData","processReferencesArrayPacketData","references","PropertyArrayType","CompositePropertyArrayType","properties","map","processArrayPacketData","processArray","processPositionArrayPacketData","unpackArray","fromRadiansArrayHeights","fromDegreesArrayHeights","processPositionArray","unpackCartesianArray","unpackCartographicRadiansArray","unpackCartographicDegreesArray","processPositionArrayOfArraysPacketData","referenceArray","tempObj","positions","processNodeTransformations","model","nodeTransformationsData","nodeTransformations","nodeNames","keys","nodeName","nodeTransformationData","PropertyBag","hasProperty","addProperty","nodeTransformation","NodeTransformationProperty","translation","rotation","scale","processArticulations","articulationsData","articulations","key","articulationStageData","PolygonHierarchyProperty","polygon","adaptFollowSurfaceToArcType","followSurface","GEODESIC","NONE","processCzmlPacket","packet","updaterFunctions","dataSource","objectId","id","createGuid","_version","removeById","version","tokens","split","documentPacket","_documentPacket","clockPacket","currentTime","range","step","multiplier","processDocument","entity","getOrCreateEntity","parentId","parent","load","czml","clear","promise","credit","Credit","_credit","fetchJson","resourceCredits","_resourceCredits","credits","DataSource","setLoading","when","_entityCollection","DocumentPacket","CzmlDataSource","_processCzml","raiseChangedEvent","_clock","availability","computeAvailability","MINIMUM_VALUE","startTime","stopTime","totalSeconds","secondsDifference","round","DataSourceClock","clockRange","ClockRange","LOOP_STOP","clockStep","ClockStep","SYSTEM_CLOCK_MULTIPLIER","MAXIMUM_VALUE","updateClock","_name","getFilenameFromUri","getUrlComponent","_changed","loadCzml","otherwise","error","_error","console","log","reject","_isLoading","_loading","EntityCollection","_entityCluster","EntityCluster","_positions","holes","_holes","holePositions","PolygonHierarchy","entities","isLoading","errorEvent","loadingEvent","show","clustering","updaters","billboardData","billboard","BillboardGraphics","pixelOffset","eyeOffset","processAlignedAxis","alignedAxis","sizeInMeters","width","scaleByDistance","translucencyByDistance","pixelOffsetScaleByDistance","imageSubRegion","disableDepthTestDistance","boxData","box","BoxGraphics","dimensions","fill","material","outline","corridorData","corridor","CorridorGraphics","extrudedHeight","extrudedHeightReference","granularity","zIndex","cylinderData","cylinder","CylinderGraphics","topRadius","bottomRadius","numberOfVerticalLines","slices","ellipseData","ellipse","EllipseGraphics","semiMajorAxis","semiMinorAxis","stRotation","ellipsoidData","EllipsoidGraphics","radii","innerRadii","minimumClock","maximumClock","minimumCone","maximumCone","stackPartitions","slicePartitions","subdivisions","labelData","label","LabelGraphics","text","font","style","showBackground","backgroundColor","backgroundPadding","fillColor","modelData","ModelGraphics","gltf","minimumPixelSize","maximumScale","incrementallyLoadTextures","runAnimations","clampAnimations","silhouetteColor","silhouetteSize","colorBlendAmount","nameData","descriptionData","description","pathData","path","PathGraphics","leadTime","trailTime","resolution","pointData","point","PointGraphics","pixelSize","polygonData","PolygonGraphics","processPositionArrayOfArrays","hierarchy","perPositionHeight","closeTop","closeBottom","polylineData","polyline","adapterFunction","PolylineGraphics","depthFailMaterial","clampToGround","CallbackProperty","propertiesData","propertyData","rectangleData","rectangle","RectangleGraphics","coordinates","positionData","viewFromData","viewFrom","wallData","wall","WallGraphics","minimumHeights","maximumHeights","orientationData","TimeIntervalCollection","process","Autolinker","arr","element","remove","fn","throwUnhandledCaseError","theValue","Error","HtmlTag","cfg","tagName","attrs","innerHTML","whitespaceRegex","innerHtml","setTagName","getTagName","setAttr","attrName","attrValue","getAttrs","getAttr","setAttrs","assign","setClass","cssClass","addClass","newClass","classAttr","getClass","classes","newClasses","shift","removeClass","removeClasses","idx","hasClass","setInnerHTML","html","setInnerHtml","getInnerHTML","getInnerHtml","toAnchorString","attrsStr","buildAttrsStr","attrsArr","prop","AnchorTagBuilder","newWindow","truncate","className","build","match","createAttrs","processAnchorText","getAnchorText","getAnchorHref","createCssClass","returnClasses","cssClassSuffixes","getCssClassSuffixes","anchorText","doTruncate","truncateLength","truncateLocation","location","truncateLen","ellipsisChars","ellipsisLengthBeforeParsing","ellipsisLength","buildUrl","urlObj","scheme","host","query","fragment","buildSegment","segment","remainingAvailableLength","remainingAvailableLengthHalf","startOffset","ceil","endOffset","end","substr","availableLength","urlSub","parse_url","matchQuery","replace","str","pathAndQuery","truncateSmart","truncateMiddle","substring","ellipsis","truncateEnd","Match","__jsduckDummyDocProp","matchedText","tagBuilder","getMatchedText","setOffset","getOffset","buildTag","extendStatics","b","setPrototypeOf","__proto__","p","__extends","__","constructor","create","__assign","t","n","arguments","call","apply","EmailMatch","_super","_this","email","getEmail","HashtagMatch","serviceName","hashtag","getServiceName","getHashtag","MentionMatch","mention","getMention","PhoneMatch","plusSign","getPhoneNumber","getNumber","UrlMatch","urlMatchType","protocolUrlMatch","protocolRelativeMatch","stripPrefix","www","stripTrailingSlash","decodePercentEncoding","schemePrefixRegex","wwwPrefixRegex","protocolRelativeRegex","protocolPrepended","getUrlMatchType","getUrl","stripProtocolRelativePrefix","stripSchemePrefix","stripWwwPrefix","removeTrailingSlash","removePercentEncoding","preProcessedEntityAnchorText","decodeURIComponent","e","Matcher","letterRe","digitRe","whitespaceRe","quoteRe","controlCharsRe","alphaCharsStr","source","alphaCharsAndMarksStr","decimalNumbersStr","alphaNumericCharsStr","alphaNumericAndMarksCharsStr","ipStr","domainLabelStr","getDomainLabelStr","group","getDomainNameStr","domainNameCharRegex","RegExp","tldRegex","EmailMatcher","localPartCharRegex","strictTldRegex","parseMatches","matches","noCurrentEmailMatch","CurrentEmailMatch","mailtoTransitions","charIdx","state","currentEmailMatch","char","stateNonEmailAddress","stateMailTo","stateLocalPart","stateLocalPartDot","stateAtSign","stateDomainChar","stateDomainHyphen","stateDomainDot","captureMatchIfValidAndReset","beginEmailMatch","test","prevChar","hasMailtoPrefix","resetToNonEmailMatchState","hasDomainDot","newState","emailAddress","emailAddressNormalized","pop","toLowerCase","doesEmailHaveValidTld","UrlMatchValidator","isValid","urlMatch","isValidUriScheme","urlMatchDoesNotHaveProtocolOrDot","urlMatchDoesNotHaveAtLeastOneWordChar","isValidIpAddress","containsMultipleDots","uriSchemeMatch","newRegex","hasFullProtocolRegex","ipRegex","stringBeforeSlash","uriSchemeMatchArr","uriSchemeRegex","uriScheme","hasWordCharAfterProtocolRegex","UrlMatcher","urlSuffixRegex","matcherRegex","wordCharRegExp","_loop_1","matchStr","schemeUrlMatch","wwwUrlMatch","wwwProtocolRelativeMatch","tldProtocolRelativeMatch","this_1","matchHasUnbalancedClosingParen","pos","matchHasInvalidCharAfterTld","foundCommonScheme","find","commonScheme","indexOfSchemeStart","exec","startChar","endChar","numOpenBraces","res","HashtagMatcher","nonWordCharRegex","PhoneMatcher","cleanNumber","before","after","contextClear","testMatch","MentionMatcher","matcherRegexes","parseHtml","_a","onOpenTag","onCloseTag","onText","onComment","onDoctype","noCurrentTag","CurrentTag","currentDataIdx","currentTag","stateData","stateTagOpen","stateEndTagOpen","stateTagName","stateBeforeAttributeName","stateAttributeName","stateAfterAttributeName","stateBeforeAttributeValue","stateAttributeValueDoubleQuoted","stateAttributeValueSingleQuoted","stateAttributeValueUnquoted","stateAfterAttributeValueQuoted","stateSelfClosingStartTag","toUpperCase","resetToDataState","stateCommentStart","stateCommentStartDash","stateComment","stateCommentEndDash","stateCommentEnd","stateCommentEndBang","stateDoctype","startNewTag","isClosing","isOpening","captureTagName","emitTagAndPreviousTextNode","textBeforeTag","startIdx","urls","phone","replaceFn","context","matchers","normalizeUrlsCfg","normalizeStripPrefixCfg","normalizeTruncateCfg","link","textOrHtml","parse","schemeMatches","wwwMatches","tldMatches","dest","src","defaults","POSITIVE_INFINITY","skipTagNames","skipTagsStackCount","textSplit","splitRegex","global","lastIdx","splitAndCapture","currentOffset_1","forEach","splitText","textNodeMatches","parseText","compactMatches","removeUnwantedMatches","sort","a","matchedTextLength","endIdx","removeIdx","m","getMatchers","numMatchers","textMatches","numTextMatches","newHtml","createMatchReturnVal","replaceFnResult","getTagBuilder","matcher","Email","Hashtag","Mention","Phone","Url","factory","headingPitchRoll","headingPitchRange","KmlTour","playlistIndex","playlist","tourStart","tourEnd","entryStart","entryEnd","_activeEntries","cancelAllEntries","activeEntries","entry","playEntry","viewer","cameraOptions","allDone","_playNext","playNext","bind","blocking","play","scene","camera","tour","indx","terminated","addPlaylistEntry","KmlTourFlyTo","duration","flyToMode","view","activeCamera","activeCallback","done","self","getCameraOptions","flyTo","target","BoundingSphere","flyToBoundingSphere","cancelFlight","complete","easingFunction","EasingFunction","LINEAR_NONE","destination","combine","KmlTourWait","timeout","setTimeout","clearTimeout","parser","MimeTypes","avi","bmp","bz2","chm","css","csv","doc","dvi","eps","flv","gif","gz","htm","ico","jnlp","jpeg","jpg","m3u","m4v","mathml","mid","midi","mov","mp3","mp4","mp4v","mpeg","mpg","odp","ods","odt","ogg","pdf","png","pps","ppt","ps","qt","rdf","rss","rtf","svg","swf","tif","tiff","txt","wav","wma","wmv","xml","zip","detectFromFilename","filename","ext","getExtensionFromUri","DOMParser","autolinker","BILLBOARD_SIZE","BILLBOARD_NEAR_DISTANCE","BILLBOARD_NEAR_RATIO","BILLBOARD_FAR_DISTANCE","BILLBOARD_FAR_RATIO","kmlNamespaces","gxNamespaces","namespaces","kml","gx","atom","kmlgx","concat","featureTypes","Document","Folder","node","processingData","deferredLoading","processFeature","newProcessingData","parentEntity","Placemark","placemark","styleEntity","hasGeometry","childNodes","childNode","item","geometryProcessor","geometryTypes","localName","merge","processPositionGraphics","NetworkLink","networkEntity","sourceResource","uriResolver","queryFirstNode","viewRefreshMode","viewBoundScale","href","queryStringValue","newSourceUri","resolveHref","defaultViewFormat","viewFormat","httpQuery","setQueryParameters","queryToObject","cleanupString","processNetworkLinkQueryString","_camera","_canvas","_lastCameraView","bbox","networkLinkCollection","then","rootElement","newEntities","suspendEvents","newEntity","mergeAvailabilityWithParent","resumeEvents","refreshMode","refreshInterval","queryNumericValue","networkLinkControl","hasNetworkLinkControl","now","networkLinkInfo","cookie","lastUpdated","updating","needsUpdate","cameraUpdateTime","minRefreshPeriod","RefreshMode","INTERVAL","expires","diff","EXPIRE","oneTimeWarning","STOP","_networkLinks","addPromise","GroundOverlay","groundOverlay","geometry","isLatLonQuad","readCoordinates","createDefaultPolygon","latLonBox","west","south","east","north","negativePiToPi","clampToLatitudeRange","rotationRadians","iconNode","getIconHref","w","h","queryColorValue","altitudeMode","PhotoOverlay","processUnsupportedFeature","ScreenOverlay","Tour","queryStringAttribute","playlistNode","entryNode","playlistNodeProcessor","playlistNodeProcessors","kmlTours","DeferredLoading","_dataSource","_deferred","defer","_stack","_promises","_timeoutSet","_used","_started","_timeThreshold","insertNamespaces","firstPart","lastPart","declaration","namespaceMap","xsi","removeDuplicateNamespaces","namespace","startIndex","endIndex","endDeclaration","loadDataUriFromZip","deferred","mimeType","getData","Data64URIWriter","dataUri","embedDataUris","div","elementType","attributeName","baseUri","elements","querySelectorAll","getAttribute","setAttribute","applyBasePath","resource","createEntity","Entity","KmlFeatureData","isExtrudable","gxAltitudeMode","readCoordinate","fromDegrees","digits","parseFloat","isNaN","tuples","textContent","resultIndex","queryNumericAttribute","q","child","namespaceURI","queryNodes","getElementsByTagNameNS","queryChildNodes","resultNode","trim","queryBooleanValue","blob","addNodes","nodes","wait","all","isFirstCall","KmlDataSource","_getTimestamp","_process","_giveUpTime","_nextNode","stack","top","_pop","featureProcessor","colorOptions","maximumRed","red","maximumGreen","green","maximumBlue","blue","parseColorString","isRandom","alpha","parseInt","fromRandom","createDefaultBillboard","createDefaultLabel","LEFT","FILL_AND_OUTLINE","canRefresh","palette","hrefResource","processBillboardIcon","heading","icon","xOffset","yOffset","hotSpotNode","hotSpotX","hotSpotY","hotSpotXUnit","hotSpotYUnit","UNIT_Z","applyStyle","styleNode","bgColor","textColor","balloonStyle","listItemType","processExternalStyles","styleCollection","fetchXML","styleKml","processStyles","isExternal","styleNodes","styleNodesLength","styleMaps","styleMapsLength","styleMap","pairs","pair","styleUrl","base","promises","styleUrlNodes","getElementsByTagName","styleUrlNodesLength","styleReference","createDropLine","entityPosition","surfacePosition","heightReferenceFromAltitudeMode","CLAMP_TO_GROUND","RELATIVE_TO_GROUND","createPositionPropertyFromAltitudeMode","_pinBuilder","fromColor","YELLOW","_clampToGround","processPathGraphics","processLineStringOrLinearRing","geometryNode","coordinatesNode","extrude","tessellate","canExtrude","polylineGraphics","propertiesLength","createPositionPropertyArrayFromAltitudeMode","addToMultiTrack","times","dropShowProperty","includeEndPoints","addSamples","isStartIncluded","isStopIncluded","scratchDiv","Point","coordinatesString","LineString","LinearRing","Polygon","outerBoundaryIsNode","linearRingNode","innerBoundaryIsNodes","k","Track","coordNodes","angleNodes","timeNodes","MultiTrack","lastStop","lastStopPosition","trackNodes","needDropLine","trackNode","MultiGeometry","childEntity","Model","featureNode","kmlData","placeMark","styleIndex","inlineStyleNode","externalStyle","computeFinalStyle","beginNode","beginDate","endNode","endDate","lessThan","processTimeSpan","whenString","processTimeStamp","visibility","ancestryIsVisible","authorNode","author","linkNode","hreflang","rel","title","address","phoneNumber","snippet","extendedDataNode","dataNodes","dataNode","displayName","extendedData","processExtendedData","background","foreground","isDisplayName","links","toCssColorString","processDescription","processLookAt","processCamera","document","createElement","FlyTo","lookAt","flyto","Wait","SoundCue","processTourUnsupportedNode","AnimatedUpdate","TourControl","lon","lat","altitude","tilt","roll","hpr","HeadingPitchRoll","HeadingPitchRange","PI_OVER_TWO","viewPoint","_unsupportedNode","sFirst","zeroRectangle","scratchCartesian2","scratchCartesian3","canvas","fixLatitude","fixLongitude","queryString","objectToQuery","queryParameters","_mode","SceneMode","MORPHING","centerCartesian","centerCartographic","clientWidth","clientHeight","pickEllipsoid","cartesianToCartographic","center","EPSILON9","newHalfWidth","newHalfHeight","toDegrees","pitch","distance","positionWC","frustum","aspectRatio","horizFov","vertFov","fov","loadKml","documentElement","_DeferredLoading","processFeatureNode","loadKmz","createReader","BlobReader","reader","getEntries","entries","docEntry","docDefer","directory","innerDefer","TextWriter","parseFromString","loadXmlFromZip","close","fetchBlob","DEFAULT","dataToLoad","Blob","magicBlob","size","FileReader","DataView","getUint32","readAsArrayBuffer","isZip","readAsText","readBlobAsText","body","msg","firstChild","nodeValue","innerText","_refresh","PinBuilder","AssociativeArray","direction","directionWC","up","upWC","computeViewRectangle","MAX_VALUE","parentAvailability","childAvailability","refreshEvent","unsupportedNodeEvent","oldName","isMinStart","isMaxStop","Date","setHours","fromDate","changed","entitiesToIgnore","update","networkLinks","cameraViewUpdate","lastCameraView","EPSILON7","newNetworkLinks","networkLink","contains","doUpdate","greaterThan","recurseIgnoreEntities","children","_children","count","newEntityCollection","processedHref","networkLinkEntity","entitiesCopy","entityToRemove","removeChildren","getNetworkLinkUpdateCallback","getTimestamp"],"mappings":"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","file":"2.TerriaJS-specs.js","sourcesContent":["import freezeObject from './freezeObject.js';\n\n    /**\n     * Style options for corners.\n     *\n     * @demo The {@link https://sandcastle.cesium.com/index.html?src=Corridor.html&label=Geometries|Corridor Demo}\n     * demonstrates the three corner types, as used by {@link CorridorGraphics}.\n     *\n     * @exports CornerType\n     */\n    var CornerType = {\n        /**\n         * <img src=\"Images/CornerTypeRounded.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner has a smooth edge.\n         * @type {Number}\n         * @constant\n         */\n        ROUNDED : 0,\n\n        /**\n         * <img src=\"Images/CornerTypeMitered.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner point is the intersection of adjacent edges.\n         * @type {Number}\n         * @constant\n         */\n        MITERED : 1,\n\n        /**\n         * <img src=\"Images/CornerTypeBeveled.png\" style=\"vertical-align: middle;\" width=\"186\" height=\"189\" />\n         *\n         * Corner is clipped.\n         * @type {Number}\n         * @constant\n         */\n        BEVELED : 2\n    };\nexport default freezeObject(CornerType);\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport Property from './Property.js';\n\n    function subscribeAll(property, eventHelper, definitionChanged, intervals) {\n        function callback() {\n            definitionChanged.raiseEvent(property);\n        }\n        var items = [];\n        eventHelper.removeAll();\n        var length = intervals.length;\n        for (var i = 0; i < length; i++) {\n            var interval = intervals.get(i);\n            if (defined(interval.data) && items.indexOf(interval.data) === -1) {\n                eventHelper.add(interval.data.definitionChanged, callback);\n            }\n        }\n    }\n\n    /**\n     * A {@link Property} which is defined by a {@link TimeIntervalCollection}, where the\n     * data property of each {@link TimeInterval} is another Property instance which is\n     * evaluated at the provided time.\n     *\n     * @alias CompositeProperty\n     * @constructor\n     *\n     *\n     * @example\n     * var constantProperty = ...;\n     * var sampledProperty = ...;\n     *\n     * //Create a composite property from two previously defined properties\n     * //where the property is valid on August 1st, 2012 and uses a constant\n     * //property for the first half of the day and a sampled property for the\n     * //remaining half.\n     * var composite = new Cesium.CompositeProperty();\n     * composite.intervals.addInterval(Cesium.TimeInterval.fromIso8601({\n     *     iso8601 : '2012-08-01T00:00:00.00Z/2012-08-01T12:00:00.00Z',\n     *     data : constantProperty\n     * }));\n     * composite.intervals.addInterval(Cesium.TimeInterval.fromIso8601({\n     *     iso8601 : '2012-08-01T12:00:00.00Z/2012-08-02T00:00:00.00Z',\n     *     isStartIncluded : false,\n     *     isStopIncluded : false,\n     *     data : sampledProperty\n     * }));\n     *\n     * @see CompositeMaterialProperty\n     * @see CompositePositionProperty\n     */\n    function CompositeProperty() {\n        this._eventHelper = new EventHelper();\n        this._definitionChanged = new Event();\n        this._intervals = new TimeIntervalCollection();\n        this._intervals.changedEvent.addEventListener(CompositeProperty.prototype._intervalsChanged, this);\n    }\n\n    defineProperties(CompositeProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._intervals.isEmpty;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositeProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._intervals;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositeProperty.prototype.getValue = function(time, result) {\n        \n\n        var innerProperty = this._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValue(time, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositeProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositeProperty && //\n                this._intervals.equals(other._intervals, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositeProperty.prototype._intervalsChanged = function() {\n        subscribeAll(this, this._eventHelper, this._definitionChanged, this._intervals);\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositeProperty;\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link CompositeProperty} which is also a {@link PositionProperty}.\n     *\n     * @alias CompositePositionProperty\n     * @constructor\n     *\n     * @param {ReferenceFrame} [referenceFrame=ReferenceFrame.FIXED] The reference frame in which the position is defined.\n     */\n    function CompositePositionProperty(referenceFrame) {\n        this._referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n        this._definitionChanged = new Event();\n        this._composite = new CompositeProperty();\n        this._composite.definitionChanged.addEventListener(CompositePositionProperty.prototype._raiseDefinitionChanged, this);\n    }\n\n    defineProperties(CompositePositionProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._composite.isConstant;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._composite.intervals;\n            }\n        },\n        /**\n         * Gets or sets the reference frame which this position presents itself as.\n         * Each PositionProperty making up this object has it's own reference frame,\n         * so this property merely exposes a \"preferred\" reference frame for clients\n         * to use.\n         * @memberof CompositePositionProperty.prototype\n         *\n         * @type {ReferenceFrame}\n         */\n        referenceFrame : {\n            get : function() {\n                return this._referenceFrame;\n            },\n            set : function(value) {\n                this._referenceFrame = value;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property at the provided time in the fixed frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositePositionProperty.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositePositionProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValueInReferenceFrame(time, referenceFrame, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositePositionProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositePositionProperty && //\n                this._referenceFrame === other._referenceFrame && //\n                this._composite.equals(other._composite, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositePositionProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositePositionProperty;\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport RuntimeError from '../Core/RuntimeError.js';\nimport Property from './Property.js';\n\n    function resolveEntity(that) {\n        var entityIsResolved = true;\n        if (that._resolveEntity) {\n            var targetEntity = that._targetCollection.getById(that._targetId);\n\n            if (defined(targetEntity)) {\n                targetEntity.definitionChanged.addEventListener(ReferenceProperty.prototype._onTargetEntityDefinitionChanged, that);\n                that._targetEntity = targetEntity;\n                that._resolveEntity = false;\n            } else {\n                //The property has become detached.  It has a valid value but is not currently resolved to an entity in the collection\n                targetEntity = that._targetEntity;\n                entityIsResolved = false;\n            }\n\n            if (!defined(targetEntity)) {\n                throw new RuntimeError('target entity \"' + that._targetId + '\" could not be resolved.');\n            }\n        }\n        return entityIsResolved;\n    }\n\n    function resolve(that) {\n        var targetProperty = that._targetProperty;\n\n        if (that._resolveProperty) {\n            var entityIsResolved = resolveEntity(that);\n\n            var names = that._targetPropertyNames;\n            targetProperty = that._targetEntity;\n            var length = names.length;\n            for (var i = 0; i < length && defined(targetProperty); i++) {\n                targetProperty = targetProperty[names[i]];\n            }\n\n            if (defined(targetProperty)) {\n                that._targetProperty = targetProperty;\n                that._resolveProperty = !entityIsResolved;\n            } else if (!defined(that._targetProperty)) {\n                throw new RuntimeError('targetProperty \"' + that._targetId + '.' + names.join('.') + '\" could not be resolved.');\n            }\n        }\n\n        return targetProperty;\n    }\n\n    /**\n     * A {@link Property} which transparently links to another property on a provided object.\n     *\n     * @alias ReferenceProperty\n     * @constructor\n     *\n     * @param {EntityCollection} targetCollection The entity collection which will be used to resolve the reference.\n     * @param {String} targetId The id of the entity which is being referenced.\n     * @param {String[]} targetPropertyNames The names of the property on the target entity which we will use.\n     *\n     * @example\n     * var collection = new Cesium.EntityCollection();\n     *\n     * //Create a new entity and assign a billboard scale.\n     * var object1 = new Cesium.Entity({id:'object1'});\n     * object1.billboard = new Cesium.BillboardGraphics();\n     * object1.billboard.scale = new Cesium.ConstantProperty(2.0);\n     * collection.add(object1);\n     *\n     * //Create a second entity and reference the scale from the first one.\n     * var object2 = new Cesium.Entity({id:'object2'});\n     * object2.model = new Cesium.ModelGraphics();\n     * object2.model.scale = new Cesium.ReferenceProperty(collection, 'object1', ['billboard', 'scale']);\n     * collection.add(object2);\n     *\n     * //Create a third object, but use the fromString helper function.\n     * var object3 = new Cesium.Entity({id:'object3'});\n     * object3.billboard = new Cesium.BillboardGraphics();\n     * object3.billboard.scale = Cesium.ReferenceProperty.fromString(collection, 'object1#billboard.scale');\n     * collection.add(object3);\n     *\n     * //You can refer to an entity with a # or . in id and property names by escaping them.\n     * var object4 = new Cesium.Entity({id:'#object.4'});\n     * object4.billboard = new Cesium.BillboardGraphics();\n     * object4.billboard.scale = new Cesium.ConstantProperty(2.0);\n     * collection.add(object4);\n     *\n     * var object5 = new Cesium.Entity({id:'object5'});\n     * object5.billboard = new Cesium.BillboardGraphics();\n     * object5.billboard.scale = Cesium.ReferenceProperty.fromString(collection, '\\\\#object\\\\.4#billboard.scale');\n     * collection.add(object5);\n     */\n    function ReferenceProperty(targetCollection, targetId, targetPropertyNames) {\n        \n\n        this._targetCollection = targetCollection;\n        this._targetId = targetId;\n        this._targetPropertyNames = targetPropertyNames;\n        this._targetProperty = undefined;\n        this._targetEntity = undefined;\n        this._definitionChanged = new Event();\n        this._resolveEntity = true;\n        this._resolveProperty = true;\n\n        targetCollection.collectionChanged.addEventListener(ReferenceProperty.prototype._onCollectionChanged, this);\n    }\n\n    defineProperties(ReferenceProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof ReferenceProperty.prototype\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(resolve(this));\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever the referenced property's definition is changed.\n         * @memberof ReferenceProperty.prototype\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the reference frame that the position is defined in.\n         * This property is only valid if the referenced property is a {@link PositionProperty}.\n         * @memberof ReferenceProperty.prototype\n         * @type {ReferenceFrame}\n         * @readonly\n         */\n        referenceFrame : {\n            get : function() {\n                return resolve(this).referenceFrame;\n            }\n        },\n        /**\n         * Gets the id of the entity being referenced.\n         * @memberof ReferenceProperty.prototype\n         * @type {String}\n         * @readonly\n         */\n        targetId : {\n            get : function() {\n                return this._targetId;\n            }\n        },\n        /**\n         * Gets the collection containing the entity being referenced.\n         * @memberof ReferenceProperty.prototype\n         * @type {EntityCollection}\n         * @readonly\n         */\n        targetCollection : {\n            get : function() {\n                return this._targetCollection;\n            }\n        },\n        /**\n         * Gets the array of property names used to retrieve the referenced property.\n         * @memberof ReferenceProperty.prototype\n         * @type {String[]}\n         * @readonly\n         */\n        targetPropertyNames : {\n            get : function() {\n                return this._targetPropertyNames;\n            }\n        },\n        /**\n         * Gets the resolved instance of the underlying referenced property.\n         * @memberof ReferenceProperty.prototype\n         * @type {Property}\n         * @readonly\n         */\n        resolvedProperty : {\n            get : function() {\n                return resolve(this);\n            }\n        }\n    });\n\n    /**\n     * Creates a new instance given the entity collection that will\n     * be used to resolve it and a string indicating the target entity id and property.\n     * The format of the string is \"objectId#foo.bar\", where # separates the id from\n     * property path and . separates sub-properties.  If the reference identifier or\n     * or any sub-properties contains a # . or \\ they must be escaped.\n     *\n     * @param {EntityCollection} targetCollection\n     * @param {String} referenceString\n     * @returns {ReferenceProperty} A new instance of ReferenceProperty.\n     *\n     * @exception {DeveloperError} invalid referenceString.\n     */\n    ReferenceProperty.fromString = function(targetCollection, referenceString) {\n        \n\n        var identifier;\n        var values = [];\n\n        var inIdentifier = true;\n        var isEscaped = false;\n        var token = '';\n        for (var i = 0; i < referenceString.length; ++i) {\n            var c = referenceString.charAt(i);\n\n            if (isEscaped) {\n                token += c;\n                isEscaped = false;\n            } else if (c === '\\\\') {\n                isEscaped = true;\n            } else if (inIdentifier && c === '#') {\n                identifier = token;\n                inIdentifier = false;\n                token = '';\n            } else if (!inIdentifier && c === '.') {\n                values.push(token);\n                token = '';\n            } else {\n                token += c;\n            }\n        }\n        values.push(token);\n\n        return new ReferenceProperty(targetCollection, identifier, values);\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    ReferenceProperty.prototype.getValue = function(time, result) {\n        return resolve(this).getValue(time, result);\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     * This method is only valid if the property being referenced is a {@link PositionProperty}.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    ReferenceProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        return resolve(this).getValueInReferenceFrame(time, referenceFrame, result);\n    };\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     * This method is only valid if the property being referenced is a {@link MaterialProperty}.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    ReferenceProperty.prototype.getType = function(time) {\n        return resolve(this).getType(time);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    ReferenceProperty.prototype.equals = function(other) {\n        if (this === other) {\n            return true;\n        }\n\n        var names = this._targetPropertyNames;\n        var otherNames = other._targetPropertyNames;\n\n        if (this._targetCollection !== other._targetCollection || //\n            this._targetId !== other._targetId || //\n            names.length !== otherNames.length) {\n            return false;\n        }\n\n        var length = this._targetPropertyNames.length;\n        for (var i = 0; i < length; i++) {\n            if (names[i] !== otherNames[i]) {\n                return false;\n            }\n        }\n\n        return true;\n    };\n\n    ReferenceProperty.prototype._onTargetEntityDefinitionChanged = function(targetEntity, name, value, oldValue) {\n        if (this._targetPropertyNames[0] === name) {\n            this._resolveProperty = true;\n            this._definitionChanged.raiseEvent(this);\n        }\n    };\n\n    ReferenceProperty.prototype._onCollectionChanged = function(collection, added, removed) {\n        var targetEntity = this._targetEntity;\n        if (defined(targetEntity)) {\n            if (removed.indexOf(targetEntity) !== -1) {\n                targetEntity.definitionChanged.removeEventListener(ReferenceProperty.prototype._onTargetEntityDefinitionChanged, this);\n                this._resolveEntity = true;\n                this._resolveProperty = true;\n            } else if (this._resolveEntity) {\n                //If targetEntity is defined but resolveEntity is true, then the entity is detached\n                //and any change to the collection needs to incur an attempt to resolve in order to re-attach.\n                //without this if block, a reference that becomes re-attached will not signal definitionChanged\n                resolve(this);\n                if (!this._resolveEntity) {\n                    this._definitionChanged.raiseEvent(this);\n                }\n            }\n        }\n    };\nexport default ReferenceProperty;\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Property from './Property.js';\n\n    /**\n     * This is a temporary class for scaling position properties to the WGS84 surface.\n     * It will go away or be refactored to support data with arbitrary height references.\n     * @private\n     */\n    function ScaledPositionProperty(value) {\n        this._definitionChanged = new Event();\n        this._value = undefined;\n        this._removeSubscription = undefined;\n        this.setValue(value);\n    }\n\n    defineProperties(ScaledPositionProperty.prototype, {\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._value);\n            }\n        },\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        referenceFrame : {\n            get : function() {\n                return defined(this._value) ? this._value.referenceFrame : ReferenceFrame.FIXED;\n            }\n        }\n    });\n\n    ScaledPositionProperty.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    ScaledPositionProperty.prototype.setValue = function(value) {\n        if (this._value !== value) {\n            this._value = value;\n\n            if (defined(this._removeSubscription)) {\n                this._removeSubscription();\n                this._removeSubscription = undefined;\n            }\n\n            if (defined(value)) {\n                this._removeSubscription = value.definitionChanged.addEventListener(this._raiseDefinitionChanged, this);\n            }\n            this._definitionChanged.raiseEvent(this);\n        }\n    };\n\n    ScaledPositionProperty.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        if (!defined(this._value)) {\n            return undefined;\n        }\n\n        result = this._value.getValueInReferenceFrame(time, referenceFrame, result);\n        return defined(result) ? Ellipsoid.WGS84.scaleToGeodeticSurface(result, result) : undefined;\n    };\n\n    ScaledPositionProperty.prototype.equals = function(other) {\n        return this === other || (other instanceof ScaledPositionProperty && this._value === other._value);\n    };\n\n    ScaledPositionProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default ScaledPositionProperty;\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link PositionProperty} whose value is an array whose items are the computed value\n     * of other PositionProperty instances.\n     *\n     * @alias PositionPropertyArray\n     * @constructor\n     *\n     * @param {Property[]} [value] An array of Property instances.\n     * @param {ReferenceFrame} [referenceFrame=ReferenceFrame.FIXED] The reference frame in which the position is defined.\n     */\n    function PositionPropertyArray(value, referenceFrame) {\n        this._value = undefined;\n        this._definitionChanged = new Event();\n        this._eventHelper = new EventHelper();\n        this._referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n        this.setValue(value);\n    }\n\n    defineProperties(PositionPropertyArray.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  This property\n         * is considered constant if all property items in the array are constant.\n         * @memberof PositionPropertyArray.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                var value = this._value;\n                if (!defined(value)) {\n                    return true;\n                }\n\n                var length = value.length;\n                for (var i = 0; i < length; i++) {\n                    if (!Property.isConstant(value[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value or one of the properties in the array also changes.\n         * @memberof PositionPropertyArray.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the reference frame in which the position is defined.\n         * @memberof PositionPropertyArray.prototype\n         * @type {ReferenceFrame}\n         * @default ReferenceFrame.FIXED;\n         */\n        referenceFrame : {\n            get : function() {\n                return this._referenceFrame;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Cartesian3[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3[]} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PositionPropertyArray.prototype.getValue = function(time, result) {\n        return this.getValueInReferenceFrame(time, ReferenceFrame.FIXED, result);\n    };\n\n    /**\n     * Gets the value of the property at the provided time and in the provided reference frame.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {ReferenceFrame} referenceFrame The desired referenceFrame of the result.\n     * @param {Cartesian3[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3[]} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PositionPropertyArray.prototype.getValueInReferenceFrame = function(time, referenceFrame, result) {\n        \n\n        var value = this._value;\n        if (!defined(value)) {\n            return undefined;\n        }\n\n        var length = value.length;\n        if (!defined(result)) {\n            result = new Array(length);\n        }\n        var i = 0;\n        var x = 0;\n        while (i < length) {\n            var property = value[i];\n            var itemValue = property.getValueInReferenceFrame(time, referenceFrame, result[i]);\n            if (defined(itemValue)) {\n                result[x] = itemValue;\n                x++;\n            }\n            i++;\n        }\n        result.length = x;\n        return result;\n    };\n\n    /**\n     * Sets the value of the property.\n     *\n     * @param {Property[]} value An array of Property instances.\n     */\n    PositionPropertyArray.prototype.setValue = function(value) {\n        var eventHelper = this._eventHelper;\n        eventHelper.removeAll();\n\n        if (defined(value)) {\n            this._value = value.slice();\n            var length = value.length;\n            for (var i = 0; i < length; i++) {\n                var property = value[i];\n                if (defined(property)) {\n                    eventHelper.add(property.definitionChanged, PositionPropertyArray.prototype._raiseDefinitionChanged, this);\n                }\n            }\n        } else {\n            this._value = undefined;\n        }\n        this._definitionChanged.raiseEvent(this);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PositionPropertyArray.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PositionPropertyArray && //\n                this._referenceFrame === other._referenceFrame && //\n                Property.arrayEquals(this._value, other._value));\n    };\n\n    PositionPropertyArray.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default PositionPropertyArray;\n","import defaultValue from './defaultValue.js';\nimport defined from './defined.js';\nimport DeveloperError from './DeveloperError.js';\nimport CesiumMath from './Math.js';\n\n    var factorial = CesiumMath.factorial;\n\n    function calculateCoefficientTerm(x, zIndices, xTable, derivOrder, termOrder, reservedIndices) {\n        var result = 0;\n        var reserved;\n        var i;\n        var j;\n\n        if (derivOrder > 0) {\n            for (i = 0; i < termOrder; i++) {\n                reserved = false;\n                for (j = 0; j < reservedIndices.length && !reserved; j++) {\n                    if (i === reservedIndices[j]) {\n                        reserved = true;\n                    }\n                }\n\n                if (!reserved) {\n                    reservedIndices.push(i);\n                    result += calculateCoefficientTerm(x, zIndices, xTable, derivOrder - 1, termOrder, reservedIndices);\n                    reservedIndices.splice(reservedIndices.length - 1, 1);\n                }\n            }\n\n            return result;\n        }\n\n        result = 1;\n        for (i = 0; i < termOrder; i++) {\n            reserved = false;\n            for (j = 0; j < reservedIndices.length && !reserved; j++) {\n                if (i === reservedIndices[j]) {\n                    reserved = true;\n                }\n            }\n\n            if (!reserved) {\n                result *= x - xTable[zIndices[i]];\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * An {@link InterpolationAlgorithm} for performing Hermite interpolation.\n     *\n     * @exports HermitePolynomialApproximation\n     */\n    var HermitePolynomialApproximation = {\n        type : 'Hermite'\n    };\n\n    /**\n     * Given the desired degree, returns the number of data points required for interpolation.\n     *\n     * @param {Number} degree The desired degree of interpolation.\n     * @param {Number} [inputOrder=0]  The order of the inputs (0 means just the data, 1 means the data and its derivative, etc).\n     * @returns {Number} The number of required data points needed for the desired degree of interpolation.\n     * @exception {DeveloperError} degree must be 0 or greater.\n     * @exception {DeveloperError} inputOrder must be 0 or greater.\n     */\n    HermitePolynomialApproximation.getRequiredDataPoints = function(degree, inputOrder) {\n        inputOrder = defaultValue(inputOrder, 0);\n\n        \n\n        return Math.max(Math.floor((degree + 1) / (inputOrder + 1)), 2);\n    };\n\n    /**\n     * Interpolates values using Hermite Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    HermitePolynomialApproximation.interpolateOrderZero = function(x, xTable, yTable, yStride, result) {\n        if (!defined(result)) {\n            result = new Array(yStride);\n        }\n\n        var i;\n        var j;\n        var d;\n        var s;\n        var len;\n        var index;\n        var length = xTable.length;\n        var coefficients = new Array(yStride);\n\n        for (i = 0; i < yStride; i++) {\n            result[i] = 0;\n\n            var l = new Array(length);\n            coefficients[i] = l;\n            for (j = 0; j < length; j++) {\n                l[j] = [];\n            }\n        }\n\n        var zIndicesLength = length, zIndices = new Array(zIndicesLength);\n\n        for (i = 0; i < zIndicesLength; i++) {\n            zIndices[i] = i;\n        }\n\n        var highestNonZeroCoef = length - 1;\n        for (s = 0; s < yStride; s++) {\n            for (j = 0; j < zIndicesLength; j++) {\n                index = zIndices[j] * yStride + s;\n                coefficients[s][0].push(yTable[index]);\n            }\n\n            for (i = 1; i < zIndicesLength; i++) {\n                var nonZeroCoefficients = false;\n                for (j = 0; j < zIndicesLength - i; j++) {\n                    var zj = xTable[zIndices[j]];\n                    var zn = xTable[zIndices[j + i]];\n\n                    var numerator;\n                    if (zn - zj <= 0) {\n                        index = zIndices[j] * yStride + yStride * i + s;\n                        numerator = yTable[index];\n                        coefficients[s][i].push(numerator / factorial(i));\n                    } else {\n                        numerator = (coefficients[s][i - 1][j + 1] - coefficients[s][i - 1][j]);\n                        coefficients[s][i].push(numerator / (zn - zj));\n                    }\n                    nonZeroCoefficients = nonZeroCoefficients || (numerator !== 0);\n                }\n\n                if (!nonZeroCoefficients) {\n                    highestNonZeroCoef = i - 1;\n                }\n            }\n        }\n\n        for (d = 0, len = 0; d <= len; d++) {\n            for (i = d; i <= highestNonZeroCoef; i++) {\n                var tempTerm = calculateCoefficientTerm(x, zIndices, xTable, d, i, []);\n                for (s = 0; s < yStride; s++) {\n                    var coeff = coefficients[s][i][0];\n                    result[s + d * yStride] += coeff * tempTerm;\n                }\n            }\n        }\n\n        return result;\n    };\n\n    var arrayScratch = [];\n\n    /**\n     * Interpolates values using Hermite Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number} inputOrder The number of derivatives supplied for input.\n     * @param {Number} outputOrder The number of derivatives desired for output.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     *\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    HermitePolynomialApproximation.interpolate = function(x, xTable, yTable, yStride, inputOrder, outputOrder, result) {\n        var resultLength = yStride * (outputOrder + 1);\n        if (!defined(result)) {\n            result = new Array(resultLength);\n        }\n        for (var r = 0; r < resultLength; r++) {\n            result[r] = 0;\n        }\n\n        var length = xTable.length;\n        // The zIndices array holds copies of the addresses of the xTable values\n        // in the range we're looking at. Even though this just holds information already\n        // available in xTable this is a much more convenient format.\n        var zIndices = new Array(length * (inputOrder + 1));\n        var i;\n        for (i = 0; i < length; i++) {\n            for (var j = 0; j < (inputOrder + 1); j++) {\n                zIndices[i * (inputOrder + 1) + j] = i;\n            }\n        }\n\n        var zIndiceslength = zIndices.length;\n        var coefficients = arrayScratch;\n        var highestNonZeroCoef = fillCoefficientList(coefficients, zIndices, xTable, yTable, yStride, inputOrder);\n        var reservedIndices = [];\n\n        var tmp = zIndiceslength * (zIndiceslength + 1) / 2;\n        var loopStop = Math.min(highestNonZeroCoef, outputOrder);\n        for (var d = 0; d <= loopStop; d++) {\n            for (i = d; i <= highestNonZeroCoef; i++) {\n                reservedIndices.length = 0;\n                var tempTerm = calculateCoefficientTerm(x, zIndices, xTable, d, i, reservedIndices);\n                var dimTwo = Math.floor(i * (1 - i) / 2) + (zIndiceslength * i);\n\n                for (var s = 0; s < yStride; s++) {\n                    var dimOne = Math.floor(s * tmp);\n                    var coef = coefficients[dimOne + dimTwo];\n                    result[s + d * yStride] += coef * tempTerm;\n                }\n            }\n        }\n\n        return result;\n    };\n\n    function fillCoefficientList(coefficients, zIndices, xTable, yTable, yStride, inputOrder) {\n        var j;\n        var index;\n        var highestNonZero = -1;\n        var zIndiceslength = zIndices.length;\n        var tmp = zIndiceslength * (zIndiceslength + 1) / 2;\n\n        for (var s = 0; s < yStride; s++) {\n            var dimOne = Math.floor(s * tmp);\n\n            for (j = 0; j < zIndiceslength; j++) {\n                index = zIndices[j] * yStride * (inputOrder + 1) + s;\n                coefficients[dimOne + j] = yTable[index];\n            }\n\n            for (var i = 1; i < zIndiceslength; i++) {\n                var coefIndex = 0;\n                var dimTwo = Math.floor(i * (1 - i) / 2) + (zIndiceslength * i);\n                var nonZeroCoefficients = false;\n\n                for (j = 0; j < zIndiceslength - i; j++) {\n                    var zj = xTable[zIndices[j]];\n                    var zn = xTable[zIndices[j + i]];\n\n                    var numerator;\n                    var coefficient;\n                    if (zn - zj <= 0) {\n                        index = zIndices[j] * yStride * (inputOrder + 1) + yStride * i + s;\n                        numerator = yTable[index];\n                        coefficient = (numerator / CesiumMath.factorial(i));\n                        coefficients[dimOne + dimTwo + coefIndex] = coefficient;\n                        coefIndex++;\n                    } else {\n                        var dimTwoMinusOne = Math.floor((i - 1) * (2 - i) / 2) + (zIndiceslength * (i - 1));\n                        numerator = coefficients[dimOne + dimTwoMinusOne + j + 1] - coefficients[dimOne + dimTwoMinusOne + j];\n                        coefficient = (numerator / (zn - zj));\n                        coefficients[dimOne + dimTwo + coefIndex] = coefficient;\n                        coefIndex++;\n                    }\n                    nonZeroCoefficients = nonZeroCoefficients || (numerator !== 0.0);\n                }\n\n                if (nonZeroCoefficients) {\n                    highestNonZero = Math.max(highestNonZero, i);\n                }\n            }\n        }\n\n        return highestNonZero;\n    }\nexport default HermitePolynomialApproximation;\n","import defined from './defined.js';\n\n    /**\n     * An {@link InterpolationAlgorithm} for performing Lagrange interpolation.\n     *\n     * @exports LagrangePolynomialApproximation\n     */\n    var LagrangePolynomialApproximation = {\n        type : 'Lagrange'\n    };\n\n    /**\n     * Given the desired degree, returns the number of data points required for interpolation.\n     *\n     * @param {Number} degree The desired degree of interpolation.\n     * @returns {Number} The number of required data points needed for the desired degree of interpolation.\n     */\n    LagrangePolynomialApproximation.getRequiredDataPoints = function(degree) {\n        return Math.max(degree + 1.0, 2);\n    };\n\n    /**\n     * Interpolates values using Lagrange Polynomial Approximation.\n     *\n     * @param {Number} x The independent variable for which the dependent variables will be interpolated.\n     * @param {Number[]} xTable The array of independent variables to use to interpolate.  The values\n     * in this array must be in increasing order and the same value must not occur twice in the array.\n     * @param {Number[]} yTable The array of dependent variables to use to interpolate.  For a set of three\n     * dependent values (p,q,w) at time 1 and time 2 this should be as follows: {p1, q1, w1, p2, q2, w2}.\n     * @param {Number} yStride The number of dependent variable values in yTable corresponding to\n     * each independent variable value in xTable.\n     * @param {Number[]} [result] An existing array into which to store the result.\n     * @returns {Number[]} The array of interpolated values, or the result parameter if one was provided.\n     */\n    LagrangePolynomialApproximation.interpolateOrderZero = function(x, xTable, yTable, yStride, result) {\n        if (!defined(result)) {\n            result = new Array(yStride);\n        }\n\n        var i;\n        var j;\n        var length = xTable.length;\n\n        for (i = 0; i < yStride; i++) {\n            result[i] = 0;\n        }\n\n        for (i = 0; i < length; i++) {\n            var coefficient = 1;\n\n            for (j = 0; j < length; j++) {\n                if (j !== i) {\n                    var diffX = xTable[i] - xTable[j];\n                    coefficient *= (x - xTable[j]) / diffX;\n                }\n            }\n\n            for (j = 0; j < yStride; j++) {\n                result[j] += coefficient * yTable[i * yStride + j];\n            }\n        }\n\n        return result;\n    };\nexport default LagrangePolynomialApproximation;\n","import Check from './Check.js';\nimport defaultValue from './defaultValue.js';\nimport defined from './defined.js';\n\n    /**\n     * A set of curvilinear 3-dimensional coordinates.\n     *\n     * @alias Spherical\n     * @constructor\n     *\n     * @param {Number} [clock=0.0] The angular coordinate lying in the xy-plane measured from the positive x-axis and toward the positive y-axis.\n     * @param {Number} [cone=0.0] The angular coordinate measured from the positive z-axis and toward the negative z-axis.\n     * @param {Number} [magnitude=1.0] The linear coordinate measured from the origin.\n     */\n    function Spherical(clock, cone, magnitude) {\n        /**\n         * The clock component.\n         * @type {Number}\n         * @default 0.0\n         */\n        this.clock = defaultValue(clock, 0.0);\n        /**\n         * The cone component.\n         * @type {Number}\n         * @default 0.0\n         */\n        this.cone = defaultValue(cone, 0.0);\n        /**\n         * The magnitude component.\n         * @type {Number}\n         * @default 1.0\n         */\n        this.magnitude = defaultValue(magnitude, 1.0);\n    }\n\n    /**\n     * Converts the provided Cartesian3 into Spherical coordinates.\n     *\n     * @param {Cartesian3} cartesian3 The Cartesian3 to be converted to Spherical.\n     * @param {Spherical} [result] The object in which the result will be stored, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter, or a new instance if one was not provided.\n     */\n    Spherical.fromCartesian3 = function(cartesian3, result) {\n        \n\n        var x = cartesian3.x;\n        var y = cartesian3.y;\n        var z = cartesian3.z;\n        var radialSquared = x * x + y * y;\n\n        if (!defined(result)) {\n            result = new Spherical();\n        }\n\n        result.clock = Math.atan2(y, x);\n        result.cone = Math.atan2(Math.sqrt(radialSquared), z);\n        result.magnitude = Math.sqrt(radialSquared + z * z);\n        return result;\n    };\n\n    /**\n     * Creates a duplicate of a Spherical.\n     *\n     * @param {Spherical} spherical The spherical to clone.\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined. (Returns undefined if spherical is undefined)\n     */\n    Spherical.clone = function(spherical, result) {\n        if (!defined(spherical)) {\n            return undefined;\n        }\n\n        if (!defined(result)) {\n            return new Spherical(spherical.clock, spherical.cone, spherical.magnitude);\n        }\n\n        result.clock = spherical.clock;\n        result.cone = spherical.cone;\n        result.magnitude = spherical.magnitude;\n        return result;\n    };\n\n    /**\n     * Computes the normalized version of the provided spherical.\n     *\n     * @param {Spherical} spherical The spherical to be normalized.\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined.\n     */\n    Spherical.normalize = function(spherical, result) {\n      \n\n        if (!defined(result)) {\n            return new Spherical(spherical.clock, spherical.cone, 1.0);\n        }\n\n        result.clock = spherical.clock;\n        result.cone = spherical.cone;\n        result.magnitude = 1.0;\n        return result;\n    };\n\n    /**\n     * Returns true if the first spherical is equal to the second spherical, false otherwise.\n     *\n     * @param {Spherical} left The first Spherical to be compared.\n     * @param {Spherical} right The second Spherical to be compared.\n     * @returns {Boolean} true if the first spherical is equal to the second spherical, false otherwise.\n     */\n    Spherical.equals = function(left, right) {\n        return (left === right) ||\n               ((defined(left)) &&\n                (defined(right)) &&\n                (left.clock === right.clock) &&\n                (left.cone === right.cone) &&\n                (left.magnitude === right.magnitude));\n    };\n\n    /**\n     * Returns true if the first spherical is within the provided epsilon of the second spherical, false otherwise.\n     *\n     * @param {Spherical} left The first Spherical to be compared.\n     * @param {Spherical} right The second Spherical to be compared.\n     * @param {Number} [epsilon=0.0] The epsilon to compare against.\n     * @returns {Boolean} true if the first spherical is within the provided epsilon of the second spherical, false otherwise.\n     */\n    Spherical.equalsEpsilon = function(left, right, epsilon) {\n        epsilon = defaultValue(epsilon, 0.0);\n        return (left === right) ||\n               ((defined(left)) &&\n                (defined(right)) &&\n                (Math.abs(left.clock - right.clock) <= epsilon) &&\n                (Math.abs(left.cone - right.cone) <= epsilon) &&\n                (Math.abs(left.magnitude - right.magnitude) <= epsilon));\n    };\n\n    /**\n     * Returns true if this spherical is equal to the provided spherical, false otherwise.\n     *\n     * @param {Spherical} other The Spherical to be compared.\n     * @returns {Boolean} true if this spherical is equal to the provided spherical, false otherwise.\n     */\n    Spherical.prototype.equals = function(other) {\n        return Spherical.equals(this, other);\n    };\n\n    /**\n     * Creates a duplicate of this Spherical.\n     *\n     * @param {Spherical} [result] The object to store the result into, if undefined a new instance will be created.\n     * @returns {Spherical} The modified result parameter or a new instance if result was undefined.\n     */\n    Spherical.prototype.clone = function(result) {\n        return Spherical.clone(this, result);\n    };\n\n    /**\n    * Returns true if this spherical is within the provided epsilon of the provided spherical, false otherwise.\n    *\n    * @param {Spherical} other The Spherical to be compared.\n    * @param {Number} epsilon The epsilon to compare against.\n    * @returns {Boolean} true if this spherical is within the provided epsilon of the provided spherical, false otherwise.\n    */\n    Spherical.prototype.equalsEpsilon = function(other, epsilon) {\n        return Spherical.equalsEpsilon(this, other, epsilon);\n    };\n\n    /**\n    * Returns a string representing this instance in the format (clock, cone, magnitude).\n    *\n    * @returns {String} A string representing this instance.\n    */\n    Spherical.prototype.toString = function() {\n        return '(' + this.clock + ', ' + this.cone + ', ' + this.magnitude + ')';\n    };\nexport default Spherical;\n","import Cartesian2 from '../Core/Cartesian2.js';\nimport Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultEvenColor = Color.WHITE;\n    var defaultOddColor = Color.BLACK;\n    var defaultRepeat = new Cartesian2(2.0, 2.0);\n\n    /**\n     * A {@link MaterialProperty} that maps to checkerboard {@link Material} uniforms.\n     * @alias CheckerboardMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.evenColor=Color.WHITE] A Property specifying the first {@link Color}.\n     * @param {Property} [options.oddColor=Color.BLACK] A Property specifying the second {@link Color}.\n     * @param {Property} [options.repeat=new Cartesian2(2.0, 2.0)] A {@link Cartesian2} Property specifying how many times the tiles repeat in each direction.\n     */\n    function CheckerboardMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._evenColor = undefined;\n        this._evenColorSubscription = undefined;\n        this._oddColor = undefined;\n        this._oddColorSubscription = undefined;\n        this._repeat = undefined;\n        this._repeatSubscription = undefined;\n\n        this.evenColor = options.evenColor;\n        this.oddColor = options.oddColor;\n        this.repeat = options.repeat;\n    }\n\n    defineProperties(CheckerboardMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CheckerboardMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._evenColor) && //\n                       Property.isConstant(this._oddColor) && //\n                       Property.isConstant(this._repeat);\n            }\n        },\n\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof CheckerboardMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the first {@link Color}.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        evenColor : createPropertyDescriptor('evenColor'),\n\n        /**\n         * Gets or sets the Property specifying the second {@link Color}.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        oddColor : createPropertyDescriptor('oddColor'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying how many times the tiles repeat in each direction.\n         * @memberof CheckerboardMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(2.0, 2.0)\n         */\n        repeat : createPropertyDescriptor('repeat')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    CheckerboardMaterialProperty.prototype.getType = function(time) {\n        return 'Checkerboard';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CheckerboardMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.lightColor = Property.getValueOrClonedDefault(this._evenColor, time, defaultEvenColor, result.lightColor);\n        result.darkColor = Property.getValueOrClonedDefault(this._oddColor, time, defaultOddColor, result.darkColor);\n        result.repeat = Property.getValueOrDefault(this._repeat, time, defaultRepeat);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CheckerboardMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CheckerboardMaterialProperty && //\n                       Property.equals(this._evenColor, other._evenColor) && //\n                       Property.equals(this._oddColor, other._oddColor) && //\n                       Property.equals(this._repeat, other._repeat));\n    };\nexport default CheckerboardMaterialProperty;\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link CompositeProperty} which is also a {@link MaterialProperty}.\n     *\n     * @alias CompositeMaterialProperty\n     * @constructor\n     */\n    function CompositeMaterialProperty() {\n        this._definitionChanged = new Event();\n        this._composite = new CompositeProperty();\n        this._composite.definitionChanged.addEventListener(CompositeMaterialProperty.prototype._raiseDefinitionChanged, this);\n    }\n\n    defineProperties(CompositeMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return this._composite.isConstant;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets the interval collection.\n         * @memberof CompositeMaterialProperty.prototype\n         *\n         * @type {TimeIntervalCollection}\n         */\n        intervals : {\n            get : function() {\n                return this._composite._intervals;\n            }\n        }\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    CompositeMaterialProperty.prototype.getType = function(time) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getType(time);\n        }\n        return undefined;\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    CompositeMaterialProperty.prototype.getValue = function(time, result) {\n        \n\n        var innerProperty = this._composite._intervals.findDataForIntervalContainingDate(time);\n        if (defined(innerProperty)) {\n            return innerProperty.getValue(time, result);\n        }\n        return undefined;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    CompositeMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof CompositeMaterialProperty && //\n                this._composite.equals(other._composite, Property.equals));\n    };\n\n    /**\n     * @private\n     */\n    CompositeMaterialProperty.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default CompositeMaterialProperty;\n","import Cartesian2 from '../Core/Cartesian2.js';\nimport Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultCellAlpha = 0.1;\n    var defaultLineCount = new Cartesian2(8, 8);\n    var defaultLineOffset = new Cartesian2(0, 0);\n    var defaultLineThickness = new Cartesian2(1, 1);\n\n    /**\n     * A {@link MaterialProperty} that maps to grid {@link Material} uniforms.\n     * @alias GridMaterialProperty\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the grid {@link Color}.\n     * @param {Property} [options.cellAlpha=0.1] A numeric Property specifying cell alpha values.\n     * @param {Property} [options.lineCount=new Cartesian2(8, 8)] A {@link Cartesian2} Property specifying the number of grid lines along each axis.\n     * @param {Property} [options.lineThickness=new Cartesian2(1.0, 1.0)] A {@link Cartesian2} Property specifying the thickness of grid lines along each axis.\n     * @param {Property} [options.lineOffset=new Cartesian2(0.0, 0.0)] A {@link Cartesian2} Property specifying starting offset of grid lines along each axis.\n     *\n     * @constructor\n     */\n    function GridMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._cellAlpha = undefined;\n        this._cellAlphaSubscription = undefined;\n        this._lineCount = undefined;\n        this._lineCountSubscription = undefined;\n        this._lineThickness = undefined;\n        this._lineThicknessSubscription = undefined;\n        this._lineOffset = undefined;\n        this._lineOffsetSubscription = undefined;\n\n        this.color = options.color;\n        this.cellAlpha = options.cellAlpha;\n        this.lineCount = options.lineCount;\n        this.lineThickness = options.lineThickness;\n        this.lineOffset = options.lineOffset;\n    }\n\n    defineProperties(GridMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof GridMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color) &&\n                       Property.isConstant(this._cellAlpha) &&\n                       Property.isConstant(this._lineCount) &&\n                       Property.isConstant(this._lineThickness) &&\n                       Property.isConstant(this._lineOffset);\n            }\n        },\n\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof GridMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the grid {@link Color}.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the numeric Property specifying cell alpha values.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default 0.1\n         */\n        cellAlpha : createPropertyDescriptor('cellAlpha'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the number of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(8.0, 8.0)\n         */\n        lineCount : createPropertyDescriptor('lineCount'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the thickness of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(1.0, 1.0)\n         */\n        lineThickness : createPropertyDescriptor('lineThickness'),\n\n        /**\n         * Gets or sets the {@link Cartesian2} Property specifying the starting offset of grid lines along each axis.\n         * @memberof GridMaterialProperty.prototype\n         * @type {Property}\n         * @default new Cartesian2(0.0, 0.0)\n         */\n        lineOffset : createPropertyDescriptor('lineOffset')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    GridMaterialProperty.prototype.getType = function(time) {\n        return 'Grid';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    GridMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.cellAlpha = Property.getValueOrDefault(this._cellAlpha, time, defaultCellAlpha);\n        result.lineCount = Property.getValueOrClonedDefault(this._lineCount, time, defaultLineCount, result.lineCount);\n        result.lineThickness = Property.getValueOrClonedDefault(this._lineThickness, time, defaultLineThickness, result.lineThickness);\n        result.lineOffset = Property.getValueOrClonedDefault(this._lineOffset, time, defaultLineOffset, result.lineOffset);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    GridMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n        (other instanceof GridMaterialProperty && //\n        Property.equals(this._color, other._color) && //\n        Property.equals(this._cellAlpha, other._cellAlpha) && //\n        Property.equals(this._lineCount, other._lineCount) && //\n        Property.equals(this._lineThickness, other._lineThickness) && //\n        Property.equals(this._lineOffset, other._lineOffset));\n    };\nexport default GridMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link MaterialProperty} that maps to PolylineArrow {@link Material} uniforms.\n     *\n     * @param {Property} [color=Color.WHITE] The {@link Color} Property to be used.\n     *\n     * @alias PolylineArrowMaterialProperty\n     * @constructor\n     */\n    function PolylineArrowMaterialProperty(color) {\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n\n        this.color = color;\n    }\n\n    defineProperties(PolylineArrowMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the {@link Color} {@link Property}.\n         * @memberof PolylineArrowMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineArrowMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineArrow';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineArrowMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, Color.WHITE, result.color);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineArrowMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineArrowMaterialProperty && //\n                Property.equals(this._color, other._color));\n    };\nexport default PolylineArrowMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultGapColor = Color.TRANSPARENT;\n    var defaultDashLength = 16.0;\n    var defaultDashPattern = 255.0;\n\n    /**\n     * A {@link MaterialProperty} that maps to polyline dash {@link Material} uniforms.\n     * @alias PolylineDashMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the {@link Color} of the line.\n     * @param {Property} [options.gapColor=Color.TRANSPARENT] A Property specifying the {@link Color} of the gaps in the line.\n     * @param {Property} [options.dashLength=16.0] A numeric Property specifying the length of the dash pattern in pixels.\n     * @param {Property} [options.dashPattern=255.0] A numeric Property specifying a 16 bit pattern for the dash\n     */\n    function PolylineDashMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._gapColor = undefined;\n        this._gapColorSubscription = undefined;\n        this._dashLength = undefined;\n        this._dashLengthSubscription = undefined;\n        this._dashPattern = undefined;\n        this._dashPatternSubscription = undefined;\n\n        this.color = options.color;\n        this.gapColor = options.gapColor;\n        this.dashLength = options.dashLength;\n        this.dashPattern = options.dashPattern;\n    }\n\n    defineProperties(PolylineDashMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return (Property.isConstant(this._color) &&\n                        Property.isConstant(this._gapColor) &&\n                        Property.isConstant(this._dashLength) &&\n                        Property.isConstant(this._dashPattern));\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the line.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the gaps in the line.\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        gapColor : createPropertyDescriptor('gapColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the length of a dash cycle\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        dashLength : createPropertyDescriptor('dashLength'),\n\n        /**\n         * Gets or sets the numeric Property specifying a dash pattern\n         * @memberof PolylineDashMaterialProperty.prototype\n         * @type {Property}\n         */\n        dashPattern : createPropertyDescriptor('dashPattern')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineDashMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineDash';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineDashMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.gapColor = Property.getValueOrClonedDefault(this._gapColor, time, defaultGapColor, result.gapColor);\n        result.dashLength = Property.getValueOrDefault(this._dashLength, time, defaultDashLength, result.dashLength);\n        result.dashPattern = Property.getValueOrDefault(this._dashPattern, time, defaultDashPattern, result.dashPattern);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineDashMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineDashMaterialProperty &&\n                Property.equals(this._color, other._color) &&\n                Property.equals(this._gapColor, other._gapColor) &&\n                Property.equals(this._dashLength, other._dashLength) &&\n                Property.equals(this._dashPattern, other._dashPattern));\n    };\nexport default PolylineDashMaterialProperty;\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\n\n    var defaultColor = Color.WHITE;\n    var defaultOutlineColor = Color.BLACK;\n    var defaultOutlineWidth = 1.0;\n\n    /**\n     * A {@link MaterialProperty} that maps to polyline outline {@link Material} uniforms.\n     * @alias PolylineOutlineMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.color=Color.WHITE] A Property specifying the {@link Color} of the line.\n     * @param {Property} [options.outlineColor=Color.BLACK] A Property specifying the {@link Color} of the outline.\n     * @param {Property} [options.outlineWidth=1.0] A numeric Property specifying the width of the outline, in pixels.\n     */\n    function PolylineOutlineMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._color = undefined;\n        this._colorSubscription = undefined;\n        this._outlineColor = undefined;\n        this._outlineColorSubscription = undefined;\n        this._outlineWidth = undefined;\n        this._outlineWidthSubscription = undefined;\n\n        this.color = options.color;\n        this.outlineColor = options.outlineColor;\n        this.outlineWidth = options.outlineWidth;\n    }\n\n    defineProperties(PolylineOutlineMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._color) && Property.isConstant(this._outlineColor) && Property.isConstant(this._outlineWidth);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the line.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        color : createPropertyDescriptor('color'),\n\n        /**\n         * Gets or sets the Property specifying the {@link Color} of the outline.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        outlineColor : createPropertyDescriptor('outlineColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the width of the outline.\n         * @memberof PolylineOutlineMaterialProperty.prototype\n         * @type {Property}\n         * @default 1.0\n         */\n        outlineWidth : createPropertyDescriptor('outlineWidth')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    PolylineOutlineMaterialProperty.prototype.getType = function(time) {\n        return 'PolylineOutline';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    PolylineOutlineMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.color = Property.getValueOrClonedDefault(this._color, time, defaultColor, result.color);\n        result.outlineColor = Property.getValueOrClonedDefault(this._outlineColor, time, defaultOutlineColor, result.outlineColor);\n        result.outlineWidth = Property.getValueOrDefault(this._outlineWidth, time, defaultOutlineWidth);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PolylineOutlineMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PolylineOutlineMaterialProperty && //\n                Property.equals(this._color, other._color) && //\n                Property.equals(this._outlineColor, other._outlineColor) && //\n                Property.equals(this._outlineWidth, other._outlineWidth));\n    };\nexport default PolylineOutlineMaterialProperty;\n","import defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport EventHelper from '../Core/EventHelper.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link Property} whose value is an array whose items are the computed value\n     * of other property instances.\n     *\n     * @alias PropertyArray\n     * @constructor\n     *\n     * @param {Property[]} [value] An array of Property instances.\n     */\n    function PropertyArray(value) {\n        this._value = undefined;\n        this._definitionChanged = new Event();\n        this._eventHelper = new EventHelper();\n        this.setValue(value);\n    }\n\n    defineProperties(PropertyArray.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  This property\n         * is considered constant if all property items in the array are constant.\n         * @memberof PropertyArray.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                var value = this._value;\n                if (!defined(value)) {\n                    return true;\n                }\n                var length = value.length;\n                for (var i = 0; i < length; i++) {\n                    if (!Property.isConstant(value[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is changed whenever setValue is called with data different\n         * than the current value or one of the properties in the array also changes.\n         * @memberof PropertyArray.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        }\n    });\n\n    /**\n     * Gets the value of the property.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object[]} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object[]} The modified result parameter, which is an array of values produced by evaluating each of the contained properties at the given time or a new instance if the result parameter was not supplied.\n     */\n    PropertyArray.prototype.getValue = function(time, result) {\n        \n\n        var value = this._value;\n        if (!defined(value)) {\n            return undefined;\n        }\n\n        var length = value.length;\n        if (!defined(result)) {\n            result = new Array(length);\n        }\n        var i = 0;\n        var x = 0;\n        while (i < length) {\n            var property = this._value[i];\n            var itemValue = property.getValue(time, result[i]);\n            if (defined(itemValue)) {\n                result[x] = itemValue;\n                x++;\n            }\n            i++;\n        }\n        result.length = x;\n        return result;\n    };\n\n    /**\n     * Sets the value of the property.\n     *\n     * @param {Property[]} value An array of Property instances.\n     */\n    PropertyArray.prototype.setValue = function(value) {\n        var eventHelper = this._eventHelper;\n        eventHelper.removeAll();\n\n        if (defined(value)) {\n            this._value = value.slice();\n            var length = value.length;\n            for (var i = 0; i < length; i++) {\n                var property = value[i];\n                if (defined(property)) {\n                    eventHelper.add(property.definitionChanged, PropertyArray.prototype._raiseDefinitionChanged, this);\n                }\n            }\n        } else {\n            this._value = undefined;\n        }\n        this._definitionChanged.raiseEvent(this);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    PropertyArray.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof PropertyArray && //\n                Property.arrayEquals(this._value, other._value));\n    };\n\n    PropertyArray.prototype._raiseDefinitionChanged = function() {\n        this._definitionChanged.raiseEvent(this);\n    };\nexport default PropertyArray;\n","import defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport CesiumMath from '../Core/Math.js';\n\n    /**\n     * Represents a {@link Packable} number that always interpolates values\n     * towards the shortest angle of rotation. This object is never used directly\n     * but is instead passed to the constructor of {@link SampledProperty}\n     * in order to represent a two-dimensional angle of rotation.\n     *\n     * @exports Rotation\n     *\n     *\n     * @example\n     * var time1 = Cesium.JulianDate.fromIso8601('2010-05-07T00:00:00');\n     * var time2 = Cesium.JulianDate.fromIso8601('2010-05-07T00:01:00');\n     * var time3 = Cesium.JulianDate.fromIso8601('2010-05-07T00:02:00');\n     *\n     * var property = new Cesium.SampledProperty(Cesium.Rotation);\n     * property.addSample(time1, 0);\n     * property.addSample(time3, Cesium.Math.toRadians(350));\n     *\n     * //Getting the value at time2 will equal 355 degrees instead\n     * //of 175 degrees (which is what you get if you construct\n     * //a SampledProperty(Number) instead.  Note, the actual\n     * //return value is in radians, not degrees.\n     * property.getValue(time2);\n     *\n     * @see PackableForInterpolation\n     */\n    var Rotation = {\n        /**\n         * The number of elements used to pack the object into an array.\n         * @type {Number}\n         */\n        packedLength : 1,\n\n        /**\n         * Stores the provided instance into the provided array.\n         *\n         * @param {Rotation} value The value to pack.\n         * @param {Number[]} array The array to pack into.\n         * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\n         *\n         * @returns {Number[]} The array that was packed into\n         */\n        pack : function(value, array, startingIndex) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            array[startingIndex] = value;\n\n            return array;\n        },\n\n        /**\n         * Retrieves an instance from a packed array.\n         *\n         * @param {Number[]} array The packed array.\n         * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\n         * @param {Rotation} [result] The object into which to store the result.\n         * @returns {Rotation} The modified result parameter or a new Rotation instance if one was not provided.\n         */\n        unpack : function(array, startingIndex, result) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            return array[startingIndex];\n        },\n\n        /**\n         * Converts a packed array into a form suitable for interpolation.\n         *\n         * @param {Number[]} packedArray The packed array.\n         * @param {Number} [startingIndex=0] The index of the first element to be converted.\n         * @param {Number} [lastIndex=packedArray.length] The index of the last element to be converted.\n         * @param {Number[]} result The object into which to store the result.\n         */\n        convertPackedArrayForInterpolation : function(packedArray, startingIndex, lastIndex, result) {\n            \n\n            startingIndex = defaultValue(startingIndex, 0);\n            lastIndex = defaultValue(lastIndex, packedArray.length);\n\n            var previousValue;\n            for (var i = 0, len = lastIndex - startingIndex + 1; i < len; i++) {\n                var value = packedArray[startingIndex + i];\n                if (i === 0 || Math.abs(previousValue - value) < Math.PI) {\n                    result[i] = value;\n                } else {\n                    result[i] = value - CesiumMath.TWO_PI;\n                }\n                previousValue = value;\n            }\n        },\n\n        /**\n         * Retrieves an instance from a packed array converted with {@link Rotation.convertPackedArrayForInterpolation}.\n         *\n         * @param {Number[]} array The array previously packed for interpolation.\n         * @param {Number[]} sourceArray The original packed array.\n         * @param {Number} [firstIndex=0] The firstIndex used to convert the array.\n         * @param {Number} [lastIndex=packedArray.length] The lastIndex used to convert the array.\n         * @param {Rotation} [result] The object into which to store the result.\n         * @returns {Rotation} The modified result parameter or a new Rotation instance if one was not provided.\n         */\n        unpackInterpolationResult : function(array, sourceArray, firstIndex, lastIndex, result) {\n            \n\n            result = array[0];\n            if (result < 0) {\n                return result + CesiumMath.TWO_PI;\n            }\n            return result;\n        }\n    };\nexport default Rotation;\n","import freezeObject from '../Core/freezeObject.js';\n\n    /**\n     * Defined the orientation of stripes in {@link StripeMaterialProperty}.\n     *\n     * @exports StripeOrientation\n     */\n    var StripeOrientation = {\n        /**\n         * Horizontal orientation.\n         * @type {Number}\n         */\n        HORIZONTAL : 0,\n\n        /**\n         * Vertical orientation.\n         * @type {Number}\n         */\n        VERTICAL : 1\n    };\nexport default freezeObject(StripeOrientation);\n","import Color from '../Core/Color.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Event from '../Core/Event.js';\nimport createPropertyDescriptor from './createPropertyDescriptor.js';\nimport Property from './Property.js';\nimport StripeOrientation from './StripeOrientation.js';\n\n    var defaultOrientation = StripeOrientation.HORIZONTAL;\n    var defaultEvenColor = Color.WHITE;\n    var defaultOddColor = Color.BLACK;\n    var defaultOffset = 0;\n    var defaultRepeat = 1;\n\n    /**\n     * A {@link MaterialProperty} that maps to stripe {@link Material} uniforms.\n     * @alias StripeMaterialProperty\n     * @constructor\n     *\n     * @param {Object} [options] Object with the following properties:\n     * @param {Property} [options.orientation=StripeOrientation.HORIZONTAL] A Property specifying the {@link StripeOrientation}.\n     * @param {Property} [options.evenColor=Color.WHITE] A Property specifying the first {@link Color}.\n     * @param {Property} [options.oddColor=Color.BLACK] A Property specifying the second {@link Color}.\n     * @param {Property} [options.offset=0] A numeric Property specifying how far into the pattern to start the material.\n     * @param {Property} [options.repeat=1] A numeric Property specifying how many times the stripes repeat.\n     */\n    function StripeMaterialProperty(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        this._definitionChanged = new Event();\n        this._orientation = undefined;\n        this._orientationSubscription = undefined;\n        this._evenColor = undefined;\n        this._evenColorSubscription = undefined;\n        this._oddColor = undefined;\n        this._oddColorSubscription = undefined;\n        this._offset = undefined;\n        this._offsetSubscription = undefined;\n        this._repeat = undefined;\n        this._repeatSubscription = undefined;\n\n        this.orientation = options.orientation;\n        this.evenColor = options.evenColor;\n        this.oddColor = options.oddColor;\n        this.offset = options.offset;\n        this.repeat = options.repeat;\n    }\n\n    defineProperties(StripeMaterialProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.  A property is considered\n         * constant if getValue always returns the same result for the current definition.\n         * @memberof StripeMaterialProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._orientation) && //\n                       Property.isConstant(this._evenColor) && //\n                       Property.isConstant(this._oddColor) && //\n                       Property.isConstant(this._offset) && //\n                       Property.isConstant(this._repeat);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * The definition is considered to have changed if a call to getValue would return\n         * a different result for the same time.\n         * @memberof StripeMaterialProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n\n        /**\n         * Gets or sets the Property specifying the {@link StripeOrientation}/\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default StripeOrientation.HORIZONTAL\n         */\n        orientation : createPropertyDescriptor('orientation'),\n\n        /**\n         * Gets or sets the Property specifying the first {@link Color}.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.WHITE\n         */\n        evenColor : createPropertyDescriptor('evenColor'),\n\n        /**\n         * Gets or sets the Property specifying the second {@link Color}.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default Color.BLACK\n         */\n        oddColor : createPropertyDescriptor('oddColor'),\n\n        /**\n         * Gets or sets the numeric Property specifying the point into the pattern\n         * to begin drawing; with 0.0 being the beginning of the even color, 1.0 the beginning\n         * of the odd color, 2.0 being the even color again, and any multiple or fractional values\n         * being in between.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default 0.0\n         */\n        offset : createPropertyDescriptor('offset'),\n\n        /**\n         * Gets or sets the numeric Property specifying how many times the stripes repeat.\n         * @memberof StripeMaterialProperty.prototype\n         * @type {Property}\n         * @default 1.0\n         */\n        repeat : createPropertyDescriptor('repeat')\n    });\n\n    /**\n     * Gets the {@link Material} type at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the type.\n     * @returns {String} The type of material.\n     */\n    StripeMaterialProperty.prototype.getType = function(time) {\n        return 'Stripe';\n    };\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} time The time for which to retrieve the value.\n     * @param {Object} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Object} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    StripeMaterialProperty.prototype.getValue = function(time, result) {\n        if (!defined(result)) {\n            result = {};\n        }\n        result.horizontal = Property.getValueOrDefault(this._orientation, time, defaultOrientation) === StripeOrientation.HORIZONTAL;\n        result.evenColor = Property.getValueOrClonedDefault(this._evenColor, time, defaultEvenColor, result.evenColor);\n        result.oddColor = Property.getValueOrClonedDefault(this._oddColor, time, defaultOddColor, result.oddColor);\n        result.offset = Property.getValueOrDefault(this._offset, time, defaultOffset);\n        result.repeat = Property.getValueOrDefault(this._repeat, time, defaultRepeat);\n        return result;\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    StripeMaterialProperty.prototype.equals = function(other) {\n        return this === other || //\n               (other instanceof StripeMaterialProperty && //\n                       Property.equals(this._orientation, other._orientation) && //\n                       Property.equals(this._evenColor, other._evenColor) && //\n                       Property.equals(this._oddColor, other._oddColor) && //\n                       Property.equals(this._offset, other._offset) && //\n                       Property.equals(this._repeat, other._repeat));\n    };\nexport default StripeMaterialProperty;\n","import Cartesian3 from '../Core/Cartesian3.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Event from '../Core/Event.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport Property from './Property.js';\n\n    /**\n     * A {@link Property} which evaluates to a {@link Cartesian3} vector\n     * based on the velocity of the provided {@link PositionProperty}.\n     *\n     * @alias VelocityVectorProperty\n     * @constructor\n     *\n     * @param {Property} [position] The position property used to compute the velocity.\n     * @param {Boolean} [normalize=true] Whether to normalize the computed velocity vector.\n     *\n     * @example\n     * //Create an entity with a billboard rotated to match its velocity.\n     * var position = new Cesium.SampledProperty();\n     * position.addSamples(...);\n     * var entity = viewer.entities.add({\n     *   position : position,\n     *   billboard : {\n     *     image : 'image.png',\n     *     alignedAxis : new Cesium.VelocityVectorProperty(position, true) // alignedAxis must be a unit vector\n     *   }\n     * }));\n     */\n    function VelocityVectorProperty(position, normalize) {\n        this._position = undefined;\n        this._subscription = undefined;\n        this._definitionChanged = new Event();\n        this._normalize = defaultValue(normalize, true);\n\n        this.position = position;\n    }\n\n    defineProperties(VelocityVectorProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._position);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the position property used to compute the velocity vector.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Property}\n         */\n        position : {\n            get : function() {\n                return this._position;\n            },\n            set : function(value) {\n                var oldValue = this._position;\n                if (oldValue !== value) {\n                    if (defined(oldValue)) {\n                        this._subscription();\n                    }\n\n                    this._position = value;\n\n                    if (defined(value)) {\n                        this._subscription = value._definitionChanged.addEventListener(function() {\n                            this._definitionChanged.raiseEvent(this);\n                        }, this);\n                    }\n\n                    this._definitionChanged.raiseEvent(this);\n                }\n            }\n        },\n        /**\n         * Gets or sets whether the vector produced by this property\n         * will be normalized or not.\n         * @memberof VelocityVectorProperty.prototype\n         *\n         * @type {Boolean}\n         */\n        normalize : {\n            get : function() {\n                return this._normalize;\n            },\n            set : function(value) {\n                if (this._normalize === value) {\n                    return;\n                }\n\n                this._normalize = value;\n                this._definitionChanged.raiseEvent(this);\n            }\n        }\n    });\n\n    var position1Scratch = new Cartesian3();\n    var position2Scratch = new Cartesian3();\n    var timeScratch = new JulianDate();\n    var step = 1.0 / 60.0;\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} [time] The time for which to retrieve the value.\n     * @param {Cartesian3} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Cartesian3} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    VelocityVectorProperty.prototype.getValue = function(time, result) {\n        return this._getValue(time, result);\n    };\n\n    /**\n     * @private\n     */\n    VelocityVectorProperty.prototype._getValue = function(time, velocityResult, positionResult) {\n        \n\n        if (!defined(velocityResult)) {\n            velocityResult = new Cartesian3();\n        }\n\n        var property = this._position;\n        if (Property.isConstant(property)) {\n            return this._normalize ? undefined : Cartesian3.clone(Cartesian3.ZERO, velocityResult);\n        }\n\n        var position1 = property.getValue(time, position1Scratch);\n        var position2 = property.getValue(JulianDate.addSeconds(time, step, timeScratch), position2Scratch);\n\n        //If we don't have a position for now, return undefined.\n        if (!defined(position1)) {\n            return undefined;\n        }\n\n        //If we don't have a position for now + step, see if we have a position for now - step.\n        if (!defined(position2)) {\n            position2 = position1;\n            position1 = property.getValue(JulianDate.addSeconds(time, -step, timeScratch), position2Scratch);\n\n            if (!defined(position1)) {\n                return undefined;\n            }\n        }\n\n        if (Cartesian3.equals(position1, position2)) {\n            return this._normalize ? undefined : Cartesian3.clone(Cartesian3.ZERO, velocityResult);\n        }\n\n        if (defined(positionResult)) {\n            position1.clone(positionResult);\n        }\n\n        var velocity = Cartesian3.subtract(position2, position1, velocityResult);\n        if (this._normalize) {\n            return Cartesian3.normalize(velocity, velocityResult);\n        }\n\n        return Cartesian3.divideByScalar(velocity, step, velocityResult);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    VelocityVectorProperty.prototype.equals = function(other) {\n        return this === other ||//\n               (other instanceof VelocityVectorProperty &&\n                Property.equals(this._position, other._position));\n    };\nexport default VelocityVectorProperty;\n","import Cartesian3 from '../Core/Cartesian3.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport Matrix3 from '../Core/Matrix3.js';\nimport Quaternion from '../Core/Quaternion.js';\nimport Transforms from '../Core/Transforms.js';\nimport Property from './Property.js';\nimport VelocityVectorProperty from './VelocityVectorProperty.js';\n\n    /**\n     * A {@link Property} which evaluates to a {@link Quaternion} rotation\n     * based on the velocity of the provided {@link PositionProperty}.\n     *\n     * @alias VelocityOrientationProperty\n     * @constructor\n     *\n     * @param {Property} [position] The position property used to compute the orientation.\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid used to determine which way is up.\n     *\n     * @example\n     * //Create an entity with position and orientation.\n     * var position = new Cesium.SampledProperty();\n     * position.addSamples(...);\n     * var entity = viewer.entities.add({\n     *   position : position,\n     *   orientation : new Cesium.VelocityOrientationProperty(position)\n     * }));\n     */\n    function VelocityOrientationProperty(position, ellipsoid) {\n        this._velocityVectorProperty = new VelocityVectorProperty(position, true);\n        this._subscription = undefined;\n        this._ellipsoid = undefined;\n        this._definitionChanged = new Event();\n\n        this.ellipsoid = defaultValue(ellipsoid, Ellipsoid.WGS84);\n\n        var that = this;\n        this._velocityVectorProperty.definitionChanged.addEventListener(function() {\n            that._definitionChanged.raiseEvent(that);\n        });\n    }\n\n    defineProperties(VelocityOrientationProperty.prototype, {\n        /**\n         * Gets a value indicating if this property is constant.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Boolean}\n         * @readonly\n         */\n        isConstant : {\n            get : function() {\n                return Property.isConstant(this._velocityVectorProperty);\n            }\n        },\n        /**\n         * Gets the event that is raised whenever the definition of this property changes.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Event}\n         * @readonly\n         */\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        },\n        /**\n         * Gets or sets the position property used to compute orientation.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Property}\n         */\n        position : {\n            get : function() {\n                return this._velocityVectorProperty.position;\n            },\n            set : function(value) {\n                this._velocityVectorProperty.position = value;\n            }\n        },\n        /**\n         * Gets or sets the ellipsoid used to determine which way is up.\n         * @memberof VelocityOrientationProperty.prototype\n         *\n         * @type {Property}\n         */\n        ellipsoid : {\n            get : function() {\n                return this._ellipsoid;\n            },\n            set : function(value) {\n                var oldValue = this._ellipsoid;\n                if (oldValue !== value) {\n                    this._ellipsoid = value;\n                    this._definitionChanged.raiseEvent(this);\n                }\n            }\n        }\n    });\n\n    var positionScratch = new Cartesian3();\n    var velocityScratch = new Cartesian3();\n    var rotationScratch = new Matrix3();\n\n    /**\n     * Gets the value of the property at the provided time.\n     *\n     * @param {JulianDate} [time] The time for which to retrieve the value.\n     * @param {Quaternion} [result] The object to store the value into, if omitted, a new instance is created and returned.\n     * @returns {Quaternion} The modified result parameter or a new instance if the result parameter was not supplied.\n     */\n    VelocityOrientationProperty.prototype.getValue = function(time, result) {\n        var velocity = this._velocityVectorProperty._getValue(time, velocityScratch, positionScratch);\n\n        if (!defined(velocity)) {\n            return undefined;\n        }\n\n        Transforms.rotationMatrixFromPositionVelocity(positionScratch, velocity, this._ellipsoid, rotationScratch);\n        return Quaternion.fromRotationMatrix(rotationScratch, result);\n    };\n\n    /**\n     * Compares this property to the provided property and returns\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\n     *\n     * @param {Property} [other] The other property.\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\n     */\n    VelocityOrientationProperty.prototype.equals = function(other) {\n        return this === other ||//\n               (other instanceof VelocityOrientationProperty &&\n                Property.equals(this._velocityVectorProperty, other._velocityVectorProperty) &&\n                (this._ellipsoid === other._ellipsoid ||\n                 this._ellipsoid.equals(other._ellipsoid)));\n    };\nexport default VelocityOrientationProperty;\n","import ArcType from '../Core/ArcType.js';\nimport BoundingRectangle from '../Core/BoundingRectangle.js';\nimport Cartesian2 from '../Core/Cartesian2.js';\nimport Cartesian3 from '../Core/Cartesian3.js';\nimport Cartographic from '../Core/Cartographic.js';\nimport ClockRange from '../Core/ClockRange.js';\nimport ClockStep from '../Core/ClockStep.js';\nimport Color from '../Core/Color.js';\nimport CornerType from '../Core/CornerType.js';\nimport Credit from '../Core/Credit.js';\nimport createGuid from '../Core/createGuid.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport DistanceDisplayCondition from '../Core/DistanceDisplayCondition.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport ExtrapolationType from '../Core/ExtrapolationType.js';\nimport getFilenameFromUri from '../Core/getFilenameFromUri.js';\nimport HermitePolynomialApproximation from '../Core/HermitePolynomialApproximation.js';\nimport isArray from '../Core/isArray.js';\nimport Iso8601 from '../Core/Iso8601.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport LagrangePolynomialApproximation from '../Core/LagrangePolynomialApproximation.js';\nimport LinearApproximation from '../Core/LinearApproximation.js';\nimport CesiumMath from '../Core/Math.js';\nimport NearFarScalar from '../Core/NearFarScalar.js';\nimport PolygonHierarchy from '../Core/PolygonHierarchy.js';\nimport Quaternion from '../Core/Quaternion.js';\nimport Rectangle from '../Core/Rectangle.js';\nimport ReferenceFrame from '../Core/ReferenceFrame.js';\nimport Resource from '../Core/Resource.js';\nimport RuntimeError from '../Core/RuntimeError.js';\nimport Spherical from '../Core/Spherical.js';\nimport TimeInterval from '../Core/TimeInterval.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport ClassificationType from '../Scene/ClassificationType.js';\nimport ColorBlendMode from '../Scene/ColorBlendMode.js';\nimport HeightReference from '../Scene/HeightReference.js';\nimport HorizontalOrigin from '../Scene/HorizontalOrigin.js';\nimport LabelStyle from '../Scene/LabelStyle.js';\nimport ShadowMode from '../Scene/ShadowMode.js';\nimport VerticalOrigin from '../Scene/VerticalOrigin.js';\nimport Uri from '../ThirdParty/Uri.js';\nimport when from '../ThirdParty/when.js';\nimport BillboardGraphics from './BillboardGraphics.js';\nimport BoxGraphics from './BoxGraphics.js';\nimport CallbackProperty from './CallbackProperty.js';\nimport CheckerboardMaterialProperty from './CheckerboardMaterialProperty.js';\nimport ColorMaterialProperty from './ColorMaterialProperty.js';\nimport CompositeMaterialProperty from './CompositeMaterialProperty.js';\nimport CompositePositionProperty from './CompositePositionProperty.js';\nimport CompositeProperty from './CompositeProperty.js';\nimport ConstantPositionProperty from './ConstantPositionProperty.js';\nimport ConstantProperty from './ConstantProperty.js';\nimport CorridorGraphics from './CorridorGraphics.js';\nimport CylinderGraphics from './CylinderGraphics.js';\nimport DataSource from './DataSource.js';\nimport DataSourceClock from './DataSourceClock.js';\nimport EllipseGraphics from './EllipseGraphics.js';\nimport EllipsoidGraphics from './EllipsoidGraphics.js';\nimport EntityCluster from './EntityCluster.js';\nimport EntityCollection from './EntityCollection.js';\nimport GridMaterialProperty from './GridMaterialProperty.js';\nimport ImageMaterialProperty from './ImageMaterialProperty.js';\nimport LabelGraphics from './LabelGraphics.js';\nimport ModelGraphics from './ModelGraphics.js';\nimport NodeTransformationProperty from './NodeTransformationProperty.js';\nimport PathGraphics from './PathGraphics.js';\nimport PointGraphics from './PointGraphics.js';\nimport PolygonGraphics from './PolygonGraphics.js';\nimport PolylineArrowMaterialProperty from './PolylineArrowMaterialProperty.js';\nimport PolylineDashMaterialProperty from './PolylineDashMaterialProperty.js';\nimport PolylineGlowMaterialProperty from './PolylineGlowMaterialProperty.js';\nimport PolylineGraphics from './PolylineGraphics.js';\nimport PolylineOutlineMaterialProperty from './PolylineOutlineMaterialProperty.js';\nimport PositionPropertyArray from './PositionPropertyArray.js';\nimport Property from './Property.js';\nimport PropertyArray from './PropertyArray.js';\nimport PropertyBag from './PropertyBag.js';\nimport RectangleGraphics from './RectangleGraphics.js';\nimport ReferenceProperty from './ReferenceProperty.js';\nimport Rotation from './Rotation.js';\nimport SampledPositionProperty from './SampledPositionProperty.js';\nimport SampledProperty from './SampledProperty.js';\nimport StripeMaterialProperty from './StripeMaterialProperty.js';\nimport StripeOrientation from './StripeOrientation.js';\nimport TimeIntervalCollectionPositionProperty from './TimeIntervalCollectionPositionProperty.js';\nimport TimeIntervalCollectionProperty from './TimeIntervalCollectionProperty.js';\nimport VelocityOrientationProperty from './VelocityOrientationProperty.js';\nimport VelocityVectorProperty from './VelocityVectorProperty.js';\nimport WallGraphics from './WallGraphics.js';\n\n    // A marker type to distinguish CZML properties where we need to end up with a unit vector.\n    // The data is still loaded into Cartesian3 objects but they are normalized.\n    function UnitCartesian3() {}\n    UnitCartesian3.packedLength = Cartesian3.packedLength;\n    UnitCartesian3.unpack = Cartesian3.unpack;\n    UnitCartesian3.pack = Cartesian3.pack;\n\n    // As a side note, for the purposes of CZML, Quaternion always indicates a unit quaternion.\n\n    var currentId;\n\n    function createReferenceProperty(entityCollection, referenceString) {\n        if (referenceString[0] === '#') {\n            referenceString = currentId + referenceString;\n        }\n        return ReferenceProperty.fromString(entityCollection, referenceString);\n    }\n\n    function createSpecializedProperty(type, entityCollection, packetData) {\n        if (defined(packetData.reference)) {\n            return createReferenceProperty(entityCollection, packetData.reference);\n        }\n\n        if (defined(packetData.velocityReference)) {\n            var referenceProperty = createReferenceProperty(entityCollection, packetData.velocityReference);\n            switch (type) {\n                case Cartesian3:\n                case UnitCartesian3:\n                    return new VelocityVectorProperty(referenceProperty, type === UnitCartesian3);\n                case Quaternion:\n                    return new VelocityOrientationProperty(referenceProperty);\n            }\n        }\n\n        throw new RuntimeError(JSON.stringify(packetData) + ' is not valid CZML.');\n    }\n\n    function createAdapterProperty(property, adapterFunction) {\n        return new CallbackProperty(function(time, result) {\n            return adapterFunction(property.getValue(time, result));\n        }, property.isConstant);\n    }\n\n    var scratchCartesian = new Cartesian3();\n    var scratchSpherical = new Spherical();\n    var scratchCartographic = new Cartographic();\n    var scratchTimeInterval = new TimeInterval();\n    var scratchQuaternion = new Quaternion();\n\n    function unwrapColorInterval(czmlInterval) {\n        var rgbaf = czmlInterval.rgbaf;\n        if (defined(rgbaf)) {\n            return rgbaf;\n        }\n\n        var rgba = czmlInterval.rgba;\n        if (!defined(rgba)) {\n            return undefined;\n        }\n\n        var length = rgba.length;\n        if (length === Color.packedLength) {\n            return [Color.byteToFloat(rgba[0]), Color.byteToFloat(rgba[1]), Color.byteToFloat(rgba[2]), Color.byteToFloat(rgba[3])];\n        }\n\n        rgbaf = new Array(length);\n        for (var i = 0; i < length; i += 5) {\n            rgbaf[i] = rgba[i];\n            rgbaf[i + 1] = Color.byteToFloat(rgba[i + 1]);\n            rgbaf[i + 2] = Color.byteToFloat(rgba[i + 2]);\n            rgbaf[i + 3] = Color.byteToFloat(rgba[i + 3]);\n            rgbaf[i + 4] = Color.byteToFloat(rgba[i + 4]);\n        }\n        return rgbaf;\n    }\n\n    function unwrapUriInterval(czmlInterval, sourceUri) {\n        var uri = defaultValue(czmlInterval.uri, czmlInterval);\n        if (defined(sourceUri)) {\n            return sourceUri.getDerivedResource({\n                url: uri\n            });\n        }\n\n        return Resource.createIfNeeded(uri);\n    }\n\n    function unwrapRectangleInterval(czmlInterval) {\n        var wsen = czmlInterval.wsen;\n        if (defined(wsen)) {\n            return wsen;\n        }\n\n        var wsenDegrees = czmlInterval.wsenDegrees;\n        if (!defined(wsenDegrees)) {\n            return undefined;\n        }\n\n        var length = wsenDegrees.length;\n        if (length === Rectangle.packedLength) {\n            return [CesiumMath.toRadians(wsenDegrees[0]), CesiumMath.toRadians(wsenDegrees[1]), CesiumMath.toRadians(wsenDegrees[2]), CesiumMath.toRadians(wsenDegrees[3])];\n        }\n\n        wsen = new Array(length);\n        for (var i = 0; i < length; i += 5) {\n            wsen[i] = wsenDegrees[i];\n            wsen[i + 1] = CesiumMath.toRadians(wsenDegrees[i + 1]);\n            wsen[i + 2] = CesiumMath.toRadians(wsenDegrees[i + 2]);\n            wsen[i + 3] = CesiumMath.toRadians(wsenDegrees[i + 3]);\n            wsen[i + 4] = CesiumMath.toRadians(wsenDegrees[i + 4]);\n        }\n        return wsen;\n    }\n\n    function convertUnitSphericalToCartesian(unitSpherical) {\n        var length = unitSpherical.length;\n        scratchSpherical.magnitude = 1.0;\n        if (length === 2) {\n            scratchSpherical.clock = unitSpherical[0];\n            scratchSpherical.cone = unitSpherical[1];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length / 3 * 4);\n        for (var i = 0, j = 0; i < length; i += 3, j += 4) {\n            result[j] = unitSpherical[i];\n\n            scratchSpherical.clock = unitSpherical[i + 1];\n            scratchSpherical.cone = unitSpherical[i + 2];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n            result[j + 1] = scratchCartesian.x;\n            result[j + 2] = scratchCartesian.y;\n            result[j + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertSphericalToCartesian(spherical) {\n        var length = spherical.length;\n        if (length === 3) {\n            scratchSpherical.clock = spherical[0];\n            scratchSpherical.cone = spherical[1];\n            scratchSpherical.magnitude = spherical[2];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = spherical[i];\n\n            scratchSpherical.clock = spherical[i + 1];\n            scratchSpherical.cone = spherical[i + 2];\n            scratchSpherical.magnitude = spherical[i + 3];\n            Cartesian3.fromSpherical(scratchSpherical, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertCartographicRadiansToCartesian(cartographicRadians) {\n        var length = cartographicRadians.length;\n        if (length === 3) {\n            scratchCartographic.longitude = cartographicRadians[0];\n            scratchCartographic.latitude = cartographicRadians[1];\n            scratchCartographic.height = cartographicRadians[2];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = cartographicRadians[i];\n\n            scratchCartographic.longitude = cartographicRadians[i + 1];\n            scratchCartographic.latitude = cartographicRadians[i + 2];\n            scratchCartographic.height = cartographicRadians[i + 3];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function convertCartographicDegreesToCartesian(cartographicDegrees) {\n        var length = cartographicDegrees.length;\n        if (length === 3) {\n            scratchCartographic.longitude = CesiumMath.toRadians(cartographicDegrees[0]);\n            scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[1]);\n            scratchCartographic.height = cartographicDegrees[2];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n            return [scratchCartesian.x, scratchCartesian.y, scratchCartesian.z];\n        }\n\n        var result = new Array(length);\n        for (var i = 0; i < length; i += 4) {\n            result[i] = cartographicDegrees[i];\n\n            scratchCartographic.longitude = CesiumMath.toRadians(cartographicDegrees[i + 1]);\n            scratchCartographic.latitude = CesiumMath.toRadians(cartographicDegrees[i + 2]);\n            scratchCartographic.height = cartographicDegrees[i + 3];\n            Ellipsoid.WGS84.cartographicToCartesian(scratchCartographic, scratchCartesian);\n\n            result[i + 1] = scratchCartesian.x;\n            result[i + 2] = scratchCartesian.y;\n            result[i + 3] = scratchCartesian.z;\n        }\n        return result;\n    }\n\n    function unwrapCartesianInterval(czmlInterval) {\n        var cartesian = czmlInterval.cartesian;\n        if (defined(cartesian)) {\n            return cartesian;\n        }\n\n        var cartesianVelocity = czmlInterval.cartesianVelocity;\n        if (defined(cartesianVelocity)) {\n            return cartesianVelocity;\n        }\n\n        var unitCartesian = czmlInterval.unitCartesian;\n        if (defined(unitCartesian)) {\n            return unitCartesian;\n        }\n\n        var unitSpherical = czmlInterval.unitSpherical;\n        if (defined(unitSpherical)) {\n            return convertUnitSphericalToCartesian(unitSpherical);\n        }\n\n        var spherical = czmlInterval.spherical;\n        if (defined(spherical)) {\n            return convertSphericalToCartesian(spherical);\n        }\n\n        var cartographicRadians = czmlInterval.cartographicRadians;\n        if (defined(cartographicRadians)) {\n            return convertCartographicRadiansToCartesian(cartographicRadians);\n        }\n\n        var cartographicDegrees = czmlInterval.cartographicDegrees;\n        if (defined(cartographicDegrees)) {\n            return convertCartographicDegreesToCartesian(cartographicDegrees);\n        }\n\n        throw new RuntimeError(JSON.stringify(czmlInterval) + ' is not a valid CZML interval.');\n    }\n\n    function normalizePackedCartesianArray(array, startingIndex) {\n        Cartesian3.unpack(array, startingIndex, scratchCartesian);\n        Cartesian3.normalize(scratchCartesian, scratchCartesian);\n        Cartesian3.pack(scratchCartesian, array, startingIndex);\n    }\n\n    function unwrapUnitCartesianInterval(czmlInterval) {\n        var cartesian = unwrapCartesianInterval(czmlInterval);\n        if (cartesian.length === 3) {\n            normalizePackedCartesianArray(cartesian, 0);\n            return cartesian;\n        }\n\n        for (var i = 1; i < cartesian.length; i += 4) {\n            normalizePackedCartesianArray(cartesian, i);\n        }\n\n        return cartesian;\n    }\n\n    function normalizePackedQuaternionArray(array, startingIndex) {\n        Quaternion.unpack(array, startingIndex, scratchQuaternion);\n        Quaternion.normalize(scratchQuaternion, scratchQuaternion);\n        Quaternion.pack(scratchQuaternion, array, startingIndex);\n    }\n\n    function unwrapQuaternionInterval(czmlInterval) {\n        var unitQuaternion = czmlInterval.unitQuaternion;\n        if (defined(unitQuaternion)) {\n            if (unitQuaternion.length === 4) {\n                normalizePackedQuaternionArray(unitQuaternion, 0);\n                return unitQuaternion;\n            }\n\n            for (var i = 1; i < unitQuaternion.length; i += 5) {\n                normalizePackedQuaternionArray(unitQuaternion, i);\n            }\n        }\n        return unitQuaternion;\n    }\n\n    function getPropertyType(czmlInterval) {\n        // The associations in this function need to be kept in sync with the\n        // associations in unwrapInterval.\n\n        // Intentionally omitted due to conficts in CZML property names:\n        // * Image (conflicts with Uri)\n        // * Rotation (conflicts with Number)\n        //\n        // cartesianVelocity is also omitted due to incomplete support for\n        // derivative information in CZML properties.\n        // (Currently cartesianVelocity is hacked directly into the position processing code)\n        if (typeof czmlInterval === 'boolean') {\n            return Boolean;\n        } else if (typeof czmlInterval === 'number') {\n            return Number;\n        } else if (typeof czmlInterval === 'string') {\n            return String;\n        } else if (czmlInterval.hasOwnProperty('array')) {\n            return Array;\n        } else if (czmlInterval.hasOwnProperty('boolean')) {\n            return Boolean;\n        } else if (czmlInterval.hasOwnProperty('boundingRectangle')) {\n            return BoundingRectangle;\n        } else if (czmlInterval.hasOwnProperty('cartesian2')) {\n            return Cartesian2;\n        } else if (czmlInterval.hasOwnProperty('cartesian') ||\n                   czmlInterval.hasOwnProperty('spherical') ||\n                   czmlInterval.hasOwnProperty('cartographicRadians') ||\n                   czmlInterval.hasOwnProperty('cartographicDegrees')) {\n            return Cartesian3;\n        } else if (czmlInterval.hasOwnProperty('unitCartesian') ||\n                   czmlInterval.hasOwnProperty('unitSpherical')) {\n            return UnitCartesian3;\n        } else if (czmlInterval.hasOwnProperty('rgba') ||\n                   czmlInterval.hasOwnProperty('rgbaf')) {\n            return Color;\n        } else if (czmlInterval.hasOwnProperty('arcType')) {\n            return ArcType;\n        } else if (czmlInterval.hasOwnProperty('classificationType')) {\n            return ClassificationType;\n        } else if (czmlInterval.hasOwnProperty('colorBlendMode')) {\n            return ColorBlendMode;\n        } else if (czmlInterval.hasOwnProperty('cornerType')) {\n            return CornerType;\n        } else if (czmlInterval.hasOwnProperty('heightReference')) {\n            return HeightReference;\n        } else if (czmlInterval.hasOwnProperty('horizontalOrigin')) {\n            return HorizontalOrigin;\n        } else if (czmlInterval.hasOwnProperty('date')) {\n            return JulianDate;\n        } else if (czmlInterval.hasOwnProperty('labelStyle')) {\n            return LabelStyle;\n        } else if (czmlInterval.hasOwnProperty('number')) {\n            return Number;\n        } else if (czmlInterval.hasOwnProperty('nearFarScalar')) {\n            return NearFarScalar;\n        } else if (czmlInterval.hasOwnProperty('distanceDisplayCondition')) {\n            return DistanceDisplayCondition;\n        } else if (czmlInterval.hasOwnProperty('object') ||\n                   czmlInterval.hasOwnProperty('value')) {\n            return Object;\n        } else if (czmlInterval.hasOwnProperty('unitQuaternion')) {\n            return Quaternion;\n        } else if (czmlInterval.hasOwnProperty('shadowMode')) {\n            return ShadowMode;\n        } else if (czmlInterval.hasOwnProperty('string')) {\n            return String;\n        } else if (czmlInterval.hasOwnProperty('stripeOrientation')) {\n            return StripeOrientation;\n        } else if (czmlInterval.hasOwnProperty('wsen') ||\n                   czmlInterval.hasOwnProperty('wsenDegrees')) {\n            return Rectangle;\n        } else if (czmlInterval.hasOwnProperty('uri')) {\n            return Uri;\n        } else if (czmlInterval.hasOwnProperty('verticalOrigin')) {\n            return VerticalOrigin;\n        }\n        // fallback case\n        return Object;\n    }\n\n    function unwrapInterval(type, czmlInterval, sourceUri) {\n        // The associations in this function need to be kept in sync with the\n        // associations in getPropertyType\n        switch (type) {\n            case ArcType:\n                return ArcType[defaultValue(czmlInterval.arcType, czmlInterval)];\n            case Array:\n                return czmlInterval.array;\n            case Boolean:\n                return defaultValue(czmlInterval['boolean'], czmlInterval);\n            case BoundingRectangle:\n                return czmlInterval.boundingRectangle;\n            case Cartesian2:\n                return czmlInterval.cartesian2;\n            case Cartesian3:\n                return unwrapCartesianInterval(czmlInterval);\n            case UnitCartesian3:\n                return unwrapUnitCartesianInterval(czmlInterval);\n            case Color:\n                return unwrapColorInterval(czmlInterval);\n            case ClassificationType:\n                return ClassificationType[defaultValue(czmlInterval.classificationType, czmlInterval)];\n            case ColorBlendMode:\n                return ColorBlendMode[defaultValue(czmlInterval.colorBlendMode, czmlInterval)];\n            case CornerType:\n                return CornerType[defaultValue(czmlInterval.cornerType, czmlInterval)];\n            case HeightReference:\n                return HeightReference[defaultValue(czmlInterval.heightReference, czmlInterval)];\n            case HorizontalOrigin:\n                return HorizontalOrigin[defaultValue(czmlInterval.horizontalOrigin, czmlInterval)];\n            case Image:\n                return unwrapUriInterval(czmlInterval, sourceUri);\n            case JulianDate:\n                return JulianDate.fromIso8601(defaultValue(czmlInterval.date, czmlInterval));\n            case LabelStyle:\n                return LabelStyle[defaultValue(czmlInterval.labelStyle, czmlInterval)];\n            case Number:\n                return defaultValue(czmlInterval.number, czmlInterval);\n            case NearFarScalar:\n                return czmlInterval.nearFarScalar;\n            case DistanceDisplayCondition:\n                return czmlInterval.distanceDisplayCondition;\n            case Object:\n                return defaultValue(defaultValue(czmlInterval.object, czmlInterval.value), czmlInterval);\n            case Quaternion:\n                return unwrapQuaternionInterval(czmlInterval);\n            case Rectangle:\n                return unwrapRectangleInterval(czmlInterval);\n            case Rotation:\n                return defaultValue(czmlInterval.number, czmlInterval);\n            case ShadowMode:\n                return ShadowMode[defaultValue(defaultValue(czmlInterval.shadowMode, czmlInterval.shadows), czmlInterval)];\n            case String:\n                return defaultValue(czmlInterval.string, czmlInterval);\n            case StripeOrientation:\n                return StripeOrientation[defaultValue(czmlInterval.stripeOrientation, czmlInterval)];\n            case Uri:\n                return unwrapUriInterval(czmlInterval, sourceUri);\n            case VerticalOrigin:\n                return VerticalOrigin[defaultValue(czmlInterval.verticalOrigin, czmlInterval)];\n            default:\n                throw new RuntimeError(type);\n        }\n    }\n\n    var interpolators = {\n        HERMITE : HermitePolynomialApproximation,\n        LAGRANGE : LagrangePolynomialApproximation,\n        LINEAR : LinearApproximation\n    };\n\n    function updateInterpolationSettings(packetData, property) {\n        var interpolationAlgorithm = packetData.interpolationAlgorithm;\n        var interpolationDegree = packetData.interpolationDegree;\n        if (defined(interpolationAlgorithm) || defined(interpolationDegree)) {\n            property.setInterpolationOptions({\n                interpolationAlgorithm : interpolators[interpolationAlgorithm],\n                interpolationDegree : interpolationDegree\n            });\n        }\n\n        var forwardExtrapolationType = packetData.forwardExtrapolationType;\n        if (defined(forwardExtrapolationType)) {\n            property.forwardExtrapolationType = ExtrapolationType[forwardExtrapolationType];\n        }\n\n        var forwardExtrapolationDuration = packetData.forwardExtrapolationDuration;\n        if (defined(forwardExtrapolationDuration)) {\n            property.forwardExtrapolationDuration = forwardExtrapolationDuration;\n        }\n\n        var backwardExtrapolationType = packetData.backwardExtrapolationType;\n        if (defined(backwardExtrapolationType)) {\n            property.backwardExtrapolationType = ExtrapolationType[backwardExtrapolationType];\n        }\n\n        var backwardExtrapolationDuration = packetData.backwardExtrapolationDuration;\n        if (defined(backwardExtrapolationDuration)) {\n            property.backwardExtrapolationDuration = backwardExtrapolationDuration;\n        }\n    }\n\n    var iso8601Scratch = {\n        iso8601 : undefined\n    };\n\n    function intervalFromString(intervalString) {\n        if (!defined(intervalString)) {\n            return undefined;\n        }\n        iso8601Scratch.iso8601 = intervalString;\n        return TimeInterval.fromIso8601(iso8601Scratch);\n    }\n\n    function wrapPropertyInInfiniteInterval(property) {\n        var interval = Iso8601.MAXIMUM_INTERVAL.clone();\n        interval.data = property;\n        return interval;\n    }\n\n    function convertPropertyToComposite(property) {\n        // Create the composite and add the old property, wrapped in an infinite interval.\n        var composite = new CompositeProperty();\n        composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n        return composite;\n    }\n\n    function convertPositionPropertyToComposite(property) {\n        // Create the composite and add the old property, wrapped in an infinite interval.\n        var composite = new CompositePositionProperty(property.referenceFrame);\n        composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n        return composite;\n    }\n\n    function processProperty(type, object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var packedLength;\n        var unwrappedInterval;\n        var unwrappedIntervalLength;\n\n        // CZML properties can be defined in many ways.  Most ways represent a structure for\n        // encoding a single value (number, string, cartesian, etc.)  Regardless of the value type,\n        // if it encodes a single value it will get loaded into a ConstantProperty eventually.\n        // Alternatively, there are ways of defining a property that require specialized\n        // client-side representation. Currently, these are ReferenceProperty,\n        // and client-side velocity computation properties such as VelocityVectorProperty.\n        var isValue = !defined(packetData.reference) && !defined(packetData.velocityReference);\n        var hasInterval = defined(combinedInterval) && !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n        if (packetData.delete === true) {\n            // If deleting this property for all time, we can simply set to undefined and return.\n            if (!hasInterval) {\n                object[propertyName] = undefined;\n                return;\n            }\n\n            // Deleting depends on the type of property we have.\n            return removePropertyData(object[propertyName], combinedInterval);\n        }\n\n        var isSampled = false;\n\n        if (isValue) {\n            unwrappedInterval = unwrapInterval(type, packetData, sourceUri);\n            if (!defined(unwrappedInterval)) {\n                // not a known value type, bail\n                return;\n            }\n            packedLength = defaultValue(type.packedLength, 1);\n            unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n            isSampled = !defined(packetData.array) && (typeof unwrappedInterval !== 'string') && (unwrappedIntervalLength > packedLength) && (type !== Object);\n        }\n\n        // Rotation is a special case because it represents a native type (Number)\n        // and therefore does not need to be unpacked when loaded as a constant value.\n        var needsUnpacking = typeof type.unpack === 'function' && type !== Rotation;\n\n        // Any time a constant value is assigned, it completely blows away anything else.\n        if (!isSampled && !hasInterval) {\n            if (isValue) {\n                object[propertyName] = new ConstantProperty(needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval);\n            } else {\n                object[propertyName] = createSpecializedProperty(type, entityCollection, packetData);\n            }\n            return;\n        }\n\n        var property = object[propertyName];\n\n        var epoch;\n        var packetEpoch = packetData.epoch;\n        if (defined(packetEpoch)) {\n            epoch = JulianDate.fromIso8601(packetEpoch);\n        }\n\n        // Without an interval, any sampled value is infinite, meaning it completely\n        // replaces any non-sampled property that may exist.\n        if (isSampled && !hasInterval) {\n            if (!(property instanceof SampledProperty)) {\n                object[propertyName] = property = new SampledProperty(type);\n            }\n            property.addSamplesPackedArray(unwrappedInterval, epoch);\n            updateInterpolationSettings(packetData, property);\n            return;\n        }\n\n        var interval;\n\n        // A constant value with an interval is normally part of a TimeIntervalCollection,\n        // However, if the current property is not a time-interval collection, we need\n        // to turn it into a Composite, preserving the old data with the new interval.\n        if (!isSampled && hasInterval) {\n            // Create a new interval for the constant value.\n            combinedInterval = combinedInterval.clone();\n            if (isValue) {\n                combinedInterval.data = needsUnpacking ? type.unpack(unwrappedInterval, 0) : unwrappedInterval;\n            } else {\n                combinedInterval.data = createSpecializedProperty(type, entityCollection, packetData);\n            }\n\n            // If no property exists, simply use a new interval collection\n            if (!defined(property)) {\n                object[propertyName] = property = isValue ? new TimeIntervalCollectionProperty() : new CompositeProperty();\n            }\n\n            if (isValue && property instanceof TimeIntervalCollectionProperty) {\n                // If we created a collection, or it already was one, use it.\n                property.intervals.addInterval(combinedInterval);\n            } else if (property instanceof CompositeProperty) {\n                // If the collection was already a CompositeProperty, use it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantProperty(combinedInterval.data);\n                }\n                property.intervals.addInterval(combinedInterval);\n            } else {\n                // Otherwise, create a CompositeProperty but preserve the existing data.\n                object[propertyName] = property = convertPropertyToComposite(property);\n\n                // Change the new data to a ConstantProperty and add it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantProperty(combinedInterval.data);\n                }\n                property.intervals.addInterval(combinedInterval);\n            }\n\n            return;\n        }\n\n        // isSampled && hasInterval\n        if (!defined(property)) {\n            object[propertyName] = property = new CompositeProperty();\n        }\n\n        // Create a CompositeProperty but preserve the existing data.\n        if (!(property instanceof CompositeProperty)) {\n            object[propertyName] = property = convertPropertyToComposite(property);\n        }\n\n        // Check if the interval already exists in the composite.\n        var intervals = property.intervals;\n        interval = intervals.findInterval(combinedInterval);\n        if (!defined(interval) || !(interval.data instanceof SampledProperty)) {\n            // If not, create a SampledProperty for it.\n            interval = combinedInterval.clone();\n            interval.data = new SampledProperty(type);\n            intervals.addInterval(interval);\n        }\n        interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n        updateInterpolationSettings(packetData, interval.data);\n    }\n\n    function removePropertyData(property, interval) {\n        if (property instanceof SampledProperty) {\n            property.removeSamples(interval);\n            return;\n        } else if (property instanceof TimeIntervalCollectionProperty) {\n            property.intervals.removeInterval(interval);\n            return;\n        } else if (property instanceof CompositeProperty) {\n            var intervals = property.intervals;\n            for (var i = 0; i < intervals.length; ++i) {\n                var intersection = TimeInterval.intersect(intervals.get(i), interval, scratchTimeInterval);\n                if (!intersection.isEmpty) {\n                    // remove data from the contained properties\n                    removePropertyData(intersection.data, interval);\n                }\n            }\n            // remove the intervals from the composite\n            intervals.removeInterval(interval);\n            return;\n        }\n    }\n\n    function processPacketData(type, object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processProperty(type, object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processProperty(type, object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processPositionProperty(object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var numberOfDerivatives = defined(packetData.cartesianVelocity) ? 1 : 0;\n        var packedLength = Cartesian3.packedLength * (numberOfDerivatives + 1);\n        var unwrappedInterval;\n        var unwrappedIntervalLength;\n        var isValue = !defined(packetData.reference);\n        var hasInterval = defined(combinedInterval) && !combinedInterval.equals(Iso8601.MAXIMUM_INTERVAL);\n\n        if (packetData.delete === true) {\n            // If deleting this property for all time, we can simply set to undefined and return.\n            if (!hasInterval) {\n                object[propertyName] = undefined;\n                return;\n            }\n\n            // Deleting depends on the type of property we have.\n            return removePositionPropertyData(object[propertyName], combinedInterval);\n        }\n\n        var referenceFrame;\n        var isSampled = false;\n\n        if (isValue) {\n            if (defined(packetData.referenceFrame)) {\n                referenceFrame = ReferenceFrame[packetData.referenceFrame];\n            }\n            referenceFrame = defaultValue(referenceFrame, ReferenceFrame.FIXED);\n            unwrappedInterval = unwrapCartesianInterval(packetData);\n            unwrappedIntervalLength = defaultValue(unwrappedInterval.length, 1);\n            isSampled = unwrappedIntervalLength > packedLength;\n        }\n\n        // Any time a constant value is assigned, it completely blows away anything else.\n        if (!isSampled && !hasInterval) {\n            if (isValue) {\n                object[propertyName] = new ConstantPositionProperty(Cartesian3.unpack(unwrappedInterval), referenceFrame);\n            } else {\n                object[propertyName] = createReferenceProperty(entityCollection, packetData.reference);\n            }\n            return;\n        }\n\n        var property = object[propertyName];\n\n        var epoch;\n        var packetEpoch = packetData.epoch;\n        if (defined(packetEpoch)) {\n            epoch = JulianDate.fromIso8601(packetEpoch);\n        }\n\n        // Without an interval, any sampled value is infinite, meaning it completely\n        // replaces any non-sampled property that may exist.\n        if (isSampled && !hasInterval) {\n            if (!(property instanceof SampledPositionProperty) || (defined(referenceFrame) && property.referenceFrame !== referenceFrame)) {\n                object[propertyName] = property = new SampledPositionProperty(referenceFrame, numberOfDerivatives);\n            }\n            property.addSamplesPackedArray(unwrappedInterval, epoch);\n            updateInterpolationSettings(packetData, property);\n            return;\n        }\n\n        var interval;\n\n        // A constant value with an interval is normally part of a TimeIntervalCollection,\n        // However, if the current property is not a time-interval collection, we need\n        // to turn it into a Composite, preserving the old data with the new interval.\n        if (!isSampled && hasInterval) {\n            // Create a new interval for the constant value.\n            combinedInterval = combinedInterval.clone();\n            if (isValue) {\n                combinedInterval.data = Cartesian3.unpack(unwrappedInterval);\n            } else {\n                combinedInterval.data = createReferenceProperty(entityCollection, packetData.reference);\n            }\n\n            // If no property exists, simply use a new interval collection\n            if (!defined(property)) {\n                if (isValue) {\n                    property = new TimeIntervalCollectionPositionProperty(referenceFrame);\n                } else {\n                    property = new CompositePositionProperty(referenceFrame);\n                }\n                object[propertyName] = property;\n            }\n\n            if (isValue && property instanceof TimeIntervalCollectionPositionProperty && (defined(referenceFrame) && property.referenceFrame === referenceFrame)) {\n                // If we create a collection, or it already existed, use it.\n                property.intervals.addInterval(combinedInterval);\n            } else if (property instanceof CompositePositionProperty) {\n                // If the collection was already a CompositePositionProperty, use it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantPositionProperty(combinedInterval.data, referenceFrame);\n                }\n                property.intervals.addInterval(combinedInterval);\n            } else {\n                // Otherwise, create a CompositePositionProperty but preserve the existing data.\n                object[propertyName] = property = convertPositionPropertyToComposite(property);\n\n                // Change the new data to a ConstantPositionProperty and add it.\n                if (isValue) {\n                    combinedInterval.data = new ConstantPositionProperty(combinedInterval.data, referenceFrame);\n                }\n                property.intervals.addInterval(combinedInterval);\n            }\n\n            return;\n        }\n\n        // isSampled && hasInterval\n        if (!defined(property)) {\n            object[propertyName] = property = new CompositePositionProperty(referenceFrame);\n        } else if (!(property instanceof CompositePositionProperty)) {\n            // Create a CompositeProperty but preserve the existing data.\n            object[propertyName] = property = convertPositionPropertyToComposite(property);\n        }\n\n        // Check if the interval already exists in the composite.\n        var intervals = property.intervals;\n        interval = intervals.findInterval(combinedInterval);\n        if (!defined(interval) || !(interval.data instanceof SampledPositionProperty) || (defined(referenceFrame) && interval.data.referenceFrame !== referenceFrame)) {\n            // If not, create a SampledPositionProperty for it.\n            interval = combinedInterval.clone();\n            interval.data = new SampledPositionProperty(referenceFrame, numberOfDerivatives);\n            intervals.addInterval(interval);\n        }\n        interval.data.addSamplesPackedArray(unwrappedInterval, epoch);\n        updateInterpolationSettings(packetData, interval.data);\n    }\n\n    function removePositionPropertyData(property, interval) {\n        if (property instanceof SampledPositionProperty) {\n            property.removeSamples(interval);\n            return;\n        } else if (property instanceof TimeIntervalCollectionPositionProperty) {\n            property.intervals.removeInterval(interval);\n            return;\n        } else if (property instanceof CompositePositionProperty) {\n            var intervals = property.intervals;\n            for (var i = 0; i < intervals.length; ++i) {\n                var intersection = TimeInterval.intersect(intervals.get(i), interval, scratchTimeInterval);\n                if (!intersection.isEmpty) {\n                    // remove data from the contained properties\n                    removePositionPropertyData(intersection.data, interval);\n                }\n            }\n            // remove the intervals from the composite\n            intervals.removeInterval(interval);\n            return;\n        }\n    }\n\n    function processPositionPacketData(object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processPositionProperty(object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processPositionProperty(object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processMaterialProperty(object, propertyName, packetData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(packetData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var property = object[propertyName];\n        var existingMaterial;\n        var existingInterval;\n\n        if (defined(combinedInterval)) {\n            if (!(property instanceof CompositeMaterialProperty)) {\n                property = new CompositeMaterialProperty();\n                object[propertyName] = property;\n            }\n            //See if we already have data at that interval.\n            var thisIntervals = property.intervals;\n            existingInterval = thisIntervals.findInterval({\n                start : combinedInterval.start,\n                stop : combinedInterval.stop\n            });\n            if (defined(existingInterval)) {\n                //We have an interval, but we need to make sure the\n                //new data is the same type of material as the old data.\n                existingMaterial = existingInterval.data;\n            } else {\n                //If not, create it.\n                existingInterval = combinedInterval.clone();\n                thisIntervals.addInterval(existingInterval);\n            }\n        } else {\n            existingMaterial = property;\n        }\n\n        var materialData;\n        if (defined(packetData.solidColor)) {\n            if (!(existingMaterial instanceof ColorMaterialProperty)) {\n                existingMaterial = new ColorMaterialProperty();\n            }\n            materialData = packetData.solidColor;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n        } else if (defined(packetData.grid)) {\n            if (!(existingMaterial instanceof GridMaterialProperty)) {\n                existingMaterial = new GridMaterialProperty();\n            }\n            materialData = packetData.grid;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'cellAlpha', materialData.cellAlpha, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineCount', materialData.lineCount, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineThickness', materialData.lineThickness, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'lineOffset', materialData.lineOffset, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.image)) {\n            if (!(existingMaterial instanceof ImageMaterialProperty)) {\n                existingMaterial = new ImageMaterialProperty();\n            }\n            materialData = packetData.image;\n            processPacketData(Image, existingMaterial, 'image', materialData.image, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Boolean, existingMaterial, 'transparent', materialData.transparent, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.stripe)) {\n            if (!(existingMaterial instanceof StripeMaterialProperty)) {\n                existingMaterial = new StripeMaterialProperty();\n            }\n            materialData = packetData.stripe;\n            processPacketData(StripeOrientation, existingMaterial, 'orientation', materialData.orientation, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'evenColor', materialData.evenColor, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'oddColor', materialData.oddColor, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'offset', materialData.offset, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineOutline)) {\n            if (!(existingMaterial instanceof PolylineOutlineMaterialProperty)) {\n                existingMaterial = new PolylineOutlineMaterialProperty();\n            }\n            materialData = packetData.polylineOutline;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'outlineColor', materialData.outlineColor, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'outlineWidth', materialData.outlineWidth, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineGlow)) {\n            if (!(existingMaterial instanceof PolylineGlowMaterialProperty)) {\n                existingMaterial = new PolylineGlowMaterialProperty();\n            }\n            materialData = packetData.polylineGlow;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'glowPower', materialData.glowPower, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'taperPower', materialData.taperPower, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.polylineArrow)) {\n            if (!(existingMaterial instanceof PolylineArrowMaterialProperty)) {\n                existingMaterial = new PolylineArrowMaterialProperty();\n            }\n            materialData = packetData.polylineArrow;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n        } else if (defined(packetData.polylineDash)) {\n            if (!(existingMaterial instanceof PolylineDashMaterialProperty)) {\n                existingMaterial = new PolylineDashMaterialProperty();\n            }\n            materialData = packetData.polylineDash;\n            processPacketData(Color, existingMaterial, 'color', materialData.color, undefined, undefined, entityCollection);\n            processPacketData(Color, existingMaterial, 'gapColor', materialData.gapColor, undefined, undefined, entityCollection);\n            processPacketData(Number, existingMaterial, 'dashLength', materialData.dashLength, undefined, sourceUri, entityCollection);\n            processPacketData(Number, existingMaterial, 'dashPattern', materialData.dashPattern, undefined, sourceUri, entityCollection);\n        } else if (defined(packetData.checkerboard)) {\n            if (!(existingMaterial instanceof CheckerboardMaterialProperty)) {\n                existingMaterial = new CheckerboardMaterialProperty();\n            }\n            materialData = packetData.checkerboard;\n            processPacketData(Color, existingMaterial, 'evenColor', materialData.evenColor, undefined, sourceUri, entityCollection);\n            processPacketData(Color, existingMaterial, 'oddColor', materialData.oddColor, undefined, sourceUri, entityCollection);\n            processPacketData(Cartesian2, existingMaterial, 'repeat', materialData.repeat, undefined, sourceUri, entityCollection);\n        }\n\n        if (defined(existingInterval)) {\n            existingInterval.data = existingMaterial;\n        } else {\n            object[propertyName] = existingMaterial;\n        }\n    }\n\n    function processMaterialPacketData(object, propertyName, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                processMaterialProperty(object, propertyName, packetData[i], interval, sourceUri, entityCollection);\n            }\n        } else {\n            processMaterialProperty(object, propertyName, packetData, interval, sourceUri, entityCollection);\n        }\n    }\n\n    function processName(entity, packet, entityCollection, sourceUri) {\n        var nameData = packet.name;\n        if (defined(nameData)) {\n            entity.name = packet.name;\n        }\n    }\n\n    function processDescription(entity, packet, entityCollection, sourceUri) {\n        var descriptionData = packet.description;\n        if (defined(descriptionData)) {\n            processPacketData(String, entity, 'description', descriptionData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processPosition(entity, packet, entityCollection, sourceUri) {\n        var positionData = packet.position;\n        if (defined(positionData)) {\n            processPositionPacketData(entity, 'position', positionData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processViewFrom(entity, packet, entityCollection, sourceUri) {\n        var viewFromData = packet.viewFrom;\n        if (defined(viewFromData)) {\n            processPacketData(Cartesian3, entity, 'viewFrom', viewFromData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processOrientation(entity, packet, entityCollection, sourceUri) {\n        var orientationData = packet.orientation;\n        if (defined(orientationData)) {\n            processPacketData(Quaternion, entity, 'orientation', orientationData, undefined, sourceUri, entityCollection);\n        }\n    }\n\n    function processProperties(entity, packet, entityCollection, sourceUri) {\n        var propertiesData = packet.properties;\n        if (defined(propertiesData)) {\n            if (!defined(entity.properties)) {\n                entity.properties = new PropertyBag();\n            }\n\n            // We cannot simply call processPacketData(entity, 'properties', propertyData, undefined, sourceUri, entityCollection)\n            // because each property of \"properties\" may vary separately.\n            // The properties will be accessible as entity.properties.myprop.getValue(time).\n\n            for (var key in propertiesData) {\n                if (propertiesData.hasOwnProperty(key)) {\n                    if (!entity.properties.hasProperty(key)) {\n                        entity.properties.addProperty(key);\n                    }\n\n                    var propertyData = propertiesData[key];\n                    if (isArray(propertyData)) {\n                        for (var i = 0, len = propertyData.length; i < len; ++i) {\n                            processProperty(getPropertyType(propertyData[i]), entity.properties, key, propertyData[i], undefined, sourceUri, entityCollection);\n                        }\n                    } else {\n                        processProperty(getPropertyType(propertyData), entity.properties, key, propertyData, undefined, sourceUri, entityCollection);\n                    }\n                }\n            }\n        }\n    }\n\n    function processReferencesArrayPacketData(object, propertyName, references, interval, entityCollection, PropertyArrayType, CompositePropertyArrayType) {\n        var properties = references.map(function(reference) {\n            return createReferenceProperty(entityCollection, reference);\n        });\n\n        if (defined(interval)) {\n            interval = intervalFromString(interval);\n            var property = object[propertyName];\n            if (!(property instanceof CompositePropertyArrayType)) {\n                // If the property was not already a CompositeProperty,\n                // create a CompositeProperty but preserve the existing data.\n\n                // Create the composite and add the old property, wrapped in an infinite interval.\n                var composite = new CompositePropertyArrayType();\n                composite.intervals.addInterval(wrapPropertyInInfiniteInterval(property));\n\n                object[propertyName] = property = composite;\n            }\n\n            interval.data = new PropertyArrayType(properties);\n            property.intervals.addInterval(interval);\n        } else {\n            object[propertyName] = new PropertyArrayType(properties);\n        }\n    }\n\n    function processArrayPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            processReferencesArrayPacketData(object, propertyName, references, packetData.interval, entityCollection, PropertyArray, CompositeProperty);\n        } else {\n            processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n        }\n    }\n\n    function processArray(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processArrayPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processArrayPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function processPositionArrayPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            processReferencesArrayPacketData(object, propertyName, references, packetData.interval, entityCollection, PositionPropertyArray, CompositePositionProperty);\n        } else {\n            if (defined(packetData.cartesian)) {\n                packetData.array = Cartesian3.unpackArray(packetData.cartesian);\n            } else if (defined(packetData.cartographicRadians)) {\n                packetData.array = Cartesian3.fromRadiansArrayHeights(packetData.cartographicRadians);\n            } else if (defined(packetData.cartographicDegrees)) {\n                packetData.array = Cartesian3.fromDegreesArrayHeights(packetData.cartographicDegrees);\n            }\n\n            if (defined(packetData.array)) {\n                processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n            }\n        }\n    }\n\n    function processPositionArray(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processPositionArrayPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processPositionArrayPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function unpackCartesianArray(array) {\n        return Cartesian3.unpackArray(array);\n    }\n\n    function unpackCartographicRadiansArray(array) {\n        return Cartesian3.fromRadiansArrayHeights(array);\n    }\n\n    function unpackCartographicDegreesArray(array) {\n        return Cartesian3.fromDegreesArrayHeights(array);\n    }\n\n    function processPositionArrayOfArraysPacketData(object, propertyName, packetData, entityCollection) {\n        var references = packetData.references;\n        if (defined(references)) {\n            var properties = references.map(function(referenceArray) {\n                var tempObj = {};\n                processReferencesArrayPacketData(tempObj, 'positions', referenceArray, packetData.interval, entityCollection, PositionPropertyArray, CompositePositionProperty);\n                return tempObj.positions;\n            });\n            object[propertyName] = new PositionPropertyArray(properties);\n        } else {\n            if (defined(packetData.cartesian)) {\n                packetData.array = packetData.cartesian.map(unpackCartesianArray);\n            } else if (defined(packetData.cartographicRadians)) {\n                packetData.array = packetData.cartographicRadians.map(unpackCartographicRadiansArray);\n            } else if (defined(packetData.cartographicDegrees)) {\n                packetData.array = packetData.cartographicDegrees.map(unpackCartographicDegreesArray);\n            }\n\n            if (defined(packetData.array)) {\n                processPacketData(Array, object, propertyName, packetData, undefined, undefined, entityCollection);\n            }\n        }\n    }\n\n    function processPositionArrayOfArrays(object, propertyName, packetData, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        if (isArray(packetData)) {\n            for (var i = 0, length = packetData.length; i < length; ++i) {\n                processPositionArrayOfArraysPacketData(object, propertyName, packetData[i], entityCollection);\n            }\n        } else {\n            processPositionArrayOfArraysPacketData(object, propertyName, packetData, entityCollection);\n        }\n    }\n\n    function processAvailability(entity, packet, entityCollection, sourceUri) {\n        var packetData = packet.availability;\n        if (!defined(packetData)) {\n            return;\n        }\n\n        var intervals;\n        if (isArray(packetData)) {\n            for (var i = 0, len = packetData.length; i < len; ++i) {\n                if (!defined(intervals)) {\n                    intervals = new TimeIntervalCollection();\n                }\n                intervals.addInterval(intervalFromString(packetData[i]));\n            }\n        } else {\n            intervals = new TimeIntervalCollection();\n            intervals.addInterval(intervalFromString(packetData));\n        }\n        entity.availability = intervals;\n    }\n\n    function processAlignedAxis(billboard, packetData, interval, sourceUri, entityCollection) {\n        if (!defined(packetData)) {\n            return;\n        }\n\n        processPacketData(UnitCartesian3, billboard, 'alignedAxis', packetData, interval, sourceUri, entityCollection);\n    }\n\n    function processBillboard(entity, packet, entityCollection, sourceUri) {\n        var billboardData = packet.billboard;\n        if (!defined(billboardData)) {\n            return;\n        }\n\n        var interval = intervalFromString(billboardData.interval);\n        var billboard = entity.billboard;\n        if (!defined(billboard)) {\n            entity.billboard = billboard = new BillboardGraphics();\n        }\n\n        processPacketData(Boolean, billboard, 'show', billboardData.show, interval, sourceUri, entityCollection);\n        processPacketData(Image, billboard, 'image', billboardData.image, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'scale', billboardData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, billboard, 'pixelOffset', billboardData.pixelOffset, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, billboard, 'eyeOffset', billboardData.eyeOffset, interval, sourceUri, entityCollection);\n        processPacketData(HorizontalOrigin, billboard, 'horizontalOrigin', billboardData.horizontalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(VerticalOrigin, billboard, 'verticalOrigin', billboardData.verticalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, billboard, 'heightReference', billboardData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, billboard, 'color', billboardData.color, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, billboard, 'rotation', billboardData.rotation, interval, sourceUri, entityCollection);\n        processAlignedAxis(billboard, billboardData.alignedAxis, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, billboard, 'sizeInMeters', billboardData.sizeInMeters, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'width', billboardData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'height', billboardData.height, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'scaleByDistance', billboardData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'translucencyByDistance', billboardData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, billboard, 'pixelOffsetScaleByDistance', billboardData.pixelOffsetScaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(BoundingRectangle, billboard, 'imageSubRegion', billboardData.imageSubRegion, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, billboard, 'distanceDisplayCondition', billboardData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, billboard, 'disableDepthTestDistance', billboardData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function processBox(entity, packet, entityCollection, sourceUri) {\n        var boxData = packet.box;\n        if (!defined(boxData)) {\n            return;\n        }\n\n        var interval = intervalFromString(boxData.interval);\n        var box = entity.box;\n        if (!defined(box)) {\n            entity.box = box = new BoxGraphics();\n        }\n\n        processPacketData(Boolean, box, 'show', boxData.show, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, box, 'dimensions', boxData.dimensions, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, box, 'heightReference', boxData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, box, 'fill', boxData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(box, 'material', boxData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, box, 'outline', boxData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, box, 'outlineColor', boxData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, box, 'outlineWidth', boxData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, box, 'shadows', boxData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, box, 'distanceDisplayCondition', boxData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processCorridor(entity, packet, entityCollection, sourceUri) {\n        var corridorData = packet.corridor;\n        if (!defined(corridorData)) {\n            return;\n        }\n\n        var interval = intervalFromString(corridorData.interval);\n        var corridor = entity.corridor;\n        if (!defined(corridor)) {\n            entity.corridor = corridor = new CorridorGraphics();\n        }\n\n        processPacketData(Boolean, corridor, 'show', corridorData.show, interval, sourceUri, entityCollection);\n        processPositionArray(corridor, 'positions', corridorData.positions, entityCollection);\n        processPacketData(Number, corridor, 'width', corridorData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'height', corridorData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, corridor, 'heightReference', corridorData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'extrudedHeight', corridorData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, corridor, 'extrudedHeightReference', corridorData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(CornerType, corridor, 'cornerType', corridorData.cornerType, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'granularity', corridorData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, corridor, 'fill', corridorData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(corridor, 'material', corridorData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, corridor, 'outline', corridorData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, corridor, 'outlineColor', corridorData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'outlineWidth', corridorData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, corridor, 'shadows', corridorData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, corridor, 'distanceDisplayCondition', corridorData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, corridor, 'classificationType', corridorData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, corridor, 'zIndex', corridorData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processCylinder(entity, packet, entityCollection, sourceUri) {\n        var cylinderData = packet.cylinder;\n        if (!defined(cylinderData)) {\n            return;\n        }\n\n        var interval = intervalFromString(cylinderData.interval);\n        var cylinder = entity.cylinder;\n        if (!defined(cylinder)) {\n            entity.cylinder = cylinder = new CylinderGraphics();\n        }\n\n        processPacketData(Boolean, cylinder, 'show', cylinderData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'length', cylinderData.length, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'topRadius', cylinderData.topRadius, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'bottomRadius', cylinderData.bottomRadius, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, cylinder, 'heightReference', cylinderData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, cylinder, 'fill', cylinderData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(cylinder, 'material', cylinderData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, cylinder, 'outline', cylinderData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, cylinder, 'outlineColor', cylinderData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'outlineWidth', cylinderData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'numberOfVerticalLines', cylinderData.numberOfVerticalLines, interval, sourceUri, entityCollection);\n        processPacketData(Number, cylinder, 'slices', cylinderData.slices, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, cylinder, 'shadows', cylinderData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, cylinder, 'distanceDisplayCondition', cylinderData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processDocument(packet, dataSource) {\n        var version = packet.version;\n        if (defined(version)) {\n            if (typeof version === 'string') {\n                var tokens = version.split('.');\n                if (tokens.length === 2) {\n                    if (tokens[0] !== '1') {\n                        throw new RuntimeError('Cesium only supports CZML version 1.');\n                    }\n                    dataSource._version = version;\n                }\n            }\n        }\n\n        if (!defined(dataSource._version)) {\n            throw new RuntimeError('CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.');\n        }\n\n        var documentPacket = dataSource._documentPacket;\n\n        if (defined(packet.name)) {\n            documentPacket.name = packet.name;\n        }\n\n        var clockPacket = packet.clock;\n        if (defined(clockPacket)) {\n            var clock = documentPacket.clock;\n            if (!defined(clock)) {\n                documentPacket.clock = {\n                    interval : clockPacket.interval,\n                    currentTime : clockPacket.currentTime,\n                    range : clockPacket.range,\n                    step : clockPacket.step,\n                    multiplier : clockPacket.multiplier\n                };\n            } else {\n                clock.interval = defaultValue(clockPacket.interval, clock.interval);\n                clock.currentTime = defaultValue(clockPacket.currentTime, clock.currentTime);\n                clock.range = defaultValue(clockPacket.range, clock.range);\n                clock.step = defaultValue(clockPacket.step, clock.step);\n                clock.multiplier = defaultValue(clockPacket.multiplier, clock.multiplier);\n            }\n        }\n    }\n\n    function processEllipse(entity, packet, entityCollection, sourceUri) {\n        var ellipseData = packet.ellipse;\n        if (!defined(ellipseData)) {\n            return;\n        }\n\n        var interval = intervalFromString(ellipseData.interval);\n        var ellipse = entity.ellipse;\n        if (!defined(ellipse)) {\n            entity.ellipse = ellipse = new EllipseGraphics();\n        }\n\n        processPacketData(Boolean, ellipse, 'show', ellipseData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'semiMajorAxis', ellipseData.semiMajorAxis, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'semiMinorAxis', ellipseData.semiMinorAxis, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'height', ellipseData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipse, 'heightReference', ellipseData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'extrudedHeight', ellipseData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipse, 'extrudedHeightReference', ellipseData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, ellipse, 'rotation', ellipseData.rotation, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, ellipse, 'stRotation', ellipseData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'granularity', ellipseData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipse, 'fill', ellipseData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(ellipse, 'material', ellipseData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipse, 'outline', ellipseData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, ellipse, 'outlineColor', ellipseData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'outlineWidth', ellipseData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'numberOfVerticalLines', ellipseData.numberOfVerticalLines, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, ellipse, 'shadows', ellipseData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, ellipse, 'distanceDisplayCondition', ellipseData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, ellipse, 'classificationType', ellipseData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipse, 'zIndex', ellipseData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processEllipsoid(entity, packet, entityCollection, sourceUri) {\n        var ellipsoidData = packet.ellipsoid;\n        if (!defined(ellipsoidData)) {\n            return;\n        }\n\n        var interval = intervalFromString(ellipsoidData.interval);\n        var ellipsoid = entity.ellipsoid;\n        if (!defined(ellipsoid)) {\n            entity.ellipsoid = ellipsoid = new EllipsoidGraphics();\n        }\n\n        processPacketData(Boolean, ellipsoid, 'show', ellipsoidData.show, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, ellipsoid, 'radii', ellipsoidData.radii, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, ellipsoid, 'innerRadii', ellipsoidData.innerRadii, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'minimumClock', ellipsoidData.minimumClock, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'maximumClock', ellipsoidData.maximumClock, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'minimumCone', ellipsoidData.minimumCone, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'maximumCone', ellipsoidData.maximumCone, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, ellipsoid, 'heightReference', ellipsoidData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipsoid, 'fill', ellipsoidData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(ellipsoid, 'material', ellipsoidData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, ellipsoid, 'outline', ellipsoidData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, ellipsoid, 'outlineColor', ellipsoidData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'outlineWidth', ellipsoidData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'stackPartitions', ellipsoidData.stackPartitions, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'slicePartitions', ellipsoidData.slicePartitions, interval, sourceUri, entityCollection);\n        processPacketData(Number, ellipsoid, 'subdivisions', ellipsoidData.subdivisions, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, ellipsoid, 'shadows', ellipsoidData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, ellipsoid, 'distanceDisplayCondition', ellipsoidData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processLabel(entity, packet, entityCollection, sourceUri) {\n        var labelData = packet.label;\n        if (!defined(labelData)) {\n            return;\n        }\n\n        var interval = intervalFromString(labelData.interval);\n        var label = entity.label;\n        if (!defined(label)) {\n            entity.label = label = new LabelGraphics();\n        }\n\n        processPacketData(Boolean, label, 'show', labelData.show, interval, sourceUri, entityCollection);\n        processPacketData(String, label, 'text', labelData.text, interval, sourceUri, entityCollection);\n        processPacketData(String, label, 'font', labelData.font, interval, sourceUri, entityCollection);\n        processPacketData(LabelStyle, label, 'style', labelData.style, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'scale', labelData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, label, 'showBackground', labelData.showBackground, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'backgroundColor', labelData.backgroundColor, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, label, 'backgroundPadding', labelData.backgroundPadding, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian2, label, 'pixelOffset', labelData.pixelOffset, interval, sourceUri, entityCollection);\n        processPacketData(Cartesian3, label, 'eyeOffset', labelData.eyeOffset, interval, sourceUri, entityCollection);\n        processPacketData(HorizontalOrigin, label, 'horizontalOrigin', labelData.horizontalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(VerticalOrigin, label, 'verticalOrigin', labelData.verticalOrigin, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, label, 'heightReference', labelData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'fillColor', labelData.fillColor, interval, sourceUri, entityCollection);\n        processPacketData(Color, label, 'outlineColor', labelData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'outlineWidth', labelData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'translucencyByDistance', labelData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'pixelOffsetScaleByDistance', labelData.pixelOffsetScaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, label, 'scaleByDistance', labelData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, label, 'distanceDisplayCondition', labelData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, label, 'disableDepthTestDistance', labelData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function processModel(entity, packet, entityCollection, sourceUri) {\n        var modelData = packet.model;\n        if (!defined(modelData)) {\n            return;\n        }\n\n        var interval = intervalFromString(modelData.interval);\n        var model = entity.model;\n        if (!defined(model)) {\n            entity.model = model = new ModelGraphics();\n        }\n\n        processPacketData(Boolean, model, 'show', modelData.show, interval, sourceUri, entityCollection);\n        processPacketData(Uri, model, 'uri', modelData.gltf, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'scale', modelData.scale, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'minimumPixelSize', modelData.minimumPixelSize, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'maximumScale', modelData.maximumScale, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'incrementallyLoadTextures', modelData.incrementallyLoadTextures, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'runAnimations', modelData.runAnimations, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, model, 'clampAnimations', modelData.clampAnimations, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, model, 'shadows', modelData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, model, 'heightReference', modelData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, model, 'silhouetteColor', modelData.silhouetteColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'silhouetteSize', modelData.silhouetteSize, interval, sourceUri, entityCollection);\n        processPacketData(Color, model, 'color', modelData.color, interval, sourceUri, entityCollection);\n        processPacketData(ColorBlendMode, model, 'colorBlendMode', modelData.colorBlendMode, interval, sourceUri, entityCollection);\n        processPacketData(Number, model, 'colorBlendAmount', modelData.colorBlendAmount, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, model, 'distanceDisplayCondition', modelData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n\n        var i, len;\n        var nodeTransformationsData = modelData.nodeTransformations;\n        if (defined(nodeTransformationsData)) {\n            if (isArray(nodeTransformationsData)) {\n                for (i = 0, len = nodeTransformationsData.length; i < len; ++i) {\n                    processNodeTransformations(model, nodeTransformationsData[i], interval, sourceUri, entityCollection);\n                }\n            } else {\n                processNodeTransformations(model, nodeTransformationsData, interval, sourceUri, entityCollection);\n            }\n        }\n\n        var articulationsData = modelData.articulations;\n        if (defined(articulationsData)) {\n            if (isArray(articulationsData)) {\n                for (i = 0, len = articulationsData.length; i < len; ++i) {\n                    processArticulations(model, articulationsData[i], interval, sourceUri, entityCollection);\n                }\n            } else {\n                processArticulations(model, articulationsData, interval, sourceUri, entityCollection);\n            }\n        }\n    }\n\n    function processNodeTransformations(model, nodeTransformationsData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(nodeTransformationsData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var nodeTransformations = model.nodeTransformations;\n        var nodeNames = Object.keys(nodeTransformationsData);\n        for (var i = 0, len = nodeNames.length; i < len; ++i) {\n            var nodeName = nodeNames[i];\n            if (nodeName === 'interval') {\n                continue;\n            }\n\n            var nodeTransformationData = nodeTransformationsData[nodeName];\n            if (!defined(nodeTransformationData)) {\n                continue;\n            }\n\n            if (!defined(nodeTransformations)) {\n                model.nodeTransformations = nodeTransformations = new PropertyBag();\n            }\n\n            if (!nodeTransformations.hasProperty(nodeName)) {\n                nodeTransformations.addProperty(nodeName);\n            }\n\n            var nodeTransformation = nodeTransformations[nodeName];\n            if (!defined(nodeTransformation)) {\n                nodeTransformations[nodeName] = nodeTransformation = new NodeTransformationProperty();\n            }\n\n            processPacketData(Cartesian3, nodeTransformation, 'translation', nodeTransformationData.translation, combinedInterval, sourceUri, entityCollection);\n            processPacketData(Quaternion, nodeTransformation, 'rotation', nodeTransformationData.rotation, combinedInterval, sourceUri, entityCollection);\n            processPacketData(Cartesian3, nodeTransformation, 'scale', nodeTransformationData.scale, combinedInterval, sourceUri, entityCollection);\n        }\n    }\n\n    function processArticulations(model, articulationsData, constrainedInterval, sourceUri, entityCollection) {\n        var combinedInterval = intervalFromString(articulationsData.interval);\n        if (defined(constrainedInterval)) {\n            if (defined(combinedInterval)) {\n                combinedInterval = TimeInterval.intersect(combinedInterval, constrainedInterval, scratchTimeInterval);\n            } else {\n                combinedInterval = constrainedInterval;\n            }\n        }\n\n        var articulations = model.articulations;\n        var keys = Object.keys(articulationsData);\n        for (var i = 0, len = keys.length; i < len; ++i) {\n            var key = keys[i];\n            if (key === 'interval') {\n                continue;\n            }\n\n            var articulationStageData = articulationsData[key];\n            if (!defined(articulationStageData)) {\n                continue;\n            }\n\n            if (!defined(articulations)) {\n                model.articulations = articulations = new PropertyBag();\n            }\n\n            if (!articulations.hasProperty(key)) {\n                articulations.addProperty(key);\n            }\n\n            processPacketData(Number, articulations, key, articulationStageData, combinedInterval, sourceUri, entityCollection);\n        }\n    }\n\n    function processPath(entity, packet, entityCollection, sourceUri) {\n        var pathData = packet.path;\n        if (!defined(pathData)) {\n            return;\n        }\n\n        var interval = intervalFromString(pathData.interval);\n        var path = entity.path;\n        if (!defined(path)) {\n            entity.path = path = new PathGraphics();\n        }\n\n        processPacketData(Boolean, path, 'show', pathData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'leadTime', pathData.leadTime, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'trailTime', pathData.trailTime, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'width', pathData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, path, 'resolution', pathData.resolution, interval, sourceUri, entityCollection);\n        processMaterialPacketData(path, 'material', pathData.material, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, path, 'distanceDisplayCondition', pathData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processPoint(entity, packet, entityCollection, sourceUri) {\n        var pointData = packet.point;\n        if (!defined(pointData)) {\n            return;\n        }\n\n        var interval = intervalFromString(pointData.interval);\n        var point = entity.point;\n        if (!defined(point)) {\n            entity.point = point = new PointGraphics();\n        }\n\n        processPacketData(Boolean, point, 'show', pointData.show, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'pixelSize', pointData.pixelSize, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, point, 'heightReference', pointData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Color, point, 'color', pointData.color, interval, sourceUri, entityCollection);\n        processPacketData(Color, point, 'outlineColor', pointData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'outlineWidth', pointData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, point, 'scaleByDistance', pointData.scaleByDistance, interval, sourceUri, entityCollection);\n        processPacketData(NearFarScalar, point, 'translucencyByDistance', pointData.translucencyByDistance, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, point, 'distanceDisplayCondition', pointData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(Number, point, 'disableDepthTestDistance', pointData.disableDepthTestDistance, interval, sourceUri, entityCollection);\n    }\n\n    function PolygonHierarchyProperty(polygon) {\n        this.polygon = polygon;\n        this._definitionChanged = new Event();\n    }\n\n    defineProperties(PolygonHierarchyProperty.prototype, {\n        isConstant : {\n            get : function() {\n                var positions = this.polygon._positions;\n                var holes = this.polygon._holes;\n                return (!defined(positions) || positions.isConstant) &&\n                       (!defined(holes) || holes.isConstant);\n            }\n        },\n        definitionChanged : {\n            get : function() {\n                return this._definitionChanged;\n            }\n        }\n    });\n\n    PolygonHierarchyProperty.prototype.getValue = function(time, result) {\n        var positions;\n        if (defined(this.polygon._positions)) {\n            positions = this.polygon._positions.getValue(time);\n        }\n\n        var holes;\n        if (defined(this.polygon._holes)) {\n            holes = this.polygon._holes.getValue(time);\n            if (defined(holes)) {\n                holes = holes.map(function(holePositions) {\n                    return new PolygonHierarchy(holePositions);\n                });\n            }\n        }\n\n        if (!defined(result)) {\n            return new PolygonHierarchy(positions, holes);\n        }\n\n        result.positions = positions;\n        result.holes = holes;\n        return result;\n    };\n\n    PolygonHierarchyProperty.prototype.equals = function(other) {\n        return this === other ||\n               (other instanceof PolygonHierarchyProperty &&\n                Property.equals(this.polygon._positions, other.polygon._positions) &&\n                Property.equals(this.polygon._holes, other.polygon._holes));\n    };\n\n    function processPolygon(entity, packet, entityCollection, sourceUri) {\n        var polygonData = packet.polygon;\n        if (!defined(polygonData)) {\n            return;\n        }\n\n        var interval = intervalFromString(polygonData.interval);\n        var polygon = entity.polygon;\n        if (!defined(polygon)) {\n            entity.polygon = polygon = new PolygonGraphics();\n        }\n\n        processPacketData(Boolean, polygon, 'show', polygonData.show, interval, sourceUri, entityCollection);\n\n        // adapt 'position' property producing Cartesian[]\n        // and 'holes' property producing Cartesian[][]\n        // to a single property producing PolygonHierarchy\n        processPositionArray(polygon, '_positions', polygonData.positions, entityCollection);\n        processPositionArrayOfArrays(polygon, '_holes', polygonData.holes, entityCollection);\n        if (defined(polygon._positions) || defined(polygon._holes)) {\n            polygon.hierarchy = new PolygonHierarchyProperty(polygon);\n        }\n\n        processPacketData(Number, polygon, 'height', polygonData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, polygon, 'heightReference', polygonData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'extrudedHeight', polygonData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, polygon, 'extrudedHeightReference', polygonData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, polygon, 'stRotation', polygonData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'granularity', polygonData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'fill', polygonData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polygon, 'material', polygonData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'outline', polygonData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, polygon, 'outlineColor', polygonData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'outlineWidth', polygonData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'perPositionHeight', polygonData.perPositionHeight, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'closeTop', polygonData.closeTop, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polygon, 'closeBottom', polygonData.closeBottom, interval, sourceUri, entityCollection);\n        processPacketData(ArcType, polygon, 'arcType', polygonData.arcType, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, polygon, 'shadows', polygonData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, polygon, 'distanceDisplayCondition', polygonData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, polygon, 'classificationType', polygonData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, polygon, 'zIndex', polygonData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function adaptFollowSurfaceToArcType(followSurface) {\n        return followSurface ? ArcType.GEODESIC : ArcType.NONE;\n    }\n\n    function processPolyline(entity, packet, entityCollection, sourceUri) {\n        var polylineData = packet.polyline;\n        if (!defined(polylineData)) {\n            return;\n        }\n\n        var interval = intervalFromString(polylineData.interval);\n        var polyline = entity.polyline;\n        if (!defined(polyline)) {\n            entity.polyline = polyline = new PolylineGraphics();\n        }\n\n        processPacketData(Boolean, polyline, 'show', polylineData.show, interval, sourceUri, entityCollection);\n        processPositionArray(polyline, 'positions', polylineData.positions, entityCollection);\n        processPacketData(Number, polyline, 'width', polylineData.width, interval, sourceUri, entityCollection);\n        processPacketData(Number, polyline, 'granularity', polylineData.granularity, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polyline, 'material', polylineData.material, interval, sourceUri, entityCollection);\n        processMaterialPacketData(polyline, 'depthFailMaterial', polylineData.depthFailMaterial, interval, sourceUri, entityCollection);\n        processPacketData(ArcType, polyline, 'arcType', polylineData.arcType, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, polyline, 'clampToGround', polylineData.clampToGround, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, polyline, 'shadows', polylineData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, polyline, 'distanceDisplayCondition', polylineData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, polyline, 'classificationType', polylineData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, polyline, 'zIndex', polylineData.zIndex, interval, sourceUri, entityCollection);\n\n        // for backwards compatibility, adapt CZML followSurface to arcType.\n        if (defined(polylineData.followSurface) && !defined(polylineData.arcType)) {\n            var tempObj = {};\n            processPacketData(Boolean, tempObj, 'followSurface', polylineData.followSurface, interval, sourceUri, entityCollection);\n            polyline.arcType = createAdapterProperty(tempObj.followSurface, adaptFollowSurfaceToArcType);\n        }\n    }\n\n    function processRectangle(entity, packet, entityCollection, sourceUri) {\n        var rectangleData = packet.rectangle;\n        if (!defined(rectangleData)) {\n            return;\n        }\n\n        var interval = intervalFromString(rectangleData.interval);\n        var rectangle = entity.rectangle;\n        if (!defined(rectangle)) {\n            entity.rectangle = rectangle = new RectangleGraphics();\n        }\n\n        processPacketData(Boolean, rectangle, 'show', rectangleData.show, interval, sourceUri, entityCollection);\n        processPacketData(Rectangle, rectangle, 'coordinates', rectangleData.coordinates, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'height', rectangleData.height, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, rectangle, 'heightReference', rectangleData.heightReference, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'extrudedHeight', rectangleData.extrudedHeight, interval, sourceUri, entityCollection);\n        processPacketData(HeightReference, rectangle, 'extrudedHeightReference', rectangleData.extrudedHeightReference, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, rectangle, 'rotation', rectangleData.rotation, interval, sourceUri, entityCollection);\n        processPacketData(Rotation, rectangle, 'stRotation', rectangleData.stRotation, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'granularity', rectangleData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, rectangle, 'fill', rectangleData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(rectangle, 'material', rectangleData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, rectangle, 'outline', rectangleData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, rectangle, 'outlineColor', rectangleData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'outlineWidth', rectangleData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, rectangle, 'shadows', rectangleData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, rectangle, 'distanceDisplayCondition', rectangleData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n        processPacketData(ClassificationType, rectangle, 'classificationType', rectangleData.classificationType, interval, sourceUri, entityCollection);\n        processPacketData(Number, rectangle, 'zIndex', rectangleData.zIndex, interval, sourceUri, entityCollection);\n    }\n\n    function processWall(entity, packet, entityCollection, sourceUri) {\n        var wallData = packet.wall;\n        if (!defined(wallData)) {\n            return;\n        }\n\n        var interval = intervalFromString(wallData.interval);\n        var wall = entity.wall;\n        if (!defined(wall)) {\n            entity.wall = wall = new WallGraphics();\n        }\n\n        processPacketData(Boolean, wall, 'show', wallData.show, interval, sourceUri, entityCollection);\n        processPositionArray(wall, 'positions', wallData.positions, entityCollection);\n        processArray(wall, 'minimumHeights', wallData.minimumHeights, entityCollection);\n        processArray(wall, 'maximumHeights', wallData.maximumHeights, entityCollection);\n        processPacketData(Number, wall, 'granularity', wallData.granularity, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, wall, 'fill', wallData.fill, interval, sourceUri, entityCollection);\n        processMaterialPacketData(wall, 'material', wallData.material, interval, sourceUri, entityCollection);\n        processPacketData(Boolean, wall, 'outline', wallData.outline, interval, sourceUri, entityCollection);\n        processPacketData(Color, wall, 'outlineColor', wallData.outlineColor, interval, sourceUri, entityCollection);\n        processPacketData(Number, wall, 'outlineWidth', wallData.outlineWidth, interval, sourceUri, entityCollection);\n        processPacketData(ShadowMode, wall, 'shadows', wallData.shadows, interval, sourceUri, entityCollection);\n        processPacketData(DistanceDisplayCondition, wall, 'distanceDisplayCondition', wallData.distanceDisplayCondition, interval, sourceUri, entityCollection);\n    }\n\n    function processCzmlPacket(packet, entityCollection, updaterFunctions, sourceUri, dataSource) {\n        var objectId = packet.id;\n        if (!defined(objectId)) {\n            objectId = createGuid();\n        }\n\n        currentId = objectId;\n\n        if (!defined(dataSource._version) && objectId !== 'document') {\n            throw new RuntimeError('The first CZML packet is required to be the document object.');\n        }\n\n        if (packet['delete'] === true) {\n            entityCollection.removeById(objectId);\n        } else if (objectId === 'document') {\n            processDocument(packet, dataSource);\n        } else {\n            var entity = entityCollection.getOrCreateEntity(objectId);\n\n            var parentId = packet.parent;\n            if (defined(parentId)) {\n                entity.parent = entityCollection.getOrCreateEntity(parentId);\n            }\n\n            for (var i = updaterFunctions.length - 1; i > -1; i--) {\n                updaterFunctions[i](entity, packet, entityCollection, sourceUri);\n            }\n        }\n\n        currentId = undefined;\n    }\n\n    function updateClock(dataSource) {\n        var clock;\n        var clockPacket = dataSource._documentPacket.clock;\n        if (!defined(clockPacket)) {\n            if (!defined(dataSource._clock)) {\n                var availability = dataSource._entityCollection.computeAvailability();\n                if (!availability.start.equals(Iso8601.MINIMUM_VALUE)) {\n                    var startTime = availability.start;\n                    var stopTime = availability.stop;\n                    var totalSeconds = JulianDate.secondsDifference(stopTime, startTime);\n                    var multiplier = Math.round(totalSeconds / 120.0);\n\n                    clock = new DataSourceClock();\n                    clock.startTime = JulianDate.clone(startTime);\n                    clock.stopTime = JulianDate.clone(stopTime);\n                    clock.clockRange = ClockRange.LOOP_STOP;\n                    clock.multiplier = multiplier;\n                    clock.currentTime = JulianDate.clone(startTime);\n                    clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n                    dataSource._clock = clock;\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        if (defined(dataSource._clock)) {\n            clock = dataSource._clock.clone();\n        } else {\n            clock = new DataSourceClock();\n            clock.startTime = Iso8601.MINIMUM_VALUE.clone();\n            clock.stopTime = Iso8601.MAXIMUM_VALUE.clone();\n            clock.currentTime = Iso8601.MINIMUM_VALUE.clone();\n            clock.clockRange = ClockRange.LOOP_STOP;\n            clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n            clock.multiplier = 1.0;\n        }\n\n        var interval = intervalFromString(clockPacket.interval);\n        if (defined(interval)) {\n            clock.startTime = interval.start;\n            clock.stopTime = interval.stop;\n        }\n\n        if (defined(clockPacket.currentTime)) {\n            clock.currentTime = JulianDate.fromIso8601(clockPacket.currentTime);\n        }\n        if (defined(clockPacket.range)) {\n            clock.clockRange = defaultValue(ClockRange[clockPacket.range], ClockRange.LOOP_STOP);\n        }\n        if (defined(clockPacket.step)) {\n            clock.clockStep = defaultValue(ClockStep[clockPacket.step], ClockStep.SYSTEM_CLOCK_MULTIPLIER);\n        }\n        if (defined(clockPacket.multiplier)) {\n            clock.multiplier = clockPacket.multiplier;\n        }\n\n        if (!clock.equals(dataSource._clock)) {\n            dataSource._clock = clock.clone(dataSource._clock);\n            return true;\n        }\n\n        return false;\n    }\n\n    function load(dataSource, czml, options, clear) {\n        \n\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n\n        var promise = czml;\n        var sourceUri = options.sourceUri;\n\n        // User specified credit\n        var credit = options.credit;\n        if (typeof credit === 'string') {\n            credit = new Credit(credit);\n        }\n        dataSource._credit = credit;\n\n        // If the czml is a URL\n        if (typeof czml === 'string' || (czml instanceof Resource)) {\n            czml = Resource.createIfNeeded(czml);\n            promise = czml.fetchJson();\n            sourceUri = defaultValue(sourceUri, czml.clone());\n\n            // Add resource credits to our list of credits to display\n            var resourceCredits = dataSource._resourceCredits;\n            var credits = czml.credits;\n            if (defined(credits)) {\n                var length = credits.length;\n                for (var i = 0; i < length; i++) {\n                    resourceCredits.push(credits[i]);\n                }\n            }\n        }\n\n        sourceUri = Resource.createIfNeeded(sourceUri);\n\n        DataSource.setLoading(dataSource, true);\n\n        return when(promise, function(czml) {\n            return loadCzml(dataSource, czml, sourceUri, clear);\n        }).otherwise(function(error) {\n            DataSource.setLoading(dataSource, false);\n            dataSource._error.raiseEvent(dataSource, error);\n            console.log(error);\n            return when.reject(error);\n        });\n    }\n\n    function loadCzml(dataSource, czml, sourceUri, clear) {\n        DataSource.setLoading(dataSource, true);\n        var entityCollection = dataSource._entityCollection;\n\n        if (clear) {\n            dataSource._version = undefined;\n            dataSource._documentPacket = new DocumentPacket();\n            entityCollection.removeAll();\n        }\n\n        CzmlDataSource._processCzml(czml, entityCollection, sourceUri, undefined, dataSource);\n\n        var raiseChangedEvent = updateClock(dataSource);\n\n        var documentPacket = dataSource._documentPacket;\n        if (defined(documentPacket.name) && dataSource._name !== documentPacket.name) {\n            dataSource._name = documentPacket.name;\n            raiseChangedEvent = true;\n        } else if (!defined(dataSource._name) && defined(sourceUri)) {\n            dataSource._name = getFilenameFromUri(sourceUri.getUrlComponent());\n            raiseChangedEvent = true;\n        }\n\n        DataSource.setLoading(dataSource, false);\n        if (raiseChangedEvent) {\n            dataSource._changed.raiseEvent(dataSource);\n        }\n\n        return dataSource;\n    }\n\n    function DocumentPacket() {\n        this.name = undefined;\n        this.clock = undefined;\n    }\n\n    /**\n     * A {@link DataSource} which processes {@link https://github.com/AnalyticalGraphicsInc/czml-writer/wiki/CZML-Guide|CZML}.\n     * @alias CzmlDataSource\n     * @constructor\n     *\n     * @param {String} [name] An optional name for the data source.  This value will be overwritten if a loaded document contains a name.\n     *\n     * @demo {@link https://sandcastle.cesium.com/index.html?src=CZML.html|Cesium Sandcastle CZML Demo}\n     */\n    function CzmlDataSource(name) {\n        this._name = name;\n        this._changed = new Event();\n        this._error = new Event();\n        this._isLoading = false;\n        this._loading = new Event();\n        this._clock = undefined;\n        this._documentPacket = new DocumentPacket();\n        this._version = undefined;\n        this._entityCollection = new EntityCollection(this);\n        this._entityCluster = new EntityCluster();\n        this._credit = undefined;\n        this._resourceCredits = [];\n    }\n\n    /**\n     * Creates a Promise to a new instance loaded with the provided CZML data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to the new instance once the data is processed.\n     */\n    CzmlDataSource.load = function(czml, options) {\n        return new CzmlDataSource().load(czml, options);\n    };\n\n    defineProperties(CzmlDataSource.prototype, {\n        /**\n         * Gets a human-readable name for this instance.\n         * @memberof CzmlDataSource.prototype\n         * @type {String}\n         */\n        name : {\n            get : function() {\n                return this._name;\n            }\n        },\n        /**\n         * Gets the clock settings defined by the loaded CZML.  If no clock is explicitly\n         * defined in the CZML, the combined availability of all objects is returned.  If\n         * only static data exists, this value is undefined.\n         * @memberof CzmlDataSource.prototype\n         * @type {DataSourceClock}\n         */\n        clock : {\n            get : function() {\n                return this._clock;\n            }\n        },\n        /**\n         * Gets the collection of {@link Entity} instances.\n         * @memberof CzmlDataSource.prototype\n         * @type {EntityCollection}\n         */\n        entities : {\n            get : function() {\n                return this._entityCollection;\n            }\n        },\n        /**\n         * Gets a value indicating if the data source is currently loading data.\n         * @memberof CzmlDataSource.prototype\n         * @type {Boolean}\n         */\n        isLoading : {\n            get : function() {\n                return this._isLoading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the underlying data changes.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        changedEvent : {\n            get : function() {\n                return this._changed;\n            }\n        },\n        /**\n         * Gets an event that will be raised if an error is encountered during processing.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        errorEvent : {\n            get : function() {\n                return this._error;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source either starts or stops loading.\n         * @memberof CzmlDataSource.prototype\n         * @type {Event}\n         */\n        loadingEvent : {\n            get : function() {\n                return this._loading;\n            }\n        },\n        /**\n         * Gets whether or not this data source should be displayed.\n         * @memberof CzmlDataSource.prototype\n         * @type {Boolean}\n         */\n        show : {\n            get : function() {\n                return this._entityCollection.show;\n            },\n            set : function(value) {\n                this._entityCollection.show = value;\n            }\n        },\n\n        /**\n         * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n         *\n         * @memberof CzmlDataSource.prototype\n         * @type {EntityCluster}\n         */\n        clustering : {\n            get : function() {\n                return this._entityCluster;\n            },\n            set : function(value) {\n                \n                this._entityCluster = value;\n            }\n        },\n        /**\n         * Gets the credit that will be displayed for the data source\n         * @memberof CzmlDataSource.prototype\n         * @type {Credit}\n         */\n        credit : {\n            get : function() {\n                return this._credit;\n            }\n        }\n    });\n\n    /**\n     * Gets the array of CZML processing functions.\n     * @memberof CzmlDataSource\n     * @type Array\n     */\n    CzmlDataSource.updaters = [\n        processBillboard, //\n        processBox, //\n        processCorridor, //\n        processCylinder, //\n        processEllipse, //\n        processEllipsoid, //\n        processLabel, //\n        processModel, //\n        processName, //\n        processDescription, //\n        processPath, //\n        processPoint, //\n        processPolygon, //\n        processPolyline, //\n        processProperties, //\n        processRectangle, //\n        processPosition, //\n        processViewFrom, //\n        processWall, //\n        processOrientation, //\n        processAvailability];\n\n    /**\n     * Processes the provided url or CZML object without clearing any existing data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n     */\n    CzmlDataSource.prototype.process = function(czml, options) {\n        return load(this, czml, options, false);\n    };\n\n    /**\n     * Loads the provided url or CZML object, replacing any existing data.\n     *\n     * @param {Resource|String|Object} czml A url or CZML object to be processed.\n     * @param {Object} [options] An object with the following properties:\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     * @returns {Promise.<CzmlDataSource>} A promise that resolves to this instances once the data is processed.\n     */\n    CzmlDataSource.prototype.load = function(czml, options) {\n        return load(this, czml, options, true);\n    };\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link Property} from a CZML packet.\n     * @function\n     *\n     * @param {Function} type The constructor function for the property being processed.\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processPacketData = processPacketData;\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link PositionProperty} from a CZML packet.\n     * @function\n     *\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processPositionPacketData = processPositionPacketData;\n\n    /**\n     * A helper function used by custom CZML updater functions\n     * which creates or updates a {@link MaterialProperty} from a CZML packet.\n     * @function\n     *\n     * @param {Object} object The object on which the property will be added or updated.\n     * @param {String} propertyName The name of the property on the object.\n     * @param {Object} packetData The CZML packet being processed.\n     * @param {TimeInterval} interval A constraining interval for which the data is valid.\n     * @param {String} sourceUri The originating uri of the data being processed.\n     * @param {EntityCollection} entityCollection The collection being processsed.\n     */\n    CzmlDataSource.processMaterialPacketData = processMaterialPacketData;\n\n    CzmlDataSource._processCzml = function(czml, entityCollection, sourceUri, updaterFunctions, dataSource) {\n        updaterFunctions = defaultValue(updaterFunctions, CzmlDataSource.updaters);\n\n        if (isArray(czml)) {\n            for (var i = 0, len = czml.length; i < len; ++i) {\n                processCzmlPacket(czml[i], entityCollection, updaterFunctions, sourceUri, dataSource);\n            }\n        } else {\n            processCzmlPacket(czml, entityCollection, updaterFunctions, sourceUri, dataSource);\n        }\n    };\nexport default CzmlDataSource;\n","var tmp = {};\n\n/*!\n * Autolinker.js\n * 3.11.0\n *\n * Copyright(c) 2019 Gregory Jacobs <greg@greg-jacobs.com>\n * MIT License\n *\n * https-colon-slashslash github.com/gregjacobs/Autolinker.js\n */\n(function (global, factory) {\n    global.Autolinker = factory();\n}(tmp, function () { 'use strict';\n\n    /**\n     * Assigns (shallow copies) the properties of `src` onto `dest`, if the\n     * corresponding property on `dest` === `undefined`.\n     *\n     * @param {Object} dest The destination object.\n     * @param {Object} src The source object.\n     * @return {Object} The destination object (`dest`)\n     */\n    function defaults(dest, src) {\n        for (var prop in src) {\n            if (src.hasOwnProperty(prop) && dest[prop] === undefined) {\n                dest[prop] = src[prop];\n            }\n        }\n        return dest;\n    }\n    /**\n     * Truncates the `str` at `len - ellipsisChars.length`, and adds the `ellipsisChars` to the\n     * end of the string (by default, two periods: '..'). If the `str` length does not exceed\n     * `len`, the string will be returned unchanged.\n     *\n     * @param {String} str The string to truncate and add an ellipsis to.\n     * @param {Number} truncateLen The length to truncate the string at.\n     * @param {String} [ellipsisChars=...] The ellipsis character(s) to add to the end of `str`\n     *   when truncated. Defaults to '...'\n     */\n    function ellipsis(str, truncateLen, ellipsisChars) {\n        var ellipsisLength;\n        if (str.length > truncateLen) {\n            if (ellipsisChars == null) {\n                ellipsisChars = '&hellip;';\n                ellipsisLength = 3;\n            }\n            else {\n                ellipsisLength = ellipsisChars.length;\n            }\n            str = str.substring(0, truncateLen - ellipsisLength) + ellipsisChars;\n        }\n        return str;\n    }\n    /**\n     * Supports `Array.prototype.indexOf()` functionality for old IE (IE8 and below).\n     *\n     * @param {Array} arr The array to find an element of.\n     * @param {*} element The element to find in the array, and return the index of.\n     * @return {Number} The index of the `element`, or -1 if it was not found.\n     */\n    function indexOf(arr, element) {\n        if (Array.prototype.indexOf) {\n            return arr.indexOf(element);\n        }\n        else {\n            for (var i = 0, len = arr.length; i < len; i++) {\n                if (arr[i] === element)\n                    return i;\n            }\n            return -1;\n        }\n    }\n    /**\n     * Removes array elements based on a filtering function. Mutates the input\n     * array.\n     *\n     * Using this instead of the ES5 Array.prototype.filter() function, to allow\n     * Autolinker compatibility with IE8, and also to prevent creating many new\n     * arrays in memory for filtering.\n     *\n     * @param {Array} arr The array to remove elements from. This array is\n     *   mutated.\n     * @param {Function} fn A function which should return `true` to\n     *   remove an element.\n     * @return {Array} The mutated input `arr`.\n     */\n    function remove(arr, fn) {\n        for (var i = arr.length - 1; i >= 0; i--) {\n            if (fn(arr[i]) === true) {\n                arr.splice(i, 1);\n            }\n        }\n    }\n    /**\n     * Performs the functionality of what modern browsers do when `String.prototype.split()` is called\n     * with a regular expression that contains capturing parenthesis.\n     *\n     * For example:\n     *\n     *     // Modern browsers:\n     *     \"a,b,c\".split( /(,)/ );  // --> [ 'a', ',', 'b', ',', 'c' ]\n     *\n     *     // Old IE (including IE8):\n     *     \"a,b,c\".split( /(,)/ );  // --> [ 'a', 'b', 'c' ]\n     *\n     * This method emulates the functionality of modern browsers for the old IE case.\n     *\n     * @param {String} str The string to split.\n     * @param {RegExp} splitRegex The regular expression to split the input `str` on. The splitting\n     *   character(s) will be spliced into the array, as in the \"modern browsers\" example in the\n     *   description of this method.\n     *   Note #1: the supplied regular expression **must** have the 'g' flag specified.\n     *   Note #2: for simplicity's sake, the regular expression does not need\n     *   to contain capturing parenthesis - it will be assumed that any match has them.\n     * @return {String[]} The split array of strings, with the splitting character(s) included.\n     */\n    function splitAndCapture(str, splitRegex) {\n        if (!splitRegex.global)\n            throw new Error(\"`splitRegex` must have the 'g' flag set\");\n        var result = [], lastIdx = 0, match;\n        while (match = splitRegex.exec(str)) {\n            result.push(str.substring(lastIdx, match.index));\n            result.push(match[0]); // push the splitting char(s)\n            lastIdx = match.index + match[0].length;\n        }\n        result.push(str.substring(lastIdx));\n        return result;\n    }\n    /**\n     * Function that should never be called but is used to check that every\n     * enum value is handled using TypeScript's 'never' type.\n     */\n    function throwUnhandledCaseError(theValue) {\n        throw new Error(\"Unhandled case for value: '\" + theValue + \"'\");\n    }\n\n    /**\n     * @class Autolinker.HtmlTag\n     * @extends Object\n     *\n     * Represents an HTML tag, which can be used to easily build/modify HTML tags programmatically.\n     *\n     * Autolinker uses this abstraction to create HTML tags, and then write them out as strings. You may also use\n     * this class in your code, especially within a {@link Autolinker#replaceFn replaceFn}.\n     *\n     * ## Examples\n     *\n     * Example instantiation:\n     *\n     *     var tag = new Autolinker.HtmlTag( {\n     *         tagName : 'a',\n     *         attrs   : { 'href': 'http-colon-slashslash google.com', 'class': 'external-link' },\n     *         innerHtml : 'Google'\n     *     } );\n     *\n     *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"external-link\">Google</a>\n     *\n     *     // Individual accessor methods\n     *     tag.getTagName();                 // 'a'\n     *     tag.getAttr( 'href' );            // 'http-colon-slashslash google.com'\n     *     tag.hasClass( 'external-link' );  // true\n     *\n     *\n     * Using mutator methods (which may be used in combination with instantiation config properties):\n     *\n     *     var tag = new Autolinker.HtmlTag();\n     *     tag.setTagName( 'a' );\n     *     tag.setAttr( 'href', 'http-colon-slashslash google.com' );\n     *     tag.addClass( 'external-link' );\n     *     tag.setInnerHtml( 'Google' );\n     *\n     *     tag.getTagName();                 // 'a'\n     *     tag.getAttr( 'href' );            // 'http-colon-slashslash google.com'\n     *     tag.hasClass( 'external-link' );  // true\n     *\n     *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"external-link\">Google</a>\n     *\n     *\n     * ## Example use within a {@link Autolinker#replaceFn replaceFn}\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance, configured with the Match's href and anchor text\n     *             tag.setAttr( 'rel', 'nofollow' );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n     *\n     *\n     * ## Example use with a new tag for the replacement\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = new Autolinker.HtmlTag( {\n     *                 tagName : 'button',\n     *                 attrs   : { 'title': 'Load URL: ' + match.getAnchorHref() },\n     *                 innerHtml : 'Load URL: ' + match.getAnchorText()\n     *             } );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <button title=\"Load URL: http-colon-slashslash google.com\">Load URL: google.com</button>\n     */\n    var HtmlTag = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration properties for this class, in an Object (map)\n         */\n        function HtmlTag(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * @cfg {String} tagName\n             *\n             * The tag name. Ex: 'a', 'button', etc.\n             *\n             * Not required at instantiation time, but should be set using {@link #setTagName} before {@link #toAnchorString}\n             * is executed.\n             */\n            this.tagName = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object.<String, String>} attrs\n             *\n             * An key/value Object (map) of attributes to create the tag with. The keys are the attribute names, and the\n             * values are the attribute values.\n             */\n            this.attrs = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} innerHTML\n             *\n             * The inner HTML for the tag.\n             */\n            this.innerHTML = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property {RegExp} whitespaceRegex\n             *\n             * Regular expression used to match whitespace in a string of CSS classes.\n             */\n            this.whitespaceRegex = /\\s+/; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.tagName = cfg.tagName || '';\n            this.attrs = cfg.attrs || {};\n            this.innerHTML = cfg.innerHtml || cfg.innerHTML || ''; // accept either the camelCased form or the fully capitalized acronym as in the DOM\n        }\n        /**\n         * Sets the tag name that will be used to generate the tag with.\n         *\n         * @param {String} tagName\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setTagName = function (tagName) {\n            this.tagName = tagName;\n            return this;\n        };\n        /**\n         * Retrieves the tag name.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getTagName = function () {\n            return this.tagName || '';\n        };\n        /**\n         * Sets an attribute on the HtmlTag.\n         *\n         * @param {String} attrName The attribute name to set.\n         * @param {String} attrValue The attribute value to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setAttr = function (attrName, attrValue) {\n            var tagAttrs = this.getAttrs();\n            tagAttrs[attrName] = attrValue;\n            return this;\n        };\n        /**\n         * Retrieves an attribute from the HtmlTag. If the attribute does not exist, returns `undefined`.\n         *\n         * @param {String} attrName The attribute name to retrieve.\n         * @return {String} The attribute's value, or `undefined` if it does not exist on the HtmlTag.\n         */\n        HtmlTag.prototype.getAttr = function (attrName) {\n            return this.getAttrs()[attrName];\n        };\n        /**\n         * Sets one or more attributes on the HtmlTag.\n         *\n         * @param {Object.<String, String>} attrs A key/value Object (map) of the attributes to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setAttrs = function (attrs) {\n            Object.assign(this.getAttrs(), attrs);\n            return this;\n        };\n        /**\n         * Retrieves the attributes Object (map) for the HtmlTag.\n         *\n         * @return {Object.<String, String>} A key/value object of the attributes for the HtmlTag.\n         */\n        HtmlTag.prototype.getAttrs = function () {\n            return this.attrs || (this.attrs = {});\n        };\n        /**\n         * Sets the provided `cssClass`, overwriting any current CSS classes on the HtmlTag.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to set (overwrite).\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setClass = function (cssClass) {\n            return this.setAttr('class', cssClass);\n        };\n        /**\n         * Convenience method to add one or more CSS classes to the HtmlTag. Will not add duplicate CSS classes.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to add.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.addClass = function (cssClass) {\n            var classAttr = this.getClass(), whitespaceRegex = this.whitespaceRegex, classes = (!classAttr) ? [] : classAttr.split(whitespaceRegex), newClasses = cssClass.split(whitespaceRegex), newClass;\n            while (newClass = newClasses.shift()) {\n                if (indexOf(classes, newClass) === -1) {\n                    classes.push(newClass);\n                }\n            }\n            this.getAttrs()['class'] = classes.join(\" \");\n            return this;\n        };\n        /**\n         * Convenience method to remove one or more CSS classes from the HtmlTag.\n         *\n         * @param {String} cssClass One or more space-separated CSS classes to remove.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.removeClass = function (cssClass) {\n            var classAttr = this.getClass(), whitespaceRegex = this.whitespaceRegex, classes = (!classAttr) ? [] : classAttr.split(whitespaceRegex), removeClasses = cssClass.split(whitespaceRegex), removeClass;\n            while (classes.length && (removeClass = removeClasses.shift())) {\n                var idx = indexOf(classes, removeClass);\n                if (idx !== -1) {\n                    classes.splice(idx, 1);\n                }\n            }\n            this.getAttrs()['class'] = classes.join(\" \");\n            return this;\n        };\n        /**\n         * Convenience method to retrieve the CSS class(es) for the HtmlTag, which will each be separated by spaces when\n         * there are multiple.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getClass = function () {\n            return this.getAttrs()['class'] || \"\";\n        };\n        /**\n         * Convenience method to check if the tag has a CSS class or not.\n         *\n         * @param {String} cssClass The CSS class to check for.\n         * @return {Boolean} `true` if the HtmlTag has the CSS class, `false` otherwise.\n         */\n        HtmlTag.prototype.hasClass = function (cssClass) {\n            return (' ' + this.getClass() + ' ').indexOf(' ' + cssClass + ' ') !== -1;\n        };\n        /**\n         * Sets the inner HTML for the tag.\n         *\n         * @param {String} html The inner HTML to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setInnerHTML = function (html) {\n            this.innerHTML = html;\n            return this;\n        };\n        /**\n         * Backwards compatibility method name.\n         *\n         * @param {String} html The inner HTML to set.\n         * @return {Autolinker.HtmlTag} This HtmlTag instance, so that method calls may be chained.\n         */\n        HtmlTag.prototype.setInnerHtml = function (html) {\n            return this.setInnerHTML(html);\n        };\n        /**\n         * Retrieves the inner HTML for the tag.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getInnerHTML = function () {\n            return this.innerHTML || \"\";\n        };\n        /**\n         * Backward compatibility method name.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.getInnerHtml = function () {\n            return this.getInnerHTML();\n        };\n        /**\n         * Override of superclass method used to generate the HTML string for the tag.\n         *\n         * @return {String}\n         */\n        HtmlTag.prototype.toAnchorString = function () {\n            var tagName = this.getTagName(), attrsStr = this.buildAttrsStr();\n            attrsStr = (attrsStr) ? ' ' + attrsStr : ''; // prepend a space if there are actually attributes\n            return ['<', tagName, attrsStr, '>', this.getInnerHtml(), '</', tagName, '>'].join(\"\");\n        };\n        /**\n         * Support method for {@link #toAnchorString}, returns the string space-separated key=\"value\" pairs, used to populate\n         * the stringified HtmlTag.\n         *\n         * @protected\n         * @return {String} Example return: `attr1=\"value1\" attr2=\"value2\"`\n         */\n        HtmlTag.prototype.buildAttrsStr = function () {\n            if (!this.attrs)\n                return \"\"; // no `attrs` Object (map) has been set, return empty string\n            var attrs = this.getAttrs(), attrsArr = [];\n            for (var prop in attrs) {\n                if (attrs.hasOwnProperty(prop)) {\n                    attrsArr.push(prop + '=\"' + attrs[prop] + '\"');\n                }\n            }\n            return attrsArr.join(\" \");\n        };\n        return HtmlTag;\n    }());\n\n    /**\n     * Date: 2015-10-05\n     * Author: Kasper Sfren <soefritz@gmail.com> (https-colon-slashslash github.com/kafoso)\n     *\n     * A truncation feature, where the ellipsis will be placed at a section within\n     * the URL making it still somewhat human readable.\n     *\n     * @param {String} url\t\t\t\t\t\t A URL.\n     * @param {Number} truncateLen\t\t The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars\t The characters to place within the url, e.g. \"...\".\n     * @return {String} The truncated URL.\n     */\n    function truncateSmart(url, truncateLen, ellipsisChars) {\n        var ellipsisLengthBeforeParsing;\n        var ellipsisLength;\n        if (ellipsisChars == null) {\n            ellipsisChars = '&hellip;';\n            ellipsisLength = 3;\n            ellipsisLengthBeforeParsing = 8;\n        }\n        else {\n            ellipsisLength = ellipsisChars.length;\n            ellipsisLengthBeforeParsing = ellipsisChars.length;\n        }\n        var parse_url = function (url) {\n            var urlObj = {};\n            var urlSub = url;\n            var match = urlSub.match(/^([a-z]+):\\/\\//i);\n            if (match) {\n                urlObj.scheme = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^(.*?)(?=(\\?|#|\\/|$))/i);\n            if (match) {\n                urlObj.host = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^\\/(.*?)(?=(\\?|#|$))/i);\n            if (match) {\n                urlObj.path = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^\\?(.*?)(?=(#|$))/i);\n            if (match) {\n                urlObj.query = match[1];\n                urlSub = urlSub.substr(match[0].length);\n            }\n            match = urlSub.match(/^#(.*?)$/i);\n            if (match) {\n                urlObj.fragment = match[1];\n                //urlSub = urlSub.substr(match[0].length);  -- not used. Uncomment if adding another block.\n            }\n            return urlObj;\n        };\n        var buildUrl = function (urlObj) {\n            var url = \"\";\n            if (urlObj.scheme && urlObj.host) {\n                url += urlObj.scheme + \"://\";\n            }\n            if (urlObj.host) {\n                url += urlObj.host;\n            }\n            if (urlObj.path) {\n                url += \"/\" + urlObj.path;\n            }\n            if (urlObj.query) {\n                url += \"?\" + urlObj.query;\n            }\n            if (urlObj.fragment) {\n                url += \"#\" + urlObj.fragment;\n            }\n            return url;\n        };\n        var buildSegment = function (segment, remainingAvailableLength) {\n            var remainingAvailableLengthHalf = remainingAvailableLength / 2, startOffset = Math.ceil(remainingAvailableLengthHalf), endOffset = (-1) * Math.floor(remainingAvailableLengthHalf), end = \"\";\n            if (endOffset < 0) {\n                end = segment.substr(endOffset);\n            }\n            return segment.substr(0, startOffset) + ellipsisChars + end;\n        };\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        var availableLength = truncateLen - ellipsisLength;\n        var urlObj = parse_url(url);\n        // Clean up the URL\n        if (urlObj.query) {\n            var matchQuery = urlObj.query.match(/^(.*?)(?=(\\?|\\#))(.*?)$/i);\n            if (matchQuery) {\n                // Malformed URL; two or more \"?\". Removed any content behind the 2nd.\n                urlObj.query = urlObj.query.substr(0, matchQuery[1].length);\n                url = buildUrl(urlObj);\n            }\n        }\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        if (urlObj.host) {\n            urlObj.host = urlObj.host.replace(/^www\\./, \"\");\n            url = buildUrl(urlObj);\n        }\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        // Process and build the URL\n        var str = \"\";\n        if (urlObj.host) {\n            str += urlObj.host;\n        }\n        if (str.length >= availableLength) {\n            if (urlObj.host.length == truncateLen) {\n                return (urlObj.host.substr(0, (truncateLen - ellipsisLength)) + ellipsisChars).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            return buildSegment(str, availableLength).substr(0, availableLength + ellipsisLengthBeforeParsing);\n        }\n        var pathAndQuery = \"\";\n        if (urlObj.path) {\n            pathAndQuery += \"/\" + urlObj.path;\n        }\n        if (urlObj.query) {\n            pathAndQuery += \"?\" + urlObj.query;\n        }\n        if (pathAndQuery) {\n            if ((str + pathAndQuery).length >= availableLength) {\n                if ((str + pathAndQuery).length == truncateLen) {\n                    return (str + pathAndQuery).substr(0, truncateLen);\n                }\n                var remainingAvailableLength = availableLength - str.length;\n                return (str + buildSegment(pathAndQuery, remainingAvailableLength)).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            else {\n                str += pathAndQuery;\n            }\n        }\n        if (urlObj.fragment) {\n            var fragment = \"#\" + urlObj.fragment;\n            if ((str + fragment).length >= availableLength) {\n                if ((str + fragment).length == truncateLen) {\n                    return (str + fragment).substr(0, truncateLen);\n                }\n                var remainingAvailableLength2 = availableLength - str.length;\n                return (str + buildSegment(fragment, remainingAvailableLength2)).substr(0, availableLength + ellipsisLengthBeforeParsing);\n            }\n            else {\n                str += fragment;\n            }\n        }\n        if (urlObj.scheme && urlObj.host) {\n            var scheme = urlObj.scheme + \"://\";\n            if ((str + scheme).length < availableLength) {\n                return (scheme + str).substr(0, truncateLen);\n            }\n        }\n        if (str.length <= truncateLen) {\n            return str;\n        }\n        var end = \"\";\n        if (availableLength > 0) {\n            end = str.substr((-1) * Math.floor(availableLength / 2));\n        }\n        return (str.substr(0, Math.ceil(availableLength / 2)) + ellipsisChars + end).substr(0, availableLength + ellipsisLengthBeforeParsing);\n    }\n\n    /**\n     * Date: 2015-10-05\n     * Author: Kasper Sfren <soefritz@gmail.com> (https-colon-slashslash github.com/kafoso)\n     *\n     * A truncation feature, where the ellipsis will be placed in the dead-center of the URL.\n     *\n     * @param {String} url             A URL.\n     * @param {Number} truncateLen     The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars   The characters to place within the url, e.g. \"..\".\n     * @return {String} The truncated URL.\n     */\n    function truncateMiddle(url, truncateLen, ellipsisChars) {\n        if (url.length <= truncateLen) {\n            return url;\n        }\n        var ellipsisLengthBeforeParsing;\n        var ellipsisLength;\n        if (ellipsisChars == null) {\n            ellipsisChars = '&hellip;';\n            ellipsisLengthBeforeParsing = 8;\n            ellipsisLength = 3;\n        }\n        else {\n            ellipsisLengthBeforeParsing = ellipsisChars.length;\n            ellipsisLength = ellipsisChars.length;\n        }\n        var availableLength = truncateLen - ellipsisLength;\n        var end = \"\";\n        if (availableLength > 0) {\n            end = url.substr((-1) * Math.floor(availableLength / 2));\n        }\n        return (url.substr(0, Math.ceil(availableLength / 2)) + ellipsisChars + end).substr(0, availableLength + ellipsisLengthBeforeParsing);\n    }\n\n    /**\n     * A truncation feature where the ellipsis will be placed at the end of the URL.\n     *\n     * @param {String} anchorText\n     * @param {Number} truncateLen The maximum length of the truncated output URL string.\n     * @param {String} ellipsisChars The characters to place within the url, e.g. \"..\".\n     * @return {String} The truncated URL.\n     */\n    function truncateEnd(anchorText, truncateLen, ellipsisChars) {\n        return ellipsis(anchorText, truncateLen, ellipsisChars);\n    }\n\n    /**\n     * @protected\n     * @class Autolinker.AnchorTagBuilder\n     * @extends Object\n     *\n     * Builds anchor (&lt;a&gt;) tags for the Autolinker utility when a match is\n     * found.\n     *\n     * Normally this class is instantiated, configured, and used internally by an\n     * {@link Autolinker} instance, but may actually be used indirectly in a\n     * {@link Autolinker#replaceFn replaceFn} to create {@link Autolinker.HtmlTag HtmlTag}\n     * instances which may be modified before returning from the\n     * {@link Autolinker#replaceFn replaceFn}. For example:\n     *\n     *     var html = Autolinker.link( \"Test google.com\", {\n     *         replaceFn : function( match ) {\n     *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance\n     *             tag.setAttr( 'rel', 'nofollow' );\n     *\n     *             return tag;\n     *         }\n     *     } );\n     *\n     *     // generated html:\n     *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n     */\n    var AnchorTagBuilder = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration options for the AnchorTagBuilder instance, specified in an Object (map).\n         */\n        function AnchorTagBuilder(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * @cfg {Boolean} newWindow\n             * @inheritdoc Autolinker#newWindow\n             */\n            this.newWindow = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} truncate\n             * @inheritdoc Autolinker#truncate\n             */\n            this.truncate = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} className\n             * @inheritdoc Autolinker#className\n             */\n            this.className = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.newWindow = cfg.newWindow || false;\n            this.truncate = cfg.truncate || {};\n            this.className = cfg.className || '';\n        }\n        /**\n         * Generates the actual anchor (&lt;a&gt;) tag to use in place of the\n         * matched text, via its `match` object.\n         *\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {Autolinker.HtmlTag} The HtmlTag instance for the anchor tag.\n         */\n        AnchorTagBuilder.prototype.build = function (match) {\n            return new HtmlTag({\n                tagName: 'a',\n                attrs: this.createAttrs(match),\n                innerHtml: this.processAnchorText(match.getAnchorText())\n            });\n        };\n        /**\n         * Creates the Object (map) of the HTML attributes for the anchor (&lt;a&gt;)\n         *   tag being generated.\n         *\n         * @protected\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {Object} A key/value Object (map) of the anchor tag's attributes.\n         */\n        AnchorTagBuilder.prototype.createAttrs = function (match) {\n            var attrs = {\n                'href': match.getAnchorHref() // we'll always have the `href` attribute\n            };\n            var cssClass = this.createCssClass(match);\n            if (cssClass) {\n                attrs['class'] = cssClass;\n            }\n            if (this.newWindow) {\n                attrs['target'] = \"_blank\";\n                attrs['rel'] = \"noopener noreferrer\"; // Issue #149. See https://mathiasbynens.github.io/rel-noopener/\n            }\n            if (this.truncate) {\n                if (this.truncate.length && this.truncate.length < match.getAnchorText().length) {\n                    attrs['title'] = match.getAnchorHref();\n                }\n            }\n            return attrs;\n        };\n        /**\n         * Creates the CSS class that will be used for a given anchor tag, based on\n         * the `matchType` and the {@link #className} config.\n         *\n         * Example returns:\n         *\n         * - \"\"                                      // no {@link #className}\n         * - \"myLink myLink-url\"                     // url match\n         * - \"myLink myLink-email\"                   // email match\n         * - \"myLink myLink-phone\"                   // phone match\n         * - \"myLink myLink-hashtag\"                 // hashtag match\n         * - \"myLink myLink-mention myLink-twitter\"  // mention match with Twitter service\n         *\n         * @protected\n         * @param {Autolinker.match.Match} match The Match instance to generate an\n         *   anchor tag from.\n         * @return {String} The CSS class string for the link. Example return:\n         *   \"myLink myLink-url\". If no {@link #className} was configured, returns\n         *   an empty string.\n         */\n        AnchorTagBuilder.prototype.createCssClass = function (match) {\n            var className = this.className;\n            if (!className) {\n                return \"\";\n            }\n            else {\n                var returnClasses = [className], cssClassSuffixes = match.getCssClassSuffixes();\n                for (var i = 0, len = cssClassSuffixes.length; i < len; i++) {\n                    returnClasses.push(className + '-' + cssClassSuffixes[i]);\n                }\n                return returnClasses.join(' ');\n            }\n        };\n        /**\n         * Processes the `anchorText` by truncating the text according to the\n         * {@link #truncate} config.\n         *\n         * @private\n         * @param {String} anchorText The anchor tag's text (i.e. what will be\n         *   displayed).\n         * @return {String} The processed `anchorText`.\n         */\n        AnchorTagBuilder.prototype.processAnchorText = function (anchorText) {\n            anchorText = this.doTruncate(anchorText);\n            return anchorText;\n        };\n        /**\n         * Performs the truncation of the `anchorText` based on the {@link #truncate}\n         * option. If the `anchorText` is longer than the length specified by the\n         * {@link #truncate} option, the truncation is performed based on the\n         * `location` property. See {@link #truncate} for details.\n         *\n         * @private\n         * @param {String} anchorText The anchor tag's text (i.e. what will be\n         *   displayed).\n         * @return {String} The truncated anchor text.\n         */\n        AnchorTagBuilder.prototype.doTruncate = function (anchorText) {\n            var truncate = this.truncate;\n            if (!truncate || !truncate.length)\n                return anchorText;\n            var truncateLength = truncate.length, truncateLocation = truncate.location;\n            if (truncateLocation === 'smart') {\n                return truncateSmart(anchorText, truncateLength);\n            }\n            else if (truncateLocation === 'middle') {\n                return truncateMiddle(anchorText, truncateLength);\n            }\n            else {\n                return truncateEnd(anchorText, truncateLength);\n            }\n        };\n        return AnchorTagBuilder;\n    }());\n\n    /**\n     * @abstract\n     * @class Autolinker.match.Match\n     *\n     * Represents a match found in an input string which should be Autolinked. A Match object is what is provided in a\n     * {@link Autolinker#replaceFn replaceFn}, and may be used to query for details about the match.\n     *\n     * For example:\n     *\n     *     var input = \"...\";  // string with URLs, Email Addresses, and Mentions (Twitter, Instagram, Soundcloud)\n     *\n     *     var linkedText = Autolinker.link( input, {\n     *         replaceFn : function( match ) {\n     *             console.log( \"href = \", match.getAnchorHref() );\n     *             console.log( \"text = \", match.getAnchorText() );\n     *\n     *             switch( match.getType() ) {\n     *                 case 'url' :\n     *                     console.log( \"url: \", match.getUrl() );\n     *\n     *                 case 'email' :\n     *                     console.log( \"email: \", match.getEmail() );\n     *\n     *                 case 'mention' :\n     *                     console.log( \"mention: \", match.getMention() );\n     *             }\n     *         }\n     *     } );\n     *\n     * See the {@link Autolinker} class for more details on using the {@link Autolinker#replaceFn replaceFn}.\n     */\n    var Match = /** @class */ (function () {\n        /**\n         * @member Autolinker.match.Match\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function Match(cfg) {\n            /**\n             * @cfg {Autolinker.AnchorTagBuilder} tagBuilder (required)\n             *\n             * Reference to the AnchorTagBuilder instance to use to generate an anchor\n             * tag for the Match.\n             */\n            this.__jsduckDummyDocProp = null; // property used just to get the above doc comment into the ES5 output and documentation generator\n            /**\n             * @cfg {String} matchedText (required)\n             *\n             * The original text that was matched by the {@link Autolinker.matcher.Matcher}.\n             */\n            this.matchedText = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Number} offset (required)\n             *\n             * The offset of where the match was made in the input string.\n             */\n            this.offset = 0; // default value just to get the above doc comment in the ES5 output and documentation generator\n            this.tagBuilder = cfg.tagBuilder;\n            this.matchedText = cfg.matchedText;\n            this.offset = cfg.offset;\n        }\n        /**\n         * Returns the original text that was matched.\n         *\n         * @return {String}\n         */\n        Match.prototype.getMatchedText = function () {\n            return this.matchedText;\n        };\n        /**\n         * Sets the {@link #offset} of where the match was made in the input string.\n         *\n         * A {@link Autolinker.matcher.Matcher} will be fed only HTML text nodes,\n         * and will therefore set an original offset that is relative to the HTML\n         * text node itself. However, we want this offset to be relative to the full\n         * HTML input string, and thus if using {@link Autolinker#parse} (rather\n         * than calling a {@link Autolinker.matcher.Matcher} directly), then this\n         * offset is corrected after the Matcher itself has done its job.\n         *\n         * @param {Number} offset\n         */\n        Match.prototype.setOffset = function (offset) {\n            this.offset = offset;\n        };\n        /**\n         * Returns the offset of where the match was made in the input string. This\n         * is the 0-based index of the match.\n         *\n         * @return {Number}\n         */\n        Match.prototype.getOffset = function () {\n            return this.offset;\n        };\n        /**\n         * Returns the CSS class suffix(es) for this match.\n         *\n         * A CSS class suffix is appended to the {@link Autolinker#className} in\n         * the {@link Autolinker.AnchorTagBuilder} when a match is translated into\n         * an anchor tag.\n         *\n         * For example, if {@link Autolinker#className} was configured as 'myLink',\n         * and this method returns `[ 'url' ]`, the final class name of the element\n         * will become: 'myLink myLink-url'.\n         *\n         * The match may provide multiple CSS class suffixes to be appended to the\n         * {@link Autolinker#className} in order to facilitate better styling\n         * options for different match criteria. See {@link Autolinker.match.Mention}\n         * for an example.\n         *\n         * By default, this method returns a single array with the match's\n         * {@link #getType type} name, but may be overridden by subclasses.\n         *\n         * @return {String[]}\n         */\n        Match.prototype.getCssClassSuffixes = function () {\n            return [this.getType()];\n        };\n        /**\n         * Builds and returns an {@link Autolinker.HtmlTag} instance based on the\n         * Match.\n         *\n         * This can be used to easily generate anchor tags from matches, and either\n         * return their HTML string, or modify them before doing so.\n         *\n         * Example Usage:\n         *\n         *     var tag = match.buildTag();\n         *     tag.addClass( 'cordova-link' );\n         *     tag.setAttr( 'target', '_system' );\n         *\n         *     tag.toAnchorString();  // <a href=\"http-colon-slashslash google.com\" class=\"cordova-link\" target=\"_system\">Google</a>\n         *\n         * Example Usage in {@link Autolinker#replaceFn}:\n         *\n         *     var html = Autolinker.link( \"Test google.com\", {\n         *         replaceFn : function( match ) {\n         *             var tag = match.buildTag();  // returns an {@link Autolinker.HtmlTag} instance\n         *             tag.setAttr( 'rel', 'nofollow' );\n         *\n         *             return tag;\n         *         }\n         *     } );\n         *\n         *     // generated html:\n         *     //   Test <a href=\"http-colon-slashslash google.com\" target=\"_blank\" rel=\"nofollow\">google.com</a>\n         */\n        Match.prototype.buildTag = function () {\n            return this.tagBuilder.build(this);\n        };\n        return Match;\n    }());\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation. All rights reserved.\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\n    this file except in compliance with the License. You may obtain a copy of the\n    License at http-colon-slashslash www.apache.org/licenses/LICENSE-2.0\n\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\n    MERCHANTABLITY OR NON-INFRINGEMENT.\n\n    See the Apache Version 2.0 License for specific language governing permissions\n    and limitations under the License.\n    ***************************************************************************** */\n    /* global Reflect, Promise */\n\n    var extendStatics = function(d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n\n    function __extends(d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n\n    var __assign = function() {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n\n    /**\n     * @class Autolinker.match.Email\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Email match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var EmailMatch = /** @class */ (function (_super) {\n        __extends(EmailMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function EmailMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} email (required)\n             *\n             * The email address that was matched.\n             */\n            _this.email = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.email = cfg.email;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of EmailMatch, returns 'email'.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getType = function () {\n            return 'email';\n        };\n        /**\n         * Returns the email address that was matched.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getEmail = function () {\n            return this.email;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getAnchorHref = function () {\n            return 'mailto:' + this.email;\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        EmailMatch.prototype.getAnchorText = function () {\n            return this.email;\n        };\n        return EmailMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Hashtag\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Hashtag match found in an input string which should be\n     * Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more\n     * details.\n     */\n    var HashtagMatch = /** @class */ (function (_super) {\n        __extends(HashtagMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function HashtagMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point hashtag matches to. See {@link Autolinker#hashtag}\n             * for available values.\n             */\n            _this.serviceName = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} hashtag (required)\n             *\n             * The HashtagMatch that was matched, without the '#'.\n             */\n            _this.hashtag = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.serviceName = cfg.serviceName;\n            _this.hashtag = cfg.hashtag;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of HashtagMatch, returns 'hashtag'.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getType = function () {\n            return 'hashtag';\n        };\n        /**\n         * Returns the configured {@link #serviceName} to point the HashtagMatch to.\n         * Ex: 'facebook', 'twitter'.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getServiceName = function () {\n            return this.serviceName;\n        };\n        /**\n         * Returns the matched hashtag, without the '#' character.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getHashtag = function () {\n            return this.hashtag;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getAnchorHref = function () {\n            var serviceName = this.serviceName, hashtag = this.hashtag;\n            switch (serviceName) {\n                case 'twitter':\n                    return 'https://twitter.com/hashtag/' + hashtag;\n                case 'facebook':\n                    return 'https://www.facebook.com/hashtag/' + hashtag;\n                case 'instagram':\n                    return 'https://instagram.com/explore/tags/' + hashtag;\n                default: // Shouldn't happen because Autolinker's constructor should block any invalid values, but just in case.\n                    throw new Error('Unknown service name to point hashtag to: ' + serviceName);\n            }\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        HashtagMatch.prototype.getAnchorText = function () {\n            return '#' + this.hashtag;\n        };\n        return HashtagMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Mention\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Mention match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var MentionMatch = /** @class */ (function (_super) {\n        __extends(MentionMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function MentionMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point mention matches to. See {@link Autolinker#mention}\n             * for available values.\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} mention (required)\n             *\n             * The Mention that was matched, without the '@' character.\n             */\n            _this.mention = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.mention = cfg.mention;\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of MentionMatch, returns 'mention'.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getType = function () {\n            return 'mention';\n        };\n        /**\n         * Returns the mention, without the '@' character.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getMention = function () {\n            return this.mention;\n        };\n        /**\n         * Returns the configured {@link #serviceName} to point the mention to.\n         * Ex: 'instagram', 'twitter', 'soundcloud'.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getServiceName = function () {\n            return this.serviceName;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getAnchorHref = function () {\n            switch (this.serviceName) {\n                case 'twitter':\n                    return 'https://twitter.com/' + this.mention;\n                case 'instagram':\n                    return 'https://instagram.com/' + this.mention;\n                case 'soundcloud':\n                    return 'https://soundcloud.com/' + this.mention;\n                default: // Shouldn't happen because Autolinker's constructor should block any invalid values, but just in case.\n                    throw new Error('Unknown service name to point mention to: ' + this.serviceName);\n            }\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        MentionMatch.prototype.getAnchorText = function () {\n            return '@' + this.mention;\n        };\n        /**\n         * Returns the CSS class suffixes that should be used on a tag built with\n         * the match. See {@link Autolinker.match.Match#getCssClassSuffixes} for\n         * details.\n         *\n         * @return {String[]}\n         */\n        MentionMatch.prototype.getCssClassSuffixes = function () {\n            var cssClassSuffixes = _super.prototype.getCssClassSuffixes.call(this), serviceName = this.getServiceName();\n            if (serviceName) {\n                cssClassSuffixes.push(serviceName);\n            }\n            return cssClassSuffixes;\n        };\n        return MentionMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Phone\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Phone number match found in an input string which should be\n     * Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more\n     * details.\n     */\n    var PhoneMatch = /** @class */ (function (_super) {\n        __extends(PhoneMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function PhoneMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @protected\n             * @property {String} number (required)\n             *\n             * The phone number that was matched, without any delimiter characters.\n             *\n             * Note: This is a string to allow for prefixed 0's.\n             */\n            _this.number = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property  {Boolean} plusSign (required)\n             *\n             * `true` if the matched phone number started with a '+' sign. We'll include\n             * it in the `tel:` URL if so, as this is needed for international numbers.\n             *\n             * Ex: '+1 (123) 456 7879'\n             */\n            _this.plusSign = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            _this.number = cfg.number;\n            _this.plusSign = cfg.plusSign;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of PhoneMatch, returns 'phone'.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getType = function () {\n            return 'phone';\n        };\n        /**\n         * Returns the phone number that was matched as a string, without any\n         * delimiter characters.\n         *\n         * Note: This is a string to allow for prefixed 0's.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getPhoneNumber = function () {\n            return this.number;\n        };\n        /**\n         * Alias of {@link #getPhoneNumber}, returns the phone number that was\n         * matched as a string, without any delimiter characters.\n         *\n         * Note: This is a string to allow for prefixed 0's.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getNumber = function () {\n            return this.getPhoneNumber();\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getAnchorHref = function () {\n            return 'tel:' + (this.plusSign ? '+' : '') + this.number;\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        PhoneMatch.prototype.getAnchorText = function () {\n            return this.matchedText;\n        };\n        return PhoneMatch;\n    }(Match));\n\n    /**\n     * @class Autolinker.match.Url\n     * @extends Autolinker.match.Match\n     *\n     * Represents a Url match found in an input string which should be Autolinked.\n     *\n     * See this class's superclass ({@link Autolinker.match.Match}) for more details.\n     */\n    var UrlMatch = /** @class */ (function (_super) {\n        __extends(UrlMatch, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match\n         *   instance, specified in an Object (map).\n         */\n        function UrlMatch(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} url (required)\n             *\n             * The url that was matched.\n             */\n            _this.url = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {\"scheme\"/\"www\"/\"tld\"} urlMatchType (required)\n             *\n             * The type of URL match that this class represents. This helps to determine\n             * if the match was made in the original text with a prefixed scheme (ex:\n             * 'http-colon-slashslash www.google.com'), a prefixed 'www' (ex: 'www.google.com'), or\n             * was matched by a known top-level domain (ex: 'google.com').\n             */\n            _this.urlMatchType = 'scheme'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} protocolUrlMatch (required)\n             *\n             * `true` if the URL is a match which already has a protocol (i.e.\n             * 'http-colon-slashslash '), `false` if the match was from a 'www' or known TLD match.\n             */\n            _this.protocolUrlMatch = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} protocolRelativeMatch (required)\n             *\n             * `true` if the URL is a protocol-relative match. A protocol-relative match\n             * is a URL that starts with '//', and will be either http-colon-slashslash  or https-colon-slashslash \n             * based on the protocol that the site is loaded under.\n             */\n            _this.protocolRelativeMatch = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} stripPrefix (required)\n             *\n             * The Object form of {@link Autolinker#cfg-stripPrefix}.\n             */\n            _this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} stripTrailingSlash (required)\n             * @inheritdoc Autolinker#cfg-stripTrailingSlash\n             */\n            _this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} decodePercentEncoding (required)\n             * @inheritdoc Autolinker#cfg-decodePercentEncoding\n             */\n            _this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @private\n             * @property {RegExp} schemePrefixRegex\n             *\n             * A regular expression used to remove the 'http-colon-slashslash ' or 'https-colon-slashslash ' from\n             * URLs.\n             */\n            _this.schemePrefixRegex = /^(https?:\\/\\/)?/i;\n            /**\n             * @private\n             * @property {RegExp} wwwPrefixRegex\n             *\n             * A regular expression used to remove the 'www.' from URLs.\n             */\n            _this.wwwPrefixRegex = /^(https?:\\/\\/)?(www\\.)?/i;\n            /**\n             * @private\n             * @property {RegExp} protocolRelativeRegex\n             *\n             * The regular expression used to remove the protocol-relative '//' from the {@link #url} string, for purposes\n             * of {@link #getAnchorText}. A protocol-relative URL is, for example, \"//yahoo.com\"\n             */\n            _this.protocolRelativeRegex = /^\\/\\//;\n            /**\n             * @private\n             * @property {Boolean} protocolPrepended\n             *\n             * Will be set to `true` if the 'http-colon-slashslash ' protocol has been prepended to the {@link #url} (because the\n             * {@link #url} did not have a protocol)\n             */\n            _this.protocolPrepended = false;\n            _this.urlMatchType = cfg.urlMatchType;\n            _this.url = cfg.url;\n            _this.protocolUrlMatch = cfg.protocolUrlMatch;\n            _this.protocolRelativeMatch = cfg.protocolRelativeMatch;\n            _this.stripPrefix = cfg.stripPrefix;\n            _this.stripTrailingSlash = cfg.stripTrailingSlash;\n            _this.decodePercentEncoding = cfg.decodePercentEncoding;\n            return _this;\n        }\n        /**\n         * Returns a string name for the type of match that this class represents.\n         * For the case of UrlMatch, returns 'url'.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getType = function () {\n            return 'url';\n        };\n        /**\n         * Returns a string name for the type of URL match that this class\n         * represents.\n         *\n         * This helps to determine if the match was made in the original text with a\n         * prefixed scheme (ex: 'http-colon-slashslash www.google.com'), a prefixed 'www' (ex:\n         * 'www.google.com'), or was matched by a known top-level domain (ex:\n         * 'google.com').\n         *\n         * @return {\"scheme\"/\"www\"/\"tld\"}\n         */\n        UrlMatch.prototype.getUrlMatchType = function () {\n            return this.urlMatchType;\n        };\n        /**\n         * Returns the url that was matched, assuming the protocol to be 'http-colon-slashslash ' if the original\n         * match was missing a protocol.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getUrl = function () {\n            var url = this.url;\n            // if the url string doesn't begin with a protocol, assume 'http://'\n            if (!this.protocolRelativeMatch && !this.protocolUrlMatch && !this.protocolPrepended) {\n                url = this.url = 'http://' + url;\n                this.protocolPrepended = true;\n            }\n            return url;\n        };\n        /**\n         * Returns the anchor href that should be generated for the match.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getAnchorHref = function () {\n            var url = this.getUrl();\n            return url.replace(/&amp;/g, '&'); // any &amp;'s in the URL should be converted back to '&' if they were displayed as &amp; in the source html\n        };\n        /**\n         * Returns the anchor text that should be generated for the match.\n         *\n         * @return {String}\n         */\n        UrlMatch.prototype.getAnchorText = function () {\n            var anchorText = this.getMatchedText();\n            if (this.protocolRelativeMatch) {\n                // Strip off any protocol-relative '//' from the anchor text\n                anchorText = this.stripProtocolRelativePrefix(anchorText);\n            }\n            if (this.stripPrefix.scheme) {\n                anchorText = this.stripSchemePrefix(anchorText);\n            }\n            if (this.stripPrefix.www) {\n                anchorText = this.stripWwwPrefix(anchorText);\n            }\n            if (this.stripTrailingSlash) {\n                anchorText = this.removeTrailingSlash(anchorText); // remove trailing slash, if there is one\n            }\n            if (this.decodePercentEncoding) {\n                anchorText = this.removePercentEncoding(anchorText);\n            }\n            return anchorText;\n        };\n        // ---------------------------------------\n        // Utility Functionality\n        /**\n         * Strips the scheme prefix (such as \"http-colon-slashslash \" or \"https-colon-slashslash \") from the given\n         * `url`.\n         *\n         * @private\n         * @param {String} url The text of the anchor that is being generated, for\n         *   which to strip off the url scheme.\n         * @return {String} The `url`, with the scheme stripped.\n         */\n        UrlMatch.prototype.stripSchemePrefix = function (url) {\n            return url.replace(this.schemePrefixRegex, '');\n        };\n        /**\n         * Strips the 'www' prefix from the given `url`.\n         *\n         * @private\n         * @param {String} url The text of the anchor that is being generated, for\n         *   which to strip off the 'www' if it exists.\n         * @return {String} The `url`, with the 'www' stripped.\n         */\n        UrlMatch.prototype.stripWwwPrefix = function (url) {\n            return url.replace(this.wwwPrefixRegex, '$1'); // leave any scheme ($1), it one exists\n        };\n        /**\n         * Strips any protocol-relative '//' from the anchor text.\n         *\n         * @private\n         * @param {String} text The text of the anchor that is being generated, for which to strip off the\n         *   protocol-relative prefix (such as stripping off \"//\")\n         * @return {String} The `anchorText`, with the protocol-relative prefix stripped.\n         */\n        UrlMatch.prototype.stripProtocolRelativePrefix = function (text) {\n            return text.replace(this.protocolRelativeRegex, '');\n        };\n        /**\n         * Removes any trailing slash from the given `anchorText`, in preparation for the text to be displayed.\n         *\n         * @private\n         * @param {String} anchorText The text of the anchor that is being generated, for which to remove any trailing\n         *   slash ('/') that may exist.\n         * @return {String} The `anchorText`, with the trailing slash removed.\n         */\n        UrlMatch.prototype.removeTrailingSlash = function (anchorText) {\n            if (anchorText.charAt(anchorText.length - 1) === '/') {\n                anchorText = anchorText.slice(0, -1);\n            }\n            return anchorText;\n        };\n        /**\n         * Decodes percent-encoded characters from the given `anchorText`, in\n         * preparation for the text to be displayed.\n         *\n         * @private\n         * @param {String} anchorText The text of the anchor that is being\n         *   generated, for which to decode any percent-encoded characters.\n         * @return {String} The `anchorText`, with the percent-encoded characters\n         *   decoded.\n         */\n        UrlMatch.prototype.removePercentEncoding = function (anchorText) {\n            // First, convert a few of the known % encodings to the corresponding\n            // HTML entities that could accidentally be interpretted as special\n            // HTML characters\n            var preProcessedEntityAnchorText = anchorText\n                .replace(/%22/gi, '&quot;') // \" char\n                .replace(/%26/gi, '&amp;') // & char\n                .replace(/%27/gi, '&#39;') // ' char\n                .replace(/%3C/gi, '&lt;') // < char\n                .replace(/%3E/gi, '&gt;'); // > char\n            try {\n                // Now attempt to decode the rest of the anchor text\n                return decodeURIComponent(preProcessedEntityAnchorText);\n            }\n            catch (e) { // Invalid % escape sequence in the anchor text\n                return preProcessedEntityAnchorText;\n            }\n        };\n        return UrlMatch;\n    }(Match));\n\n    /**\n     * @abstract\n     * @class Autolinker.matcher.Matcher\n     *\n     * An abstract class and interface for individual matchers to find matches in\n     * an input string with linkified versions of them.\n     *\n     * Note that Matchers do not take HTML into account - they must be fed the text\n     * nodes of any HTML string, which is handled by {@link Autolinker#parse}.\n     */\n    var Matcher = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Matcher\n         *   instance, specified in an Object (map).\n         */\n        function Matcher(cfg) {\n            /**\n             * @cfg {Autolinker.AnchorTagBuilder} tagBuilder (required)\n             *\n             * Reference to the AnchorTagBuilder instance to use to generate HTML tags\n             * for {@link Autolinker.match.Match Matches}.\n             */\n            this.__jsduckDummyDocProp = null; // property used just to get the above doc comment into the ES5 output and documentation generator\n            this.tagBuilder = cfg.tagBuilder;\n        }\n        return Matcher;\n    }());\n\n    /*\n     * This file builds and stores a library of the common regular expressions used\n     * by the Autolinker utility.\n     *\n     * Other regular expressions may exist ad-hoc, but these are generally the\n     * regular expressions that are shared between source files.\n     */\n    /**\n     * Regular expression to match upper and lowercase ASCII letters\n     */\n    var letterRe = /[A-Za-z]/;\n    /**\n     * Regular expression to match ASCII digits\n     */\n    var digitRe = /[0-9]/;\n    /**\n     * Regular expression to match whitespace\n     */\n    var whitespaceRe = /\\s/;\n    /**\n     * Regular expression to match quote characters\n     */\n    var quoteRe = /['\"]/;\n    /**\n     * Regular expression to match the range of ASCII control characters (0-31), and\n     * the backspace char (127)\n     */\n    var controlCharsRe = /[\\x00-\\x1F\\x7F]/;\n    /**\n     * The string form of a regular expression that would match all of the\n     * alphabetic (\"letter\") chars in the unicode character set when placed in a\n     * RegExp character class (`[]`). This includes all international alphabetic\n     * characters.\n     *\n     * These would be the characters matched by unicode regex engines `\\p{L}`\n     * escape (\"all letters\").\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Letter'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var alphaCharsStr = /A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B4\\u08B6-\\u08BD\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16F1-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FD5\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all emoji characters\n     * Source: https-colon-slashslash www.regextester.com/106421\n     */\n    var emojiStr = /\\u00a9\\u00ae\\u2000-\\u3300\\ud83c\\ud000-\\udfff\\ud83d\\ud000-\\udfff\\ud83e\\ud000-\\udfff/\n        .source;\n    /**\n     * The string form of a regular expression that would match all of the\n     * combining mark characters in the unicode character set when placed in a\n     * RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines `\\p{M}`\n     * escape (\"all marks\").\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Mark'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var marksStr = /\\u0300-\\u036F\\u0483-\\u0489\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08D4-\\u08E1\\u08E3-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2\\u0AE3\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C00-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C81-\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D01-\\u0D03\\u0D3E-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102B-\\u103E\\u1056-\\u1059\\u105E-\\u1060\\u1062-\\u1064\\u1067-\\u106D\\u1071-\\u1074\\u1082-\\u108D\\u108F\\u109A-\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4-\\u17D3\\u17DD\\u180B-\\u180D\\u1885\\u1886\\u18A9\\u1920-\\u192B\\u1930-\\u193B\\u1A17-\\u1A1B\\u1A55-\\u1A5E\\u1A60-\\u1A7C\\u1A7F\\u1AB0-\\u1ABE\\u1B00-\\u1B04\\u1B34-\\u1B44\\u1B6B-\\u1B73\\u1B80-\\u1B82\\u1BA1-\\u1BAD\\u1BE6-\\u1BF3\\u1C24-\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE8\\u1CED\\u1CF2-\\u1CF4\\u1CF8\\u1CF9\\u1DC0-\\u1DF5\\u1DFB-\\u1DFF\\u20D0-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F-\\uA672\\uA674-\\uA67D\\uA69E\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA823-\\uA827\\uA880\\uA881\\uA8B4-\\uA8C5\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA953\\uA980-\\uA983\\uA9B3-\\uA9C0\\uA9E5\\uAA29-\\uAA36\\uAA43\\uAA4C\\uAA4D\\uAA7B-\\uAA7D\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEB-\\uAAEF\\uAAF5\\uAAF6\\uABE3-\\uABEA\\uABEC\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE2F/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all of the\n     * alphabetic (\"letter\") chars, emoji, and combining marks in the unicode character set\n     * when placed in a RegExp character class (`[]`). This includes all\n     * international alphabetic characters.\n     *\n     * These would be the characters matched by unicode regex engines `\\p{L}\\p{M}`\n     * escapes and emoji characters.\n     */\n    var alphaCharsAndMarksStr = alphaCharsStr + emojiStr + marksStr;\n    /**\n     * The string form of a regular expression that would match all of the\n     * decimal number chars in the unicode character set when placed in a RegExp\n     * character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines `\\p{Nd}`\n     * escape (\"all decimal numbers\")\n     *\n     * Taken from the XRegExp library: http-colon-slashslash xregexp.com/ (thanks @https-colon-slashslash github.com/slevithan)\n     * Specifically: http-colon-slashslash xregexp.com/v/3.2.0/xregexp-all.js, the 'Decimal_Number'\n     *   regex's bmp\n     *\n     * VERY IMPORTANT: This set of characters is defined inside of a Regular\n     *   Expression literal rather than a string literal to prevent UglifyJS from\n     *   compressing the unicode escape sequences into their actual unicode\n     *   characters. If Uglify compresses these into the unicode characters\n     *   themselves, this results in the error \"Range out of order in character\n     *   class\" when these characters are used inside of a Regular Expression\n     *   character class (`[]`). See usages of this const. Alternatively, we can set\n     *   the UglifyJS option `ascii_only` to true for the build, but that doesn't\n     *   help others who are pulling in Autolinker into their own build and running\n     *   UglifyJS themselves.\n     */\n    var decimalNumbersStr = /0-9\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0BE6-\\u0BEF\\u0C66-\\u0C6F\\u0CE6-\\u0CEF\\u0D66-\\u0D6F\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F29\\u1040-\\u1049\\u1090-\\u1099\\u17E0-\\u17E9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19D9\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\uA620-\\uA629\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19/\n        .source; // see note in above variable description\n    /**\n     * The string form of a regular expression that would match all of the\n     * letters and decimal number chars in the unicode character set when placed in\n     * a RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines\n     * `[\\p{L}\\p{Nd}]` escape (\"all letters and decimal numbers\")\n     */\n    var alphaNumericCharsStr = alphaCharsAndMarksStr + decimalNumbersStr;\n    /**\n     * The string form of a regular expression that would match all of the\n     * letters, combining marks, and decimal number chars in the unicode character\n     * set when placed in a RegExp character class (`[]`).\n     *\n     * These would be the characters matched by unicode regex engines\n     * `[\\p{L}\\p{M}\\p{Nd}]` escape (\"all letters, combining marks, and decimal\n     * numbers\")\n     */\n    var alphaNumericAndMarksCharsStr = alphaCharsAndMarksStr + decimalNumbersStr;\n    // Simplified IP regular expression\n    var ipStr = '(?:[' + decimalNumbersStr + ']{1,3}\\\\.){3}[' + decimalNumbersStr + ']{1,3}';\n    // Protected domain label which do not allow \"-\" character on the beginning and the end of a single label\n    var domainLabelStr = '[' + alphaNumericAndMarksCharsStr + '](?:[' + alphaNumericAndMarksCharsStr + '\\\\-]{0,61}[' + alphaNumericAndMarksCharsStr + '])?';\n    var getDomainLabelStr = function (group) {\n        return '(?=(' + domainLabelStr + '))\\\\' + group;\n    };\n    /**\n     * A function to match domain names of a URL or email address.\n     * Ex: 'google', 'yahoo', 'some-other-company', etc.\n     */\n    var getDomainNameStr = function (group) {\n        return '(?:' + getDomainLabelStr(group) + '(?:\\\\.' + getDomainLabelStr(group + 1) + '){0,126}|' + ipStr + ')';\n    };\n    /**\n     * A regular expression that is simply the character class of the characters\n     * that may be used in a domain name, minus the '-' or '.'\n     */\n    var domainNameCharRegex = new RegExp(\"[\" + alphaNumericAndMarksCharsStr + \"]\");\n\n    // NOTE: THIS IS A GENERATED FILE\n    // To update with the latest TLD list, run `npm run update-tld-regex` or `yarn update-tld-regex` (depending on which you have installed)\n    var tldRegex = /(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermgensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermgensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b||accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|etisalat|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama||abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|staples|starhub|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|||||||||abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|yachts|yandex|zappos|||||||||||||actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|||||||||||||aarp|able|adac|aero|aigo|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone||||||||||||||||||||||||||aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jcp|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip||||||||||||||||||||||||||||||ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)/;\n\n    // For debugging: search for other \"For debugging\" lines\n    // import CliTable from 'cli-table';\n    /**\n     * @class Autolinker.matcher.Email\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find email matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more details.\n     */\n    var EmailMatcher = /** @class */ (function (_super) {\n        __extends(EmailMatcher, _super);\n        function EmailMatcher() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            /**\n             * Valid characters that can be used in the \"local\" part of an email address,\n             * i.e. the \"name\" part of \"name@site.com\"\n             */\n            _this.localPartCharRegex = new RegExp(\"[\" + alphaNumericAndMarksCharsStr + \"!#$%&'*+/=?^_`{|}~-]\");\n            /**\n             * Stricter TLD regex which adds a beginning and end check to ensure\n             * the string is a valid TLD\n             */\n            _this.strictTldRegex = new RegExp(\"^\" + tldRegex.source + \"$\");\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        EmailMatcher.prototype.parseMatches = function (text) {\n            var tagBuilder = this.tagBuilder, localPartCharRegex = this.localPartCharRegex, strictTldRegex = this.strictTldRegex, matches = [], len = text.length, noCurrentEmailMatch = new CurrentEmailMatch();\n            // for matching a 'mailto:' prefix\n            var mailtoTransitions = {\n                'm': 'a',\n                'a': 'i',\n                'i': 'l',\n                'l': 't',\n                't': 'o',\n                'o': ':',\n            };\n            var charIdx = 0, state = 0 /* NonEmailMatch */, currentEmailMatch = noCurrentEmailMatch;\n            // For debugging: search for other \"For debugging\" lines\n            // const table = new CliTable( {\n            // \thead: [ 'charIdx', 'char', 'state', 'charIdx', 'currentEmailAddress.idx', 'hasDomainDot' ]\n            // } );\n            while (charIdx < len) {\n                var char = text.charAt(charIdx);\n                // For debugging: search for other \"For debugging\" lines\n                // table.push(\n                // \t[ charIdx, char, State[ state ], charIdx, currentEmailAddress.idx, currentEmailAddress.hasDomainDot ]\n                // );\n                switch (state) {\n                    case 0 /* NonEmailMatch */:\n                        stateNonEmailAddress(char);\n                        break;\n                    case 1 /* Mailto */:\n                        stateMailTo(text.charAt(charIdx - 1), char);\n                        break;\n                    case 2 /* LocalPart */:\n                        stateLocalPart(char);\n                        break;\n                    case 3 /* LocalPartDot */:\n                        stateLocalPartDot(char);\n                        break;\n                    case 4 /* AtSign */:\n                        stateAtSign(char);\n                        break;\n                    case 5 /* DomainChar */:\n                        stateDomainChar(char);\n                        break;\n                    case 6 /* DomainHyphen */:\n                        stateDomainHyphen(char);\n                        break;\n                    case 7 /* DomainDot */:\n                        stateDomainDot(char);\n                        break;\n                    default:\n                        throwUnhandledCaseError(state);\n                }\n                // For debugging: search for other \"For debugging\" lines\n                // table.push(\n                // \t[ charIdx, char, State[ state ], charIdx, currentEmailAddress.idx, currentEmailAddress.hasDomainDot ]\n                // );\n                charIdx++;\n            }\n            // Capture any valid match at the end of the string\n            captureMatchIfValidAndReset();\n            // For debugging: search for other \"For debugging\" lines\n            //console.log( '\\n' + table.toString() );\n            return matches;\n            // Handles the state when we're not in an email address\n            function stateNonEmailAddress(char) {\n                if (char === 'm') {\n                    beginEmailMatch(1 /* Mailto */);\n                }\n                else if (localPartCharRegex.test(char)) {\n                    beginEmailMatch();\n                }\n            }\n            // Handles if we're reading a 'mailto:' prefix on the string\n            function stateMailTo(prevChar, char) {\n                if (prevChar === ':') {\n                    // We've reached the end of the 'mailto:' prefix\n                    if (localPartCharRegex.test(char)) {\n                        state = 2 /* LocalPart */;\n                        currentEmailMatch = new CurrentEmailMatch(__assign({}, currentEmailMatch, { hasMailtoPrefix: true }));\n                    }\n                    else {\n                        // we've matched 'mailto:' but didn't get anything meaningful\n                        // immediately afterwards (for example, we encountered a\n                        // space character, or an '@' character which formed 'mailto:@'\n                        resetToNonEmailMatchState();\n                    }\n                }\n                else if (mailtoTransitions[prevChar] === char) ;\n                else if (localPartCharRegex.test(char)) {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // different character that didn't continue the prefix\n                    state = 2 /* LocalPart */;\n                }\n                else if (char === '.') {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // dot character\n                    state = 3 /* LocalPartDot */;\n                }\n                else if (char === '@') {\n                    // We we're reading a prefix of 'mailto:', but encountered a\n                    // an @ character\n                    state = 4 /* AtSign */;\n                }\n                else {\n                    // not an email address character, return to \"NonEmailAddress\" state\n                    resetToNonEmailMatchState();\n                }\n            }\n            // Handles the state when we're currently in the \"local part\" of an\n            // email address (as opposed to the \"domain part\")\n            function stateLocalPart(char) {\n                if (char === '.') {\n                    state = 3 /* LocalPartDot */;\n                }\n                else if (char === '@') {\n                    state = 4 /* AtSign */;\n                }\n                else if (localPartCharRegex.test(char)) ;\n                else {\n                    // not an email address character, return to \"NonEmailAddress\" state\n                    resetToNonEmailMatchState();\n                }\n            }\n            // Handles the state where we've read\n            function stateLocalPartDot(char) {\n                if (char === '.') {\n                    // We read a second '.' in a row, not a valid email address\n                    // local part\n                    resetToNonEmailMatchState();\n                }\n                else if (char === '@') {\n                    // We read the '@' character immediately after a dot ('.'), not\n                    // an email address\n                    resetToNonEmailMatchState();\n                }\n                else if (localPartCharRegex.test(char)) {\n                    state = 2 /* LocalPart */;\n                }\n                else {\n                    // Anything else, not an email address\n                    resetToNonEmailMatchState();\n                }\n            }\n            function stateAtSign(char) {\n                if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                }\n                else {\n                    // Anything else, not an email address\n                    resetToNonEmailMatchState();\n                }\n            }\n            function stateDomainChar(char) {\n                if (char === '.') {\n                    state = 7 /* DomainDot */;\n                }\n                else if (char === '-') {\n                    state = 6 /* DomainHyphen */;\n                }\n                else if (domainNameCharRegex.test(char)) ;\n                else {\n                    // Anything else, we potentially matched if the criteria has\n                    // been met\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function stateDomainHyphen(char) {\n                if (char === '-' || char === '.') {\n                    // Not valid to have two hyphens (\"--\") or hypen+dot (\"-.\")\n                    captureMatchIfValidAndReset();\n                }\n                else if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                }\n                else {\n                    // Anything else\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function stateDomainDot(char) {\n                if (char === '.' || char === '-') {\n                    // not valid to have two dots (\"..\") or dot+hypen (\".-\")\n                    captureMatchIfValidAndReset();\n                }\n                else if (domainNameCharRegex.test(char)) {\n                    state = 5 /* DomainChar */;\n                    // After having read a '.' and then a valid domain character,\n                    // we now know that the domain part of the email is valid, and\n                    // we have found at least a partial EmailMatch (however, the\n                    // email address may have additional characters from this point)\n                    currentEmailMatch = new CurrentEmailMatch(__assign({}, currentEmailMatch, { hasDomainDot: true }));\n                }\n                else {\n                    // Anything else\n                    captureMatchIfValidAndReset();\n                }\n            }\n            function beginEmailMatch(newState) {\n                if (newState === void 0) { newState = 2 /* LocalPart */; }\n                state = newState;\n                currentEmailMatch = new CurrentEmailMatch({ idx: charIdx });\n            }\n            function resetToNonEmailMatchState() {\n                state = 0 /* NonEmailMatch */;\n                currentEmailMatch = noCurrentEmailMatch;\n            }\n            /*\n             * Captures the current email address as an EmailMatch if it's valid,\n             * and resets the state to read another email address.\n             */\n            function captureMatchIfValidAndReset() {\n                if (currentEmailMatch.hasDomainDot) { // we need at least one dot in the domain to be considered a valid email address\n                    var matchedText = text.slice(currentEmailMatch.idx, charIdx);\n                    // If we read a '.' or '-' char that ended the email address\n                    // (valid domain name characters, but only valid email address\n                    // characters if they are followed by something else), strip\n                    // it off now\n                    if (/[-.]$/.test(matchedText)) {\n                        matchedText = matchedText.slice(0, -1);\n                    }\n                    var emailAddress = currentEmailMatch.hasMailtoPrefix\n                        ? matchedText.slice('mailto:'.length)\n                        : matchedText;\n                    // if the email address has a valid TLD, add it to the list of matches\n                    if (doesEmailHaveValidTld(emailAddress)) {\n                        matches.push(new EmailMatch({\n                            tagBuilder: tagBuilder,\n                            matchedText: matchedText,\n                            offset: currentEmailMatch.idx,\n                            email: emailAddress\n                        }));\n                    }\n                }\n                resetToNonEmailMatchState();\n                /**\n                 * Determines if the given email address has a valid TLD or not\n                 * @param {string} emailAddress - email address\n                 * @return {Boolean} - true is email have valid TLD, false otherwise\n                 */\n                function doesEmailHaveValidTld(emailAddress) {\n                    var emailAddressTld = emailAddress.split('.').pop() || '';\n                    var emailAddressNormalized = emailAddressTld.toLowerCase();\n                    var isValidTld = strictTldRegex.test(emailAddressNormalized);\n                    return isValidTld;\n                }\n            }\n        };\n        return EmailMatcher;\n    }(Matcher));\n    var CurrentEmailMatch = /** @class */ (function () {\n        function CurrentEmailMatch(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            this.idx = cfg.idx !== undefined ? cfg.idx : -1;\n            this.hasMailtoPrefix = !!cfg.hasMailtoPrefix;\n            this.hasDomainDot = !!cfg.hasDomainDot;\n        }\n        return CurrentEmailMatch;\n    }());\n\n    /**\n     * @private\n     * @class Autolinker.matcher.UrlMatchValidator\n     * @singleton\n     *\n     * Used by Autolinker to filter out false URL positives from the\n     * {@link Autolinker.matcher.Url UrlMatcher}.\n     *\n     * Due to the limitations of regular expressions (including the missing feature\n     * of look-behinds in JS regular expressions), we cannot always determine the\n     * validity of a given match. This class applies a bit of additional logic to\n     * filter out any false positives that have been matched by the\n     * {@link Autolinker.matcher.Url UrlMatcher}.\n     */\n    var UrlMatchValidator = /** @class */ (function () {\n        function UrlMatchValidator() {\n        }\n        /**\n         * Determines if a given URL match found by the {@link Autolinker.matcher.Url UrlMatcher}\n         * is valid. Will return `false` for:\n         *\n         * 1) URL matches which do not have at least have one period ('.') in the\n         *    domain name (effectively skipping over matches like \"abc:def\").\n         *    However, URL matches with a protocol will be allowed (ex: 'http-colon-slashslash localhost')\n         * 2) URL matches which do not have at least one word character in the\n         *    domain name (effectively skipping over matches like \"git:1.0\").\n         * 3) A protocol-relative url match (a URL beginning with '//') whose\n         *    previous character is a word character (effectively skipping over\n         *    strings like \"abc//google.com\")\n         *\n         * Otherwise, returns `true`.\n         *\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Boolean} `true` if the match given is valid and should be\n         *   processed, or `false` if the match is invalid and/or should just not be\n         *   processed.\n         */\n        UrlMatchValidator.isValid = function (urlMatch, protocolUrlMatch) {\n            if ((protocolUrlMatch && !this.isValidUriScheme(protocolUrlMatch)) ||\n                this.urlMatchDoesNotHaveProtocolOrDot(urlMatch, protocolUrlMatch) || // At least one period ('.') must exist in the URL match for us to consider it an actual URL, *unless* it was a full protocol match (like 'http://localhost')\n                (this.urlMatchDoesNotHaveAtLeastOneWordChar(urlMatch, protocolUrlMatch) && // At least one letter character must exist in the domain name after a protocol match. Ex: skip over something like \"git:1.0\"\n                    !this.isValidIpAddress(urlMatch)) || // Except if it's an IP address\n                this.containsMultipleDots(urlMatch)) {\n                return false;\n            }\n            return true;\n        };\n        UrlMatchValidator.isValidIpAddress = function (uriSchemeMatch) {\n            var newRegex = new RegExp(this.hasFullProtocolRegex.source + this.ipRegex.source);\n            var uriScheme = uriSchemeMatch.match(newRegex);\n            return uriScheme !== null;\n        };\n        UrlMatchValidator.containsMultipleDots = function (urlMatch) {\n            var stringBeforeSlash = urlMatch;\n            if (this.hasFullProtocolRegex.test(urlMatch)) {\n                stringBeforeSlash = urlMatch.split('://')[1];\n            }\n            return stringBeforeSlash.split('/')[0].indexOf(\"..\") > -1;\n        };\n        /**\n         * Determines if the URI scheme is a valid scheme to be autolinked. Returns\n         * `false` if the scheme is 'javascript:' or 'vbscript:'\n         *\n         * @private\n         * @param {String} uriSchemeMatch The match URL string for a full URI scheme\n         *   match. Ex: 'http-colon-slashslash yahoo.com' or 'mailto:a@a.com'.\n         * @return {Boolean} `true` if the scheme is a valid one, `false` otherwise.\n         */\n        UrlMatchValidator.isValidUriScheme = function (uriSchemeMatch) {\n            var uriSchemeMatchArr = uriSchemeMatch.match(this.uriSchemeRegex), uriScheme = uriSchemeMatchArr && uriSchemeMatchArr[0].toLowerCase();\n            return (uriScheme !== 'javascript:' && uriScheme !== 'vbscript:');\n        };\n        /**\n         * Determines if a URL match does not have either:\n         *\n         * a) a full protocol (i.e. 'http-colon-slashslash '), or\n         * b) at least one dot ('.') in the domain name (for a non-full-protocol\n         *    match).\n         *\n         * Either situation is considered an invalid URL (ex: 'git:d' does not have\n         * either the '://' part, or at least one dot in the domain name. If the\n         * match was 'git:abc.com', we would consider this valid.)\n         *\n         * @private\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Boolean} `true` if the URL match does not have a full protocol,\n         *   or at least one dot ('.') in a non-full-protocol match.\n         */\n        UrlMatchValidator.urlMatchDoesNotHaveProtocolOrDot = function (urlMatch, protocolUrlMatch) {\n            return (!!urlMatch && (!protocolUrlMatch || !this.hasFullProtocolRegex.test(protocolUrlMatch)) && urlMatch.indexOf('.') === -1);\n        };\n        /**\n         * Determines if a URL match does not have at least one word character after\n         * the protocol (i.e. in the domain name).\n         *\n         * At least one letter character must exist in the domain name after a\n         * protocol match. Ex: skip over something like \"git:1.0\"\n         *\n         * @private\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} protocolUrlMatch The match URL string for a protocol\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to know whether or not we\n         *   have a protocol in the URL string, in order to check for a word\n         *   character after the protocol separator (':').\n         * @return {Boolean} `true` if the URL match does not have at least one word\n         *   character in it after the protocol, `false` otherwise.\n         */\n        UrlMatchValidator.urlMatchDoesNotHaveAtLeastOneWordChar = function (urlMatch, protocolUrlMatch) {\n            if (urlMatch && protocolUrlMatch) {\n                return !this.hasWordCharAfterProtocolRegex.test(urlMatch);\n            }\n            else {\n                return false;\n            }\n        };\n        /**\n         * Regex to test for a full protocol, with the two trailing slashes. Ex: 'http-colon-slashslash '\n         *\n         * @private\n         * @property {RegExp} hasFullProtocolRegex\n         */\n        UrlMatchValidator.hasFullProtocolRegex = /^[A-Za-z][-.+A-Za-z0-9]*:\\/\\//;\n        /**\n         * Regex to find the URI scheme, such as 'mailto:'.\n         *\n         * This is used to filter out 'javascript:' and 'vbscript:' schemes.\n         *\n         * @private\n         * @property {RegExp} uriSchemeRegex\n         */\n        UrlMatchValidator.uriSchemeRegex = /^[A-Za-z][-.+A-Za-z0-9]*:/;\n        /**\n         * Regex to determine if at least one word char exists after the protocol (i.e. after the ':')\n         *\n         * @private\n         * @property {RegExp} hasWordCharAfterProtocolRegex\n         */\n        UrlMatchValidator.hasWordCharAfterProtocolRegex = new RegExp(\":[^\\\\s]*?[\" + alphaCharsStr + \"]\");\n        /**\n         * Regex to determine if the string is a valid IP address\n         *\n         * @private\n         * @property {RegExp} ipRegex\n         */\n        UrlMatchValidator.ipRegex = /[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?\\.[0-9][0-9]?[0-9]?(:[0-9]*)?\\/?$/;\n        return UrlMatchValidator;\n    }());\n\n    /**\n     * @class Autolinker.matcher.Url\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find URL matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more details.\n     */\n    var UrlMatcher = /** @class */ (function (_super) {\n        __extends(UrlMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function UrlMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {Object} stripPrefix (required)\n             *\n             * The Object form of {@link Autolinker#cfg-stripPrefix}.\n             */\n            _this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} stripTrailingSlash (required)\n             * @inheritdoc Autolinker#stripTrailingSlash\n             */\n            _this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} decodePercentEncoding (required)\n             * @inheritdoc Autolinker#decodePercentEncoding\n             */\n            _this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @protected\n             * @property {RegExp} matcherRegex\n             *\n             * The regular expression to match URLs with an optional scheme, port\n             * number, path, query string, and hash anchor.\n             *\n             * Example matches:\n             *\n             *     http-colon-slashslash google.com\n             *     www.google.com\n             *     google.com/path/to/file?q1=1&q2=2#myAnchor\n             *\n             *\n             * This regular expression will have the following capturing groups:\n             *\n             * 1.  Group that matches a scheme-prefixed URL (i.e. 'http-colon-slashslash google.com').\n             *     This is used to match scheme URLs with just a single word, such as\n             *     'http-colon-slashslash localhost', where we won't double check that the domain name\n             *     has at least one dot ('.') in it.\n             * 2.  Group that matches a 'www.' prefixed URL. This is only matched if the\n             *     'www.' text was not prefixed by a scheme (i.e.: not prefixed by\n             *     'http-colon-slashslash ', 'ftp:', etc.)\n             * 3.  A protocol-relative ('//') match for the case of a 'www.' prefixed\n             *     URL. Will be an empty string if it is not a protocol-relative match.\n             *     We need to know the character before the '//' in order to determine\n             *     if it is a valid match or the // was in a string we don't want to\n             *     auto-link.\n             * 4.  Group that matches a known TLD (top level domain), when a scheme\n             *     or 'www.'-prefixed domain is not matched.\n             * 5.  A protocol-relative ('//') match for the case of a known TLD prefixed\n             *     URL. Will be an empty string if it is not a protocol-relative match.\n             *     See #3 for more info.\n             */\n            _this.matcherRegex = (function () {\n                var schemeRegex = /(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\\/\\/)(?!\\d+\\/?)(?:\\/\\/)?)/, // match protocol, allow in format \"http://\" or \"mailto:\". However, do not match the first part of something like 'link:http://www.google.com' (i.e. don't match \"link:\"). Also, make sure we don't interpret 'google.com:8000' as if 'google.com' was a protocol here (i.e. ignore a trailing port number in this regex)\n                wwwRegex = /(?:www\\.)/, // starting with 'www.'\n                // Allow optional path, query string, and hash anchor, not ending in the following characters: \"?!:,.;\"\n                // http://blog.codinghorror.com/the-problem-with-urls/\n                urlSuffixRegex = new RegExp('[/?#](?:[' + alphaNumericAndMarksCharsStr + '\\\\-+&@#/%=~_()|\\'$*\\\\[\\\\]?!:,.;\\u2713]*[' + alphaNumericAndMarksCharsStr + '\\\\-+&@#/%=~_()|\\'$*\\\\[\\\\]\\u2713])?');\n                return new RegExp([\n                    '(?:',\n                    '(',\n                    schemeRegex.source,\n                    getDomainNameStr(2),\n                    ')',\n                    '|',\n                    '(',\n                    '(//)?',\n                    wwwRegex.source,\n                    getDomainNameStr(6),\n                    ')',\n                    '|',\n                    '(',\n                    '(//)?',\n                    getDomainNameStr(10) + '\\\\.',\n                    tldRegex.source,\n                    '(?![-' + alphaNumericCharsStr + '])',\n                    ')',\n                    ')',\n                    '(?::[0-9]+)?',\n                    '(?:' + urlSuffixRegex.source + ')?' // match for path, query string, and/or hash anchor - optional\n                ].join(\"\"), 'gi');\n            })();\n            /**\n             * A regular expression to use to check the character before a protocol-relative\n             * URL match. We don't want to match a protocol-relative URL if it is part\n             * of another word.\n             *\n             * For example, we want to match something like \"Go to: //google.com\",\n             * but we don't want to match something like \"abc//google.com\"\n             *\n             * This regular expression is used to test the character before the '//'.\n             *\n             * @protected\n             * @type {RegExp} wordCharRegExp\n             */\n            _this.wordCharRegExp = new RegExp('[' + alphaNumericAndMarksCharsStr + ']');\n            _this.stripPrefix = cfg.stripPrefix;\n            _this.stripTrailingSlash = cfg.stripTrailingSlash;\n            _this.decodePercentEncoding = cfg.decodePercentEncoding;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        UrlMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, stripPrefix = this.stripPrefix, stripTrailingSlash = this.stripTrailingSlash, decodePercentEncoding = this.decodePercentEncoding, tagBuilder = this.tagBuilder, matches = [], match;\n            var _loop_1 = function () {\n                var matchStr = match[0], schemeUrlMatch = match[1], wwwUrlMatch = match[4], wwwProtocolRelativeMatch = match[5],\n                //tldUrlMatch = match[ 8 ],  -- not needed at the moment\n                tldProtocolRelativeMatch = match[9], offset = match.index, protocolRelativeMatch = wwwProtocolRelativeMatch || tldProtocolRelativeMatch, prevChar = text.charAt(offset - 1);\n                if (!UrlMatchValidator.isValid(matchStr, schemeUrlMatch)) {\n                    return \"continue\";\n                }\n                // If the match is preceded by an '@' character, then it is either\n                // an email address or a username. Skip these types of matches.\n                if (offset > 0 && prevChar === '@') {\n                    return \"continue\";\n                }\n                // If it's a protocol-relative '//' match, but the character before the '//'\n                // was a word character (i.e. a letter/number), then we found the '//' in the\n                // middle of another word (such as \"asdf//asdf.com\"). In this case, skip the\n                // match.\n                if (offset > 0 && protocolRelativeMatch && this_1.wordCharRegExp.test(prevChar)) {\n                    return \"continue\";\n                }\n                // If the URL ends with a question mark, don't include the question\n                // mark as part of the URL. We'll assume the question mark was the\n                // end of a sentence, such as: \"Going to google.com?\"\n                if (/\\?$/.test(matchStr)) {\n                    matchStr = matchStr.substr(0, matchStr.length - 1);\n                }\n                // Handle a closing parenthesis or square bracket at the end of the\n                // match, and exclude it if there is not a matching open parenthesis\n                // or square bracket in the match itself.\n                if (this_1.matchHasUnbalancedClosingParen(matchStr)) {\n                    matchStr = matchStr.substr(0, matchStr.length - 1); // remove the trailing \")\"\n                }\n                else {\n                    // Handle an invalid character after the TLD\n                    var pos = this_1.matchHasInvalidCharAfterTld(matchStr, schemeUrlMatch);\n                    if (pos > -1) {\n                        matchStr = matchStr.substr(0, pos); // remove the trailing invalid chars\n                    }\n                }\n                // The autolinker accepts many characters in a url's scheme (like `fake://test.com`).\n                // However, in cases where a URL is missing whitespace before an obvious link,\n                // (for example: `nowhitespacehttp://www.test.com`), we only want the match to start\n                // at the http:// part. We will check if the match contains a common scheme and then\n                // shift the match to start from there.\n                var foundCommonScheme = ['http://', 'https://'].find(function (commonScheme) { return !!schemeUrlMatch && schemeUrlMatch.indexOf(commonScheme) !== -1; });\n                if (foundCommonScheme) {\n                    // If we found an overmatched URL, we want to find the index\n                    // of where the match should start and shift the match to\n                    // start from the beginning of the common scheme\n                    var indexOfSchemeStart = matchStr.indexOf(foundCommonScheme);\n                    matchStr = matchStr.substr(indexOfSchemeStart);\n                    schemeUrlMatch = schemeUrlMatch.substr(indexOfSchemeStart);\n                    offset = offset + indexOfSchemeStart;\n                }\n                var urlMatchType = schemeUrlMatch ? 'scheme' : (wwwUrlMatch ? 'www' : 'tld'), protocolUrlMatch = !!schemeUrlMatch;\n                matches.push(new UrlMatch({\n                    tagBuilder: tagBuilder,\n                    matchedText: matchStr,\n                    offset: offset,\n                    urlMatchType: urlMatchType,\n                    url: matchStr,\n                    protocolUrlMatch: protocolUrlMatch,\n                    protocolRelativeMatch: !!protocolRelativeMatch,\n                    stripPrefix: stripPrefix,\n                    stripTrailingSlash: stripTrailingSlash,\n                    decodePercentEncoding: decodePercentEncoding,\n                }));\n            };\n            var this_1 = this;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                _loop_1();\n            }\n            return matches;\n        };\n        /**\n         * Determines if a match found has an unmatched closing parenthesis or\n         * square bracket. If so, the parenthesis or square bracket will be removed\n         * from the match itself, and appended after the generated anchor tag.\n         *\n         * A match may have an extra closing parenthesis at the end of the match\n         * because the regular expression must include parenthesis for URLs such as\n         * \"wikipedia.com/something_(disambiguation)\", which should be auto-linked.\n         *\n         * However, an extra parenthesis *will* be included when the URL itself is\n         * wrapped in parenthesis, such as in the case of:\n         *     \"(wikipedia.com/something_(disambiguation))\"\n         * In this case, the last closing parenthesis should *not* be part of the\n         * URL itself, and this method will return `true`.\n         *\n         * For square brackets in URLs such as in PHP arrays, the same behavior as\n         * parenthesis discussed above should happen:\n         *     \"[http-colon-slashslash www.example.com/foo.php?bar[]=1&bar[]=2&bar[]=3]\"\n         * The closing square bracket should not be part of the URL itself, and this\n         * method will return `true`.\n         *\n         * @protected\n         * @param {String} matchStr The full match string from the {@link #matcherRegex}.\n         * @return {Boolean} `true` if there is an unbalanced closing parenthesis or\n         *   square bracket at the end of the `matchStr`, `false` otherwise.\n         */\n        UrlMatcher.prototype.matchHasUnbalancedClosingParen = function (matchStr) {\n            var endChar = matchStr.charAt(matchStr.length - 1);\n            var startChar;\n            if (endChar === ')') {\n                startChar = '(';\n            }\n            else if (endChar === ']') {\n                startChar = '[';\n            }\n            else {\n                return false; // not a close parenthesis or square bracket\n            }\n            // Find if there are the same number of open braces as close braces in\n            // the URL string, minus the last character (which we have already\n            // determined to be either ')' or ']'\n            var numOpenBraces = 0;\n            for (var i = 0, len = matchStr.length - 1; i < len; i++) {\n                var char = matchStr.charAt(i);\n                if (char === startChar) {\n                    numOpenBraces++;\n                }\n                else if (char === endChar) {\n                    numOpenBraces = Math.max(numOpenBraces - 1, 0);\n                }\n            }\n            // If the number of open braces matches the number of close braces in\n            // the URL minus the last character, then the match has *unbalanced*\n            // braces because of the last character. Example of unbalanced braces\n            // from the regex match:\n            //     \"http://example.com?a[]=1]\"\n            if (numOpenBraces === 0) {\n                return true;\n            }\n            return false;\n        };\n        /**\n         * Determine if there's an invalid character after the TLD in a URL. Valid\n         * characters after TLD are ':/?#'. Exclude scheme matched URLs from this\n         * check.\n         *\n         * @protected\n         * @param {String} urlMatch The matched URL, if there was one. Will be an\n         *   empty string if the match is not a URL match.\n         * @param {String} schemeUrlMatch The match URL string for a scheme\n         *   match. Ex: 'http-colon-slashslash yahoo.com'. This is used to match something like\n         *   'http-colon-slashslash localhost', where we won't double check that the domain name\n         *   has at least one '.' in it.\n         * @return {Number} the position where the invalid character was found. If\n         *   no such character was found, returns -1\n         */\n        UrlMatcher.prototype.matchHasInvalidCharAfterTld = function (urlMatch, schemeUrlMatch) {\n            if (!urlMatch) {\n                return -1;\n            }\n            var offset = 0;\n            if (schemeUrlMatch) {\n                offset = urlMatch.indexOf(':');\n                urlMatch = urlMatch.slice(offset);\n            }\n            var re = new RegExp(\"^((.?\\/\\/)?[-.\" + alphaNumericAndMarksCharsStr + \"]*[-\" + alphaNumericAndMarksCharsStr + \"]\\\\.[-\" + alphaNumericAndMarksCharsStr + \"]+)\");\n            var res = re.exec(urlMatch);\n            if (res === null) {\n                return -1;\n            }\n            offset += res[1].length;\n            urlMatch = urlMatch.slice(res[1].length);\n            if (/^[^-.A-Za-z0-9:\\/?#]/.test(urlMatch)) {\n                return offset;\n            }\n            return -1;\n        };\n        return UrlMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Hashtag\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find HashtagMatch matches in an input string.\n     */\n    var HashtagMatcher = /** @class */ (function (_super) {\n        __extends(HashtagMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function HashtagMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {String} serviceName\n             *\n             * The service to point hashtag matches to. See {@link Autolinker#hashtag}\n             * for available values.\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * The regular expression to match Hashtags. Example match:\n             *\n             *     #asdf\n             *\n             * @protected\n             * @property {RegExp} matcherRegex\n             */\n            _this.matcherRegex = new RegExp(\"#[_\" + alphaNumericAndMarksCharsStr + \"]{1,139}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'); // lookahead used to make sure we don't match something above 139 characters\n            /**\n             * The regular expression to use to check the character before a username match to\n             * make sure we didn't accidentally match an email address.\n             *\n             * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n             *\n             * @protected\n             * @property {RegExp} nonWordCharRegex\n             */\n            _this.nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        HashtagMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, nonWordCharRegex = this.nonWordCharRegex, serviceName = this.serviceName, tagBuilder = this.tagBuilder, matches = [], match;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                var offset = match.index, prevChar = text.charAt(offset - 1);\n                // If we found the match at the beginning of the string, or we found the match\n                // and there is a whitespace char in front of it (meaning it is not a '#' char\n                // in the middle of a word), then it is a hashtag match.\n                if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n                    var matchedText = match[0], hashtag = match[0].slice(1); // strip off the '#' character at the beginning\n                    matches.push(new HashtagMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: offset,\n                        serviceName: serviceName,\n                        hashtag: hashtag\n                    }));\n                }\n            }\n            return matches;\n        };\n        return HashtagMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Phone\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find Phone number matches in an input string.\n     *\n     * See this class's superclass ({@link Autolinker.matcher.Matcher}) for more\n     * details.\n     */\n    var PhoneMatcher = /** @class */ (function (_super) {\n        __extends(PhoneMatcher, _super);\n        function PhoneMatcher() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            /**\n             * The regular expression to match Phone numbers. Example match:\n             *\n             *     (123) 456-7890\n             *\n             * This regular expression has the following capturing groups:\n             *\n             * 1 or 2. The prefixed '+' sign, if there is one.\n             *\n             * @protected\n             * @property {RegExp} matcherRegex\n             */\n            _this.matcherRegex = /(?:(?:(?:(\\+)?\\d{1,3}[-\\040.]?)?\\(?\\d{3}\\)?[-\\040.]?\\d{3}[-\\040.]?\\d{4})|(?:(\\+)(?:9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\\040.]?(?:\\d[-\\040.]?){6,12}\\d+))([,;]+[0-9]+#?)*/g;\n            return _this;\n        }\n        // ex: (123) 456-7890, 123 456 7890, 123-456-7890, +18004441234,,;,10226420346#,\n        // +1 (800) 444 1234, 10226420346#, 1-800-444-1234,1022,64,20346#\n        /**\n         * @inheritdoc\n         */\n        PhoneMatcher.prototype.parseMatches = function (text) {\n            var matcherRegex = this.matcherRegex, tagBuilder = this.tagBuilder, matches = [], match;\n            while ((match = matcherRegex.exec(text)) !== null) {\n                // Remove non-numeric values from phone number string\n                var matchedText = match[0], cleanNumber = matchedText.replace(/[^0-9,;#]/g, ''), // strip out non-digit characters exclude comma semicolon and #\n                plusSign = !!(match[1] || match[2]), // match[ 1 ] or match[ 2 ] is the prefixed plus sign, if there is one\n                before = match.index == 0 ? '' : text.substr(match.index - 1, 1), after = text.substr(match.index + matchedText.length, 1), contextClear = !before.match(/\\d/) && !after.match(/\\d/);\n                if (this.testMatch(match[3]) && this.testMatch(matchedText) && contextClear) {\n                    matches.push(new PhoneMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: match.index,\n                        number: cleanNumber,\n                        plusSign: plusSign\n                    }));\n                }\n            }\n            return matches;\n        };\n        PhoneMatcher.prototype.testMatch = function (text) {\n            return /\\D/.test(text);\n        };\n        return PhoneMatcher;\n    }(Matcher));\n\n    /**\n     * @class Autolinker.matcher.Mention\n     * @extends Autolinker.matcher.Matcher\n     *\n     * Matcher to find/replace username matches in an input string.\n     */\n    var MentionMatcher = /** @class */ (function (_super) {\n        __extends(MentionMatcher, _super);\n        /**\n         * @method constructor\n         * @param {Object} cfg The configuration properties for the Match instance,\n         *   specified in an Object (map).\n         */\n        function MentionMatcher(cfg) {\n            var _this = _super.call(this, cfg) || this;\n            /**\n             * @cfg {'twitter'/'instagram'/'soundcloud'} protected\n             *\n             * The name of service to link @mentions to.\n             *\n             * Valid values are: 'twitter', 'instagram', or 'soundcloud'\n             */\n            _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * Hash of regular expression to match username handles. Example match:\n             *\n             *     @asdf\n             *\n             * @private\n             * @property {Object} matcherRegexes\n             */\n            _this.matcherRegexes = {\n                'twitter': new RegExp(\"@[_\" + alphaNumericAndMarksCharsStr + \"]{1,50}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'),\n                'instagram': new RegExp(\"@[_.\" + alphaNumericAndMarksCharsStr + \"]{1,30}(?![_\" + alphaNumericAndMarksCharsStr + \"])\", 'g'),\n                'soundcloud': new RegExp(\"@[-_.\" + alphaNumericAndMarksCharsStr + \"]{1,50}(?![-_\" + alphaNumericAndMarksCharsStr + \"])\", 'g') // lookahead used to make sure we don't match something above 50 characters\n            };\n            /**\n             * The regular expression to use to check the character before a username match to\n             * make sure we didn't accidentally match an email address.\n             *\n             * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n             *\n             * @private\n             * @property {RegExp} nonWordCharRegex\n             */\n            _this.nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n            _this.serviceName = cfg.serviceName;\n            return _this;\n        }\n        /**\n         * @inheritdoc\n         */\n        MentionMatcher.prototype.parseMatches = function (text) {\n            var serviceName = this.serviceName, matcherRegex = this.matcherRegexes[this.serviceName], nonWordCharRegex = this.nonWordCharRegex, tagBuilder = this.tagBuilder, matches = [], match;\n            if (!matcherRegex) {\n                return matches;\n            }\n            while ((match = matcherRegex.exec(text)) !== null) {\n                var offset = match.index, prevChar = text.charAt(offset - 1);\n                // If we found the match at the beginning of the string, or we found the match\n                // and there is a whitespace char in front of it (meaning it is not an email\n                // address), then it is a username match.\n                if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n                    var matchedText = match[0].replace(/\\.+$/g, ''), // strip off trailing .\n                    mention = matchedText.slice(1); // strip off the '@' character at the beginning\n                    matches.push(new MentionMatch({\n                        tagBuilder: tagBuilder,\n                        matchedText: matchedText,\n                        offset: offset,\n                        serviceName: serviceName,\n                        mention: mention\n                    }));\n                }\n            }\n            return matches;\n        };\n        return MentionMatcher;\n    }(Matcher));\n\n    // For debugging: search for other \"For debugging\" lines\n    // import CliTable from 'cli-table';\n    /**\n     * Parses an HTML string, calling the callbacks to notify of tags and text.\n     *\n     * ## History\n     *\n     * This file previously used a regular expression to find html tags in the input\n     * text. Unfortunately, we ran into a bunch of catastrophic backtracking issues\n     * with certain input text, causing Autolinker to either hang or just take a\n     * really long time to parse the string.\n     *\n     * The current code is intended to be a O(n) algorithm that walks through\n     * the string in one pass, and tries to be as cheap as possible. We don't need\n     * to implement the full HTML spec, but rather simply determine where the string\n     * looks like an HTML tag, and where it looks like text (so that we can autolink\n     * that).\n     *\n     * This state machine parser is intended just to be a simple but performant\n     * parser of HTML for the subset of requirements we have. We simply need to:\n     *\n     * 1. Determine where HTML tags are\n     * 2. Determine the tag name (Autolinker specifically only cares about <a>,\n     *    <script>, and <style> tags, so as not to link any text within them)\n     *\n     * We don't need to:\n     *\n     * 1. Create a parse tree\n     * 2. Auto-close tags with invalid markup\n     * 3. etc.\n     *\n     * The other intention behind this is that we didn't want to add external\n     * dependencies on the Autolinker utility which would increase its size. For\n     * instance, adding htmlparser2 adds 125kb to the minified output file,\n     * increasing its final size from 47kb to 172kb (at the time of writing). It\n     * also doesn't work exactly correctly, treating the string \"<3 blah blah blah\"\n     * as an HTML tag.\n     *\n     * Reference for HTML spec:\n     *\n     *     https-colon-slashslash www.w3.org/TR/html51/syntax.html#sec-tokenization\n     *\n     * @param {String} html The HTML to parse\n     * @param {Object} callbacks\n     * @param {Function} callbacks.onOpenTag Callback function to call when an open\n     *   tag is parsed. Called with the tagName as its argument.\n     * @param {Function} callbacks.onCloseTag Callback function to call when a close\n     *   tag is parsed. Called with the tagName as its argument. If a self-closing\n     *   tag is found, `onCloseTag` is called immediately after `onOpenTag`.\n     * @param {Function} callbacks.onText Callback function to call when text (i.e\n     *   not an HTML tag) is parsed. Called with the text (string) as its first\n     *   argument, and offset (number) into the string as its second.\n     */\n    function parseHtml(html, _a) {\n        var onOpenTag = _a.onOpenTag, onCloseTag = _a.onCloseTag, onText = _a.onText, onComment = _a.onComment, onDoctype = _a.onDoctype;\n        var noCurrentTag = new CurrentTag();\n        var charIdx = 0, len = html.length, state = 0 /* Data */, currentDataIdx = 0, // where the current data start index is\n        currentTag = noCurrentTag; // describes the current tag that is being read\n        // For debugging: search for other \"For debugging\" lines\n        // const table = new CliTable( {\n        // \thead: [ 'charIdx', 'char', 'state', 'currentDataIdx', 'currentOpenTagIdx', 'tag.type' ]\n        // } );\n        while (charIdx < len) {\n            var char = html.charAt(charIdx);\n            // For debugging: search for other \"For debugging\" lines\n            // ALSO: Temporarily remove the 'const' keyword on the State enum\n            // table.push(\n            // \t[ charIdx, char, State[ state ], currentDataIdx, currentTag.idx, currentTag.idx === -1 ? '' : currentTag.type ]\n            // );\n            switch (state) {\n                case 0 /* Data */:\n                    stateData(char);\n                    break;\n                case 1 /* TagOpen */:\n                    stateTagOpen(char);\n                    break;\n                case 2 /* EndTagOpen */:\n                    stateEndTagOpen(char);\n                    break;\n                case 3 /* TagName */:\n                    stateTagName(char);\n                    break;\n                case 4 /* BeforeAttributeName */:\n                    stateBeforeAttributeName(char);\n                    break;\n                case 5 /* AttributeName */:\n                    stateAttributeName(char);\n                    break;\n                case 6 /* AfterAttributeName */:\n                    stateAfterAttributeName(char);\n                    break;\n                case 7 /* BeforeAttributeValue */:\n                    stateBeforeAttributeValue(char);\n                    break;\n                case 8 /* AttributeValueDoubleQuoted */:\n                    stateAttributeValueDoubleQuoted(char);\n                    break;\n                case 9 /* AttributeValueSingleQuoted */:\n                    stateAttributeValueSingleQuoted(char);\n                    break;\n                case 10 /* AttributeValueUnquoted */:\n                    stateAttributeValueUnquoted(char);\n                    break;\n                case 11 /* AfterAttributeValueQuoted */:\n                    stateAfterAttributeValueQuoted(char);\n                    break;\n                case 12 /* SelfClosingStartTag */:\n                    stateSelfClosingStartTag(char);\n                    break;\n                case 13 /* MarkupDeclarationOpenState */:\n                    stateMarkupDeclarationOpen(char);\n                    break;\n                case 14 /* CommentStart */:\n                    stateCommentStart(char);\n                    break;\n                case 15 /* CommentStartDash */:\n                    stateCommentStartDash(char);\n                    break;\n                case 16 /* Comment */:\n                    stateComment(char);\n                    break;\n                case 17 /* CommentEndDash */:\n                    stateCommentEndDash(char);\n                    break;\n                case 18 /* CommentEnd */:\n                    stateCommentEnd(char);\n                    break;\n                case 19 /* CommentEndBang */:\n                    stateCommentEndBang(char);\n                    break;\n                case 20 /* Doctype */:\n                    stateDoctype(char);\n                    break;\n                default:\n                    throwUnhandledCaseError(state);\n            }\n            // For debugging: search for other \"For debugging\" lines\n            // ALSO: Temporarily remove the 'const' keyword on the State enum\n            // table.push(\n            // \t[ charIdx, char, State[ state ], currentDataIdx, currentTag.idx, currentTag.idx === -1 ? '' : currentTag.type ]\n            // );\n            charIdx++;\n        }\n        if (currentDataIdx < charIdx) {\n            emitText();\n        }\n        // For debugging: search for other \"For debugging\" lines\n        // console.log( '\\n' + table.toString() );\n        // Called when non-tags are being read (i.e. the text around HTML ags)\n        // https://www.w3.org/TR/html51/syntax.html#data-state\n        function stateData(char) {\n            if (char === '<') {\n                startNewTag();\n            }\n        }\n        // Called after a '<' is read from the Data state\n        // https://www.w3.org/TR/html51/syntax.html#tag-open-state\n        function stateTagOpen(char) {\n            if (char === '!') {\n                state = 13 /* MarkupDeclarationOpenState */;\n            }\n            else if (char === '/') {\n                state = 2 /* EndTagOpen */;\n                currentTag = new CurrentTag(__assign({}, currentTag, { isClosing: true }));\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (letterRe.test(char)) {\n                // tag name start (and no '/' read)\n                state = 3 /* TagName */;\n                currentTag = new CurrentTag(__assign({}, currentTag, { isOpening: true }));\n            }\n            else {\n                // Any other\n                state = 0 /* Data */;\n                currentTag = noCurrentTag;\n            }\n        }\n        // After a '<x', '</x' sequence is read (where 'x' is a letter character),\n        // this is to continue reading the tag name\n        // https://www.w3.org/TR/html51/syntax.html#tag-name-state\n        function stateTagName(char) {\n            if (whitespaceRe.test(char)) {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (char === '/') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { name: captureTagName() }));\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (!letterRe.test(char) && !digitRe.test(char) && char !== ':') {\n                // Anything else that does not form an html tag. Note: the colon\n                // character is accepted for XML namespaced tags\n                resetToDataState();\n            }\n        }\n        // Called after the '/' is read from a '</' sequence\n        // https://www.w3.org/TR/html51/syntax.html#end-tag-open-state\n        function stateEndTagOpen(char) {\n            if (char === '>') { // parse error. Encountered \"</>\". Skip it without treating as a tag\n                resetToDataState();\n            }\n            else if (letterRe.test(char)) {\n                state = 3 /* TagName */;\n            }\n            else {\n                // some other non-tag-like character, don't treat this as a tag\n                resetToDataState();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#before-attribute-name-state\n        function stateBeforeAttributeName(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (char === \"=\" || quoteRe.test(char) || controlCharsRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n            else {\n                // Any other char, start of a new attribute name\n                state = 5 /* AttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-name-state\n        function stateAttributeName(char) {\n            if (whitespaceRe.test(char)) {\n                state = 6 /* AfterAttributeName */;\n            }\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '=') {\n                state = 7 /* BeforeAttributeValue */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (quoteRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#after-attribute-name-state\n        function stateAfterAttributeName(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '=') {\n                state = 7 /* BeforeAttributeValue */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else if (quoteRe.test(char)) {\n                // \"Parse error\" characters that, according to the spec, should be\n                // appended to the attribute name, but we'll treat these characters\n                // as not forming a real HTML tag\n                resetToDataState();\n            }\n            else {\n                // Any other character, start a new attribute in the current tag\n                state = 5 /* AttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#before-attribute-value-state\n        function stateBeforeAttributeValue(char) {\n            if (whitespaceRe.test(char)) ;\n            else if (char === \"\\\"\") {\n                state = 8 /* AttributeValueDoubleQuoted */;\n            }\n            else if (char === \"'\") {\n                state = 9 /* AttributeValueSingleQuoted */;\n            }\n            else if (/[>=`]/.test(char)) {\n                // Invalid chars after an '=' for an attribute value, don't count\n                // the current tag as an HTML tag\n                resetToDataState();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else {\n                // Any other character, consider it an unquoted attribute value\n                state = 10 /* AttributeValueUnquoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-double-quoted-state\n        function stateAttributeValueDoubleQuoted(char) {\n            if (char === \"\\\"\") { // end the current double-quoted attribute\n                state = 11 /* AfterAttributeValueQuoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-single-quoted-state\n        function stateAttributeValueSingleQuoted(char) {\n            if (char === \"'\") { // end the current single-quoted attribute\n                state = 11 /* AfterAttributeValueQuoted */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#attribute-value-unquoted-state\n        function stateAttributeValueUnquoted(char) {\n            if (whitespaceRe.test(char)) {\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#after-attribute-value-quoted-state\n        function stateAfterAttributeValueQuoted(char) {\n            if (whitespaceRe.test(char)) {\n                state = 4 /* BeforeAttributeName */;\n            }\n            else if (char === '/') {\n                state = 12 /* SelfClosingStartTag */;\n            }\n            else if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                // start of another tag (ignore the previous, incomplete one)\n                startNewTag();\n            }\n            else {\n                // Any other character, \"parse error\". Spec says to switch to the\n                // BeforeAttributeState and re-consume the character, as it may be\n                // the start of a new attribute name\n                state = 4 /* BeforeAttributeName */;\n                reconsumeCurrentCharacter();\n            }\n        }\n        // A '/' has just been read in the current tag (presumably for '/>'), and\n        // this handles the next character\n        // https://www.w3.org/TR/html51/syntax.html#self-closing-start-tag-state\n        function stateSelfClosingStartTag(char) {\n            if (char === '>') {\n                currentTag = new CurrentTag(__assign({}, currentTag, { isClosing: true }));\n                emitTagAndPreviousTextNode(); // resets to Data state as well\n            }\n            else {\n                state = 4 /* BeforeAttributeName */;\n            }\n        }\n        // https://www.w3.org/TR/html51/syntax.html#markup-declaration-open-state\n        // (HTML Comments or !DOCTYPE)\n        function stateMarkupDeclarationOpen(char) {\n            if (html.substr(charIdx, 2) === '--') { // html comment\n                charIdx += 2; // \"consume\" characters\n                currentTag = new CurrentTag(__assign({}, currentTag, { type: 'comment' }));\n                state = 14 /* CommentStart */;\n            }\n            else if (html.substr(charIdx, 7).toUpperCase() === 'DOCTYPE') {\n                charIdx += 7; // \"consume\" characters\n                currentTag = new CurrentTag(__assign({}, currentTag, { type: 'doctype' }));\n                state = 20 /* Doctype */;\n            }\n            else {\n                // At this point, the spec specifies that the state machine should\n                // enter the \"bogus comment\" state, in which case any character(s)\n                // after the '<!' that were read should become an HTML comment up\n                // until the first '>' that is read (or EOF). Instead, we'll assume\n                // that a user just typed '<!' as part of text data\n                resetToDataState();\n            }\n        }\n        // Handles after the sequence '<!--' has been read\n        // https://www.w3.org/TR/html51/syntax.html#comment-start-state\n        function stateCommentStart(char) {\n            if (char === '-') {\n                // We've read the sequence '<!---' at this point (3 dashes)\n                state = 15 /* CommentStartDash */;\n            }\n            else if (char === '>') {\n                // At this point, we'll assume the comment wasn't a real comment\n                // so we'll just emit it as data. We basically read the sequence\n                // '<!-->'\n                resetToDataState();\n            }\n            else {\n                // Any other char, take it as part of the comment\n                state = 16 /* Comment */;\n            }\n        }\n        // We've read the sequence '<!---' at this point (3 dashes)\n        // https://www.w3.org/TR/html51/syntax.html#comment-start-dash-state\n        function stateCommentStartDash(char) {\n            if (char === '-') {\n                // We've read '<!----' (4 dashes) at this point\n                state = 18 /* CommentEnd */;\n            }\n            else if (char === '>') {\n                // At this point, we'll assume the comment wasn't a real comment\n                // so we'll just emit it as data. We basically read the sequence\n                // '<!--->'\n                resetToDataState();\n            }\n            else {\n                // Anything else, take it as a valid comment\n                state = 16 /* Comment */;\n            }\n        }\n        // Currently reading the comment's text (data)\n        // https://www.w3.org/TR/html51/syntax.html#comment-state\n        function stateComment(char) {\n            if (char === '-') {\n                state = 17 /* CommentEndDash */;\n            }\n        }\n        // When we we've read the first dash inside a comment, it may signal the\n        // end of the comment if we read another dash\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-dash-state\n        function stateCommentEndDash(char) {\n            if (char === '-') {\n                state = 18 /* CommentEnd */;\n            }\n            else {\n                // Wasn't a dash, must still be part of the comment\n                state = 16 /* Comment */;\n            }\n        }\n        // After we've read two dashes inside a comment, it may signal the end of\n        // the comment if we then read a '>' char\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-state\n        function stateCommentEnd(char) {\n            if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '!') {\n                state = 19 /* CommentEndBang */;\n            }\n            else if (char === '-') ;\n            else {\n                // Anything else, switch back to the comment state since we didn't\n                // read the full \"end comment\" sequence (i.e. '-->')\n                state = 16 /* Comment */;\n            }\n        }\n        // We've read the sequence '--!' inside of a comment\n        // https://www.w3.org/TR/html51/syntax.html#comment-end-bang-state\n        function stateCommentEndBang(char) {\n            if (char === '-') {\n                // We read the sequence '--!-' inside of a comment. The last dash\n                // could signify that the comment is going to close\n                state = 17 /* CommentEndDash */;\n            }\n            else if (char === '>') {\n                // End of comment with the sequence '--!>'\n                emitTagAndPreviousTextNode();\n            }\n            else {\n                // The '--!' was not followed by a '>', continue reading the\n                // comment's text\n                state = 16 /* Comment */;\n            }\n        }\n        /**\n         * For DOCTYPES in particular, we don't care about the attributes. Just\n         * advance to the '>' character and emit the tag, unless we find a '<'\n         * character in which case we'll start a new tag.\n         *\n         * Example doctype tag:\n         *    <!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http-colon-slashslash www.w3.org/TR/html4/strict.dtd\">\n         *\n         * Actual spec: https-colon-slashslash www.w3.org/TR/html51/syntax.html#doctype-state\n         */\n        function stateDoctype(char) {\n            if (char === '>') {\n                emitTagAndPreviousTextNode();\n            }\n            else if (char === '<') {\n                startNewTag();\n            }\n        }\n        /**\n         * Resets the state back to the Data state, and removes the current tag.\n         *\n         * We'll generally run this function whenever a \"parse error\" is\n         * encountered, where the current tag that is being read no longer looks\n         * like a real HTML tag.\n         */\n        function resetToDataState() {\n            state = 0 /* Data */;\n            currentTag = noCurrentTag;\n        }\n        /**\n         * Starts a new HTML tag at the current index, ignoring any previous HTML\n         * tag that was being read.\n         *\n         * We'll generally run this function whenever we read a new '<' character,\n         * including when we read a '<' character inside of an HTML tag that we were\n         * previously reading.\n         */\n        function startNewTag() {\n            state = 1 /* TagOpen */;\n            currentTag = new CurrentTag({ idx: charIdx });\n        }\n        /**\n         * Once we've decided to emit an open tag, that means we can also emit the\n         * text node before it.\n         */\n        function emitTagAndPreviousTextNode() {\n            var textBeforeTag = html.slice(currentDataIdx, currentTag.idx);\n            if (textBeforeTag) {\n                // the html tag was the first element in the html string, or two\n                // tags next to each other, in which case we should not emit a text\n                // node\n                onText(textBeforeTag, currentDataIdx);\n            }\n            if (currentTag.type === 'comment') {\n                onComment(currentTag.idx);\n            }\n            else if (currentTag.type === 'doctype') {\n                onDoctype(currentTag.idx);\n            }\n            else {\n                if (currentTag.isOpening) {\n                    onOpenTag(currentTag.name, currentTag.idx);\n                }\n                if (currentTag.isClosing) { // note: self-closing tags will emit both opening and closing\n                    onCloseTag(currentTag.name, currentTag.idx);\n                }\n            }\n            // Since we just emitted a tag, reset to the data state for the next char\n            resetToDataState();\n            currentDataIdx = charIdx + 1;\n        }\n        function emitText() {\n            var text = html.slice(currentDataIdx, charIdx);\n            onText(text, currentDataIdx);\n            currentDataIdx = charIdx + 1;\n        }\n        /**\n         * Captures the tag name from the start of the tag to the current character\n         * index, and converts it to lower case\n         */\n        function captureTagName() {\n            var startIdx = currentTag.idx + (currentTag.isClosing ? 2 : 1);\n            return html.slice(startIdx, charIdx).toLowerCase();\n        }\n        /**\n         * Causes the main loop to re-consume the current character, such as after\n         * encountering a \"parse error\" that changed state and needs to reconsume\n         * the same character in that new state.\n         */\n        function reconsumeCurrentCharacter() {\n            charIdx--;\n        }\n    }\n    var CurrentTag = /** @class */ (function () {\n        function CurrentTag(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            this.idx = cfg.idx !== undefined ? cfg.idx : -1;\n            this.type = cfg.type || 'tag';\n            this.name = cfg.name || '';\n            this.isOpening = !!cfg.isOpening;\n            this.isClosing = !!cfg.isClosing;\n        }\n        return CurrentTag;\n    }());\n\n    /**\n     * @class Autolinker\n     * @extends Object\n     *\n     * Utility class used to process a given string of text, and wrap the matches in\n     * the appropriate anchor (&lt;a&gt;) tags to turn them into links.\n     *\n     * Any of the configuration options may be provided in an Object provided\n     * to the Autolinker constructor, which will configure how the {@link #link link()}\n     * method will process the links.\n     *\n     * For example:\n     *\n     *     var autolinker = new Autolinker( {\n     *         newWindow : false,\n     *         truncate  : 30\n     *     } );\n     *\n     *     var html = autolinker.link( \"Joe went to www.yahoo.com\" );\n     *     // produces: 'Joe went to <a href=\"http-colon-slashslash www.yahoo.com\">yahoo.com</a>'\n     *\n     *\n     * The {@link #static-link static link()} method may also be used to inline\n     * options into a single call, which may be more convenient for one-off uses.\n     * For example:\n     *\n     *     var html = Autolinker.link( \"Joe went to www.yahoo.com\", {\n     *         newWindow : false,\n     *         truncate  : 30\n     *     } );\n     *     // produces: 'Joe went to <a href=\"http-colon-slashslash www.yahoo.com\">yahoo.com</a>'\n     *\n     *\n     * ## Custom Replacements of Links\n     *\n     * If the configuration options do not provide enough flexibility, a {@link #replaceFn}\n     * may be provided to fully customize the output of Autolinker. This function is\n     * called once for each URL/Email/Phone#/Hashtag/Mention (Twitter, Instagram, Soundcloud)\n     * match that is encountered.\n     *\n     * For example:\n     *\n     *     var input = \"...\";  // string with URLs, Email Addresses, Phone #s, Hashtags, and Mentions (Twitter, Instagram, Soundcloud)\n     *\n     *     var linkedText = Autolinker.link( input, {\n     *         replaceFn : function( match ) {\n     *             console.log( \"href = \", match.getAnchorHref() );\n     *             console.log( \"text = \", match.getAnchorText() );\n     *\n     *             switch( match.getType() ) {\n     *                 case 'url' :\n     *                     console.log( \"url: \", match.getUrl() );\n     *\n     *                     if( match.getUrl().indexOf( 'mysite.com' ) === -1 ) {\n     *                         var tag = match.buildTag();  // returns an `Autolinker.HtmlTag` instance, which provides mutator methods for easy changes\n     *                         tag.setAttr( 'rel', 'nofollow' );\n     *                         tag.addClass( 'external-link' );\n     *\n     *                         return tag;\n     *\n     *                     } else {\n     *                         return true;  // let Autolinker perform its normal anchor tag replacement\n     *                     }\n     *\n     *                 case 'email' :\n     *                     var email = match.getEmail();\n     *                     console.log( \"email: \", email );\n     *\n     *                     if( email === \"my@own.address\" ) {\n     *                         return false;  // don't auto-link this particular email address; leave as-is\n     *                     } else {\n     *                         return;  // no return value will have Autolinker perform its normal anchor tag replacement (same as returning `true`)\n     *                     }\n     *\n     *                 case 'phone' :\n     *                     var phoneNumber = match.getPhoneNumber();\n     *                     console.log( phoneNumber );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.phone.numbers.to/\">' + phoneNumber + '</a>';\n     *\n     *                 case 'hashtag' :\n     *                     var hashtag = match.getHashtag();\n     *                     console.log( hashtag );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.hashtag.handles.to/\">' + hashtag + '</a>';\n     *\n     *                 case 'mention' :\n     *                     var mention = match.getMention();\n     *                     console.log( mention );\n     *\n     *                     return '<a href=\"http-colon-slashslash newplace.to.link.mention.to/\">' + mention + '</a>';\n     *             }\n     *         }\n     *     } );\n     *\n     *\n     * The function may return the following values:\n     *\n     * - `true` (Boolean): Allow Autolinker to replace the match as it normally\n     *   would.\n     * - `false` (Boolean): Do not replace the current match at all - leave as-is.\n     * - Any String: If a string is returned from the function, the string will be\n     *   used directly as the replacement HTML for the match.\n     * - An {@link Autolinker.HtmlTag} instance, which can be used to build/modify\n     *   an HTML tag before writing out its HTML text.\n     */\n    var Autolinker = /** @class */ (function () {\n        /**\n         * @method constructor\n         * @param {Object} [cfg] The configuration options for the Autolinker instance,\n         *   specified in an Object (map).\n         */\n        function Autolinker(cfg) {\n            if (cfg === void 0) { cfg = {}; }\n            /**\n             * The Autolinker version number exposed on the instance itself.\n             *\n             * Ex: 0.25.1\n             */\n            this.version = Autolinker.version;\n            /**\n             * @cfg {Boolean/Object} [urls]\n             *\n             * `true` if URLs should be automatically linked, `false` if they should not\n             * be. Defaults to `true`.\n             *\n             * Examples:\n             *\n             *     urls: true\n             *\n             *     // or\n             *\n             *     urls: {\n             *         schemeMatches : true,\n             *         wwwMatches    : true,\n             *         tldMatches    : true\n             *     }\n             *\n             * As shown above, this option also accepts an Object form with 3 properties\n             * to allow for more customization of what exactly gets linked. All default\n             * to `true`:\n             *\n             * @cfg {Boolean} [urls.schemeMatches] `true` to match URLs found prefixed\n             *   with a scheme, i.e. `http-colon-slashslash google.com`, or `other+scheme://google.com`,\n             *   `false` to prevent these types of matches.\n             * @cfg {Boolean} [urls.wwwMatches] `true` to match urls found prefixed with\n             *   `'www.'`, i.e. `www.google.com`. `false` to prevent these types of\n             *   matches. Note that if the URL had a prefixed scheme, and\n             *   `schemeMatches` is true, it will still be linked.\n             * @cfg {Boolean} [urls.tldMatches] `true` to match URLs with known top\n             *   level domains (.com, .net, etc.) that are not prefixed with a scheme or\n             *   `'www.'`. This option attempts to match anything that looks like a URL\n             *   in the given text. Ex: `google.com`, `asdf.org/?page=1`, etc. `false`\n             *   to prevent these types of matches.\n             */\n            this.urls = {}; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [email=true]\n             *\n             * `true` if email addresses should be automatically linked, `false` if they\n             * should not be.\n             */\n            this.email = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [phone=true]\n             *\n             * `true` if Phone numbers (\"(555)555-5555\") should be automatically linked,\n             * `false` if they should not be.\n             */\n            this.phone = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean/String} [hashtag=false]\n             *\n             * A string for the service name to have hashtags (ex: \"#myHashtag\")\n             * auto-linked to. The currently-supported values are:\n             *\n             * - 'twitter'\n             * - 'facebook'\n             * - 'instagram'\n             *\n             * Pass `false` to skip auto-linking of hashtags.\n             */\n            this.hashtag = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String/Boolean} [mention=false]\n             *\n             * A string for the service name to have mentions (ex: \"@myuser\")\n             * auto-linked to. The currently supported values are:\n             *\n             * - 'twitter'\n             * - 'instagram'\n             * - 'soundcloud'\n             *\n             * Defaults to `false` to skip auto-linking of mentions.\n             */\n            this.mention = false; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [newWindow=true]\n             *\n             * `true` if the links should open in a new window, `false` otherwise.\n             */\n            this.newWindow = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean/Object} [stripPrefix=true]\n             *\n             * `true` if 'http-colon-slashslash ' (or 'https-colon-slashslash ') and/or the 'www.' should be stripped\n             * from the beginning of URL links' text, `false` otherwise. Defaults to\n             * `true`.\n             *\n             * Examples:\n             *\n             *     stripPrefix: true\n             *\n             *     // or\n             *\n             *     stripPrefix: {\n             *         scheme : true,\n             *         www    : true\n             *     }\n             *\n             * As shown above, this option also accepts an Object form with 2 properties\n             * to allow for more customization of what exactly is prevented from being\n             * displayed. Both default to `true`:\n             *\n             * @cfg {Boolean} [stripPrefix.scheme] `true` to prevent the scheme part of\n             *   a URL match from being displayed to the user. Example:\n             *   `'http-colon-slashslash google.com'` will be displayed as `'google.com'`. `false` to\n             *   not strip the scheme. NOTE: Only an `'http-colon-slashslash '` or `'https-colon-slashslash '` scheme\n             *   will be removed, so as not to remove a potentially dangerous scheme\n             *   (such as `'file://'` or `'javascript:'`)\n             * @cfg {Boolean} [stripPrefix.www] www (Boolean): `true` to prevent the\n             *   `'www.'` part of a URL match from being displayed to the user. Ex:\n             *   `'www.google.com'` will be displayed as `'google.com'`. `false` to not\n             *   strip the `'www'`.\n             */\n            this.stripPrefix = { scheme: true, www: true }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [stripTrailingSlash=true]\n             *\n             * `true` to remove the trailing slash from URL matches, `false` to keep\n             *  the trailing slash.\n             *\n             *  Example when `true`: `http-colon-slashslash google.com/` will be displayed as\n             *  `http-colon-slashslash google.com`.\n             */\n            this.stripTrailingSlash = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Boolean} [decodePercentEncoding=true]\n             *\n             * `true` to decode percent-encoded characters in URL matches, `false` to keep\n             *  the percent-encoded characters.\n             *\n             *  Example when `true`: `https-colon-slashslash en.wikipedia.org/wiki/San_Jos%C3%A9` will\n             *  be displayed as `https-colon-slashslash en.wikipedia.org/wiki/San_Jos`.\n             */\n            this.decodePercentEncoding = true; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Number/Object} [truncate=0]\n             *\n             * ## Number Form\n             *\n             * A number for how many characters matched text should be truncated to\n             * inside the text of a link. If the matched text is over this number of\n             * characters, it will be truncated to this length by adding a two period\n             * ellipsis ('..') to the end of the string.\n             *\n             * For example: A url like 'http-colon-slashslash www.yahoo.com/some/long/path/to/a/file'\n             * truncated to 25 characters might look something like this:\n             * 'yahoo.com/some/long/pat..'\n             *\n             * Example Usage:\n             *\n             *     truncate: 25\n             *\n             *\n             *  Defaults to `0` for \"no truncation.\"\n             *\n             *\n             * ## Object Form\n             *\n             * An Object may also be provided with two properties: `length` (Number) and\n             * `location` (String). `location` may be one of the following: 'end'\n             * (default), 'middle', or 'smart'.\n             *\n             * Example Usage:\n             *\n             *     truncate: { length: 25, location: 'middle' }\n             *\n             * @cfg {Number} [truncate.length=0] How many characters to allow before\n             *   truncation will occur. Defaults to `0` for \"no truncation.\"\n             * @cfg {\"end\"/\"middle\"/\"smart\"} [truncate.location=\"end\"]\n             *\n             * - 'end' (default): will truncate up to the number of characters, and then\n             *   add an ellipsis at the end. Ex: 'yahoo.com/some/long/pat..'\n             * - 'middle': will truncate and add the ellipsis in the middle. Ex:\n             *   'yahoo.com/s..th/to/a/file'\n             * - 'smart': for URLs where the algorithm attempts to strip out unnecessary\n             *   parts first (such as the 'www.', then URL scheme, hash, etc.),\n             *   attempting to make the URL human-readable before looking for a good\n             *   point to insert the ellipsis if it is still too long. Ex:\n             *   'yahoo.com/some..to/a/file'. For more details, see\n             *   {@link Autolinker.truncate.TruncateSmart}.\n             */\n            this.truncate = { length: 0, location: 'end' }; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {String} className\n             *\n             * A CSS class name to add to the generated links. This class will be added\n             * to all links, as well as this class plus match suffixes for styling\n             * url/email/phone/hashtag/mention links differently.\n             *\n             * For example, if this config is provided as \"myLink\", then:\n             *\n             * - URL links will have the CSS classes: \"myLink myLink-url\"\n             * - Email links will have the CSS classes: \"myLink myLink-email\", and\n             * - Phone links will have the CSS classes: \"myLink myLink-phone\"\n             * - Hashtag links will have the CSS classes: \"myLink myLink-hashtag\"\n             * - Mention links will have the CSS classes: \"myLink myLink-mention myLink-[type]\"\n             *   where [type] is either \"instagram\", \"twitter\" or \"soundcloud\"\n             */\n            this.className = ''; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Function} replaceFn\n             *\n             * A function to individually process each match found in the input string.\n             *\n             * See the class's description for usage.\n             *\n             * The `replaceFn` can be called with a different context object (`this`\n             * reference) using the {@link #context} cfg.\n             *\n             * This function is called with the following parameter:\n             *\n             * @cfg {Autolinker.match.Match} replaceFn.match The Match instance which\n             *   can be used to retrieve information about the match that the `replaceFn`\n             *   is currently processing. See {@link Autolinker.match.Match} subclasses\n             *   for details.\n             */\n            this.replaceFn = null; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @cfg {Object} context\n             *\n             * The context object (`this` reference) to call the `replaceFn` with.\n             *\n             * Defaults to this Autolinker instance.\n             */\n            this.context = undefined; // default value just to get the above doc comment in the ES5 output and documentation generator\n            /**\n             * @private\n             * @property {Autolinker.matcher.Matcher[]} matchers\n             *\n             * The {@link Autolinker.matcher.Matcher} instances for this Autolinker\n             * instance.\n             *\n             * This is lazily created in {@link #getMatchers}.\n             */\n            this.matchers = null;\n            /**\n             * @private\n             * @property {Autolinker.AnchorTagBuilder} tagBuilder\n             *\n             * The AnchorTagBuilder instance used to build match replacement anchor tags.\n             * Note: this is lazily instantiated in the {@link #getTagBuilder} method.\n             */\n            this.tagBuilder = null;\n            // Note: when `this.something` is used in the rhs of these assignments,\n            //       it refers to the default values set above the constructor\n            this.urls = this.normalizeUrlsCfg(cfg.urls);\n            this.email = typeof cfg.email === 'boolean' ? cfg.email : this.email;\n            this.phone = typeof cfg.phone === 'boolean' ? cfg.phone : this.phone;\n            this.hashtag = cfg.hashtag || this.hashtag;\n            this.mention = cfg.mention || this.mention;\n            this.newWindow = typeof cfg.newWindow === 'boolean' ? cfg.newWindow : this.newWindow;\n            this.stripPrefix = this.normalizeStripPrefixCfg(cfg.stripPrefix);\n            this.stripTrailingSlash = typeof cfg.stripTrailingSlash === 'boolean' ? cfg.stripTrailingSlash : this.stripTrailingSlash;\n            this.decodePercentEncoding = typeof cfg.decodePercentEncoding === 'boolean' ? cfg.decodePercentEncoding : this.decodePercentEncoding;\n            // Validate the value of the `mention` cfg\n            var mention = this.mention;\n            if (mention !== false && mention !== 'twitter' && mention !== 'instagram' && mention !== 'soundcloud') {\n                throw new Error(\"invalid `mention` cfg - see docs\");\n            }\n            // Validate the value of the `hashtag` cfg\n            var hashtag = this.hashtag;\n            if (hashtag !== false && hashtag !== 'twitter' && hashtag !== 'facebook' && hashtag !== 'instagram') {\n                throw new Error(\"invalid `hashtag` cfg - see docs\");\n            }\n            this.truncate = this.normalizeTruncateCfg(cfg.truncate);\n            this.className = cfg.className || this.className;\n            this.replaceFn = cfg.replaceFn || this.replaceFn;\n            this.context = cfg.context || this;\n        }\n        /**\n         * Automatically links URLs, Email addresses, Phone Numbers, Twitter handles,\n         * Hashtags, and Mentions found in the given chunk of HTML. Does not link URLs\n         * found within HTML tags.\n         *\n         * For instance, if given the text: `You should go to http-colon-slashslash www.yahoo.com`,\n         * then the result will be `You should go to &lt;a href=\"http-colon-slashslash www.yahoo.com\"&gt;http-colon-slashslash www.yahoo.com&lt;/a&gt;`\n         *\n         * Example:\n         *\n         *     var linkedText = Autolinker.link( \"Go to google.com\", { newWindow: false } );\n         *     // Produces: \"Go to <a href=\"http-colon-slashslash google.com\">google.com</a>\"\n         *\n         * @static\n         * @param {String} textOrHtml The HTML or text to find matches within (depending\n         *   on if the {@link #urls}, {@link #email}, {@link #phone}, {@link #mention},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @param {Object} [options] Any of the configuration options for the Autolinker\n         *   class, specified in an Object (map). See the class description for an\n         *   example call.\n         * @return {String} The HTML text, with matches automatically linked.\n         */\n        Autolinker.link = function (textOrHtml, options) {\n            var autolinker = new Autolinker(options);\n            return autolinker.link(textOrHtml);\n        };\n        /**\n         * Parses the input `textOrHtml` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches (without making any replacements).\n         *\n         * Note that if parsing multiple pieces of text, it is slightly more efficient\n         * to create an Autolinker instance, and use the instance-level {@link #parse}\n         * method.\n         *\n         * Example:\n         *\n         *     var matches = Autolinker.parse( \"Hello google.com, I am asdf@asdf.com\", {\n         *         urls: true,\n         *         email: true\n         *     } );\n         *\n         *     console.log( matches.length );           // 2\n         *     console.log( matches[ 0 ].getType() );   // 'url'\n         *     console.log( matches[ 0 ].getUrl() );    // 'google.com'\n         *     console.log( matches[ 1 ].getType() );   // 'email'\n         *     console.log( matches[ 1 ].getEmail() );  // 'asdf@asdf.com'\n         *\n         * @static\n         * @param {String} textOrHtml The HTML or text to find matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @param {Object} [options] Any of the configuration options for the Autolinker\n         *   class, specified in an Object (map). See the class description for an\n         *   example call.\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `textOrHtml`.\n         */\n        Autolinker.parse = function (textOrHtml, options) {\n            var autolinker = new Autolinker(options);\n            return autolinker.parse(textOrHtml);\n        };\n        /**\n         * Normalizes the {@link #urls} config into an Object with 3 properties:\n         * `schemeMatches`, `wwwMatches`, and `tldMatches`, all Booleans.\n         *\n         * See {@link #urls} config for details.\n         *\n         * @private\n         * @param {Boolean/Object} urls\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeUrlsCfg = function (urls) {\n            if (urls == null)\n                urls = true; // default to `true`\n            if (typeof urls === 'boolean') {\n                return { schemeMatches: urls, wwwMatches: urls, tldMatches: urls };\n            }\n            else { // object form\n                return {\n                    schemeMatches: typeof urls.schemeMatches === 'boolean' ? urls.schemeMatches : true,\n                    wwwMatches: typeof urls.wwwMatches === 'boolean' ? urls.wwwMatches : true,\n                    tldMatches: typeof urls.tldMatches === 'boolean' ? urls.tldMatches : true\n                };\n            }\n        };\n        /**\n         * Normalizes the {@link #stripPrefix} config into an Object with 2\n         * properties: `scheme`, and `www` - both Booleans.\n         *\n         * See {@link #stripPrefix} config for details.\n         *\n         * @private\n         * @param {Boolean/Object} stripPrefix\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeStripPrefixCfg = function (stripPrefix) {\n            if (stripPrefix == null)\n                stripPrefix = true; // default to `true`\n            if (typeof stripPrefix === 'boolean') {\n                return { scheme: stripPrefix, www: stripPrefix };\n            }\n            else { // object form\n                return {\n                    scheme: typeof stripPrefix.scheme === 'boolean' ? stripPrefix.scheme : true,\n                    www: typeof stripPrefix.www === 'boolean' ? stripPrefix.www : true\n                };\n            }\n        };\n        /**\n         * Normalizes the {@link #truncate} config into an Object with 2 properties:\n         * `length` (Number), and `location` (String).\n         *\n         * See {@link #truncate} config for details.\n         *\n         * @private\n         * @param {Number/Object} truncate\n         * @return {Object}\n         */\n        Autolinker.prototype.normalizeTruncateCfg = function (truncate) {\n            if (typeof truncate === 'number') {\n                return { length: truncate, location: 'end' };\n            }\n            else { // object, or undefined/null\n                return defaults(truncate || {}, {\n                    length: Number.POSITIVE_INFINITY,\n                    location: 'end'\n                });\n            }\n        };\n        /**\n         * Parses the input `textOrHtml` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches (without making any replacements).\n         *\n         * This method is used by the {@link #link} method, but can also be used to\n         * simply do parsing of the input in order to discover what kinds of links\n         * there are and how many.\n         *\n         * Example usage:\n         *\n         *     var autolinker = new Autolinker( {\n         *         urls: true,\n         *         email: true\n         *     } );\n         *\n         *     var matches = autolinker.parse( \"Hello google.com, I am asdf@asdf.com\" );\n         *\n         *     console.log( matches.length );           // 2\n         *     console.log( matches[ 0 ].getType() );   // 'url'\n         *     console.log( matches[ 0 ].getUrl() );    // 'google.com'\n         *     console.log( matches[ 1 ].getType() );   // 'email'\n         *     console.log( matches[ 1 ].getEmail() );  // 'asdf@asdf.com'\n         *\n         * @param {String} textOrHtml The HTML or text to find matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled).\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `textOrHtml`.\n         */\n        Autolinker.prototype.parse = function (textOrHtml) {\n            var _this = this;\n            var skipTagNames = ['a', 'style', 'script'], skipTagsStackCount = 0, // used to only Autolink text outside of anchor/script/style tags. We don't want to autolink something that is already linked inside of an <a> tag, for instance\n            matches = [];\n            // Find all matches within the `textOrHtml` (but not matches that are\n            // already nested within <a>, <style> and <script> tags)\n            parseHtml(textOrHtml, {\n                onOpenTag: function (tagName) {\n                    if (skipTagNames.indexOf(tagName) >= 0) {\n                        skipTagsStackCount++;\n                    }\n                },\n                onText: function (text, offset) {\n                    // Only process text nodes that are not within an <a>, <style> or <script> tag\n                    if (skipTagsStackCount === 0) {\n                        // \"Walk around\" common HTML entities. An '&nbsp;' (for example)\n                        // could be at the end of a URL, but we don't want to\n                        // include the trailing '&' in the URL. See issue #76\n                        // TODO: Handle HTML entities separately in parseHtml() and\n                        // don't emit them as \"text\" except for &amp; entities\n                        var htmlCharacterEntitiesRegex = /(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi;\n                        var textSplit = splitAndCapture(text, htmlCharacterEntitiesRegex);\n                        var currentOffset_1 = offset;\n                        textSplit.forEach(function (splitText, i) {\n                            // even number matches are text, odd numbers are html entities\n                            if (i % 2 === 0) {\n                                var textNodeMatches = _this.parseText(splitText, currentOffset_1);\n                                matches.push.apply(matches, textNodeMatches);\n                            }\n                            currentOffset_1 += splitText.length;\n                        });\n                    }\n                },\n                onCloseTag: function (tagName) {\n                    if (skipTagNames.indexOf(tagName) >= 0) {\n                        skipTagsStackCount = Math.max(skipTagsStackCount - 1, 0); // attempt to handle extraneous </a> tags by making sure the stack count never goes below 0\n                    }\n                },\n                onComment: function (offset) { },\n                onDoctype: function (offset) { },\n            });\n            // After we have found all matches, remove subsequent matches that\n            // overlap with a previous match. This can happen for instance with URLs,\n            // where the url 'google.com/#link' would match '#link' as a hashtag.\n            matches = this.compactMatches(matches);\n            // And finally, remove matches for match types that have been turned\n            // off. We needed to have all match types turned on initially so that\n            // things like hashtags could be filtered out if they were really just\n            // part of a URL match (for instance, as a named anchor).\n            matches = this.removeUnwantedMatches(matches);\n            return matches;\n        };\n        /**\n         * After we have found all matches, we need to remove matches that overlap\n         * with a previous match. This can happen for instance with URLs, where the\n         * url 'google.com/#link' would match '#link' as a hashtag. Because the\n         * '#link' part is contained in a larger match that comes before the HashTag\n         * match, we'll remove the HashTag match.\n         *\n         * @private\n         * @param {Autolinker.match.Match[]} matches\n         * @return {Autolinker.match.Match[]}\n         */\n        Autolinker.prototype.compactMatches = function (matches) {\n            // First, the matches need to be sorted in order of offset\n            matches.sort(function (a, b) { return a.getOffset() - b.getOffset(); });\n            for (var i = 0; i < matches.length - 1; i++) {\n                var match = matches[i], offset = match.getOffset(), matchedTextLength = match.getMatchedText().length, endIdx = offset + matchedTextLength;\n                if (i + 1 < matches.length) {\n                    // Remove subsequent matches that equal offset with current match\n                    if (matches[i + 1].getOffset() === offset) {\n                        var removeIdx = matches[i + 1].getMatchedText().length > matchedTextLength ? i : i + 1;\n                        matches.splice(removeIdx, 1);\n                        continue;\n                    }\n                    // Remove subsequent matches that overlap with the current match\n                    if (matches[i + 1].getOffset() < endIdx) {\n                        matches.splice(i + 1, 1);\n                    }\n                }\n            }\n            return matches;\n        };\n        /**\n         * Removes matches for matchers that were turned off in the options. For\n         * example, if {@link #hashtag hashtags} were not to be matched, we'll\n         * remove them from the `matches` array here.\n         *\n         * Note: we *must* use all Matchers on the input string, and then filter\n         * them out later. For example, if the options were `{ url: false, hashtag: true }`,\n         * we wouldn't want to match the text '#link' as a HashTag inside of the text\n         * 'google.com/#link'. The way the algorithm works is that we match the full\n         * URL first (which prevents the accidental HashTag match), and then we'll\n         * simply throw away the URL match.\n         *\n         * @private\n         * @param {Autolinker.match.Match[]} matches The array of matches to remove\n         *   the unwanted matches from. Note: this array is mutated for the\n         *   removals.\n         * @return {Autolinker.match.Match[]} The mutated input `matches` array.\n         */\n        Autolinker.prototype.removeUnwantedMatches = function (matches) {\n            if (!this.hashtag)\n                remove(matches, function (match) { return match.getType() === 'hashtag'; });\n            if (!this.email)\n                remove(matches, function (match) { return match.getType() === 'email'; });\n            if (!this.phone)\n                remove(matches, function (match) { return match.getType() === 'phone'; });\n            if (!this.mention)\n                remove(matches, function (match) { return match.getType() === 'mention'; });\n            if (!this.urls.schemeMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'scheme'; });\n            }\n            if (!this.urls.wwwMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'www'; });\n            }\n            if (!this.urls.tldMatches) {\n                remove(matches, function (m) { return m.getType() === 'url' && m.getUrlMatchType() === 'tld'; });\n            }\n            return matches;\n        };\n        /**\n         * Parses the input `text` looking for URLs, email addresses, phone\n         * numbers, username handles, and hashtags (depending on the configuration\n         * of the Autolinker instance), and returns an array of {@link Autolinker.match.Match}\n         * objects describing those matches.\n         *\n         * This method processes a **non-HTML string**, and is used to parse and\n         * match within the text nodes of an HTML string. This method is used\n         * internally by {@link #parse}.\n         *\n         * @private\n         * @param {String} text The text to find matches within (depending on if the\n         *   {@link #urls}, {@link #email}, {@link #phone},\n         *   {@link #hashtag}, and {@link #mention} options are enabled). This must be a non-HTML string.\n         * @param {Number} [offset=0] The offset of the text node within the\n         *   original string. This is used when parsing with the {@link #parse}\n         *   method to generate correct offsets within the {@link Autolinker.match.Match}\n         *   instances, but may be omitted if calling this method publicly.\n         * @return {Autolinker.match.Match[]} The array of Matches found in the\n         *   given input `text`.\n         */\n        Autolinker.prototype.parseText = function (text, offset) {\n            if (offset === void 0) { offset = 0; }\n            offset = offset || 0;\n            var matchers = this.getMatchers(), matches = [];\n            for (var i = 0, numMatchers = matchers.length; i < numMatchers; i++) {\n                var textMatches = matchers[i].parseMatches(text);\n                // Correct the offset of each of the matches. They are originally\n                // the offset of the match within the provided text node, but we\n                // need to correct them to be relative to the original HTML input\n                // string (i.e. the one provided to #parse).\n                for (var j = 0, numTextMatches = textMatches.length; j < numTextMatches; j++) {\n                    textMatches[j].setOffset(offset + textMatches[j].getOffset());\n                }\n                matches.push.apply(matches, textMatches);\n            }\n            return matches;\n        };\n        /**\n         * Automatically links URLs, Email addresses, Phone numbers, Hashtags,\n         * and Mentions (Twitter, Instagram, Soundcloud) found in the given chunk of HTML. Does not link\n         * URLs found within HTML tags.\n         *\n         * For instance, if given the text: `You should go to http-colon-slashslash www.yahoo.com`,\n         * then the result will be `You should go to\n         * &lt;a href=\"http-colon-slashslash www.yahoo.com\"&gt;http-colon-slashslash www.yahoo.com&lt;/a&gt;`\n         *\n         * This method finds the text around any HTML elements in the input\n         * `textOrHtml`, which will be the text that is processed. Any original HTML\n         * elements will be left as-is, as well as the text that is already wrapped\n         * in anchor (&lt;a&gt;) tags.\n         *\n         * @param {String} textOrHtml The HTML or text to autolink matches within\n         *   (depending on if the {@link #urls}, {@link #email}, {@link #phone}, {@link #hashtag}, and {@link #mention} options are enabled).\n         * @return {String} The HTML, with matches automatically linked.\n         */\n        Autolinker.prototype.link = function (textOrHtml) {\n            if (!textOrHtml) {\n                return \"\";\n            } // handle `null` and `undefined`\n            var matches = this.parse(textOrHtml), newHtml = [], lastIndex = 0;\n            for (var i = 0, len = matches.length; i < len; i++) {\n                var match = matches[i];\n                newHtml.push(textOrHtml.substring(lastIndex, match.getOffset()));\n                newHtml.push(this.createMatchReturnVal(match));\n                lastIndex = match.getOffset() + match.getMatchedText().length;\n            }\n            newHtml.push(textOrHtml.substring(lastIndex)); // handle the text after the last match\n            return newHtml.join('');\n        };\n        /**\n         * Creates the return string value for a given match in the input string.\n         *\n         * This method handles the {@link #replaceFn}, if one was provided.\n         *\n         * @private\n         * @param {Autolinker.match.Match} match The Match object that represents\n         *   the match.\n         * @return {String} The string that the `match` should be replaced with.\n         *   This is usually the anchor tag string, but may be the `matchStr` itself\n         *   if the match is not to be replaced.\n         */\n        Autolinker.prototype.createMatchReturnVal = function (match) {\n            // Handle a custom `replaceFn` being provided\n            var replaceFnResult;\n            if (this.replaceFn) {\n                replaceFnResult = this.replaceFn.call(this.context, match); // Autolinker instance is the context\n            }\n            if (typeof replaceFnResult === 'string') {\n                return replaceFnResult; // `replaceFn` returned a string, use that\n            }\n            else if (replaceFnResult === false) {\n                return match.getMatchedText(); // no replacement for the match\n            }\n            else if (replaceFnResult instanceof HtmlTag) {\n                return replaceFnResult.toAnchorString();\n            }\n            else { // replaceFnResult === true, or no/unknown return value from function\n                // Perform Autolinker's default anchor tag generation\n                var anchorTag = match.buildTag(); // returns an Autolinker.HtmlTag instance\n                return anchorTag.toAnchorString();\n            }\n        };\n        /**\n         * Lazily instantiates and returns the {@link Autolinker.matcher.Matcher}\n         * instances for this Autolinker instance.\n         *\n         * @private\n         * @return {Autolinker.matcher.Matcher[]}\n         */\n        Autolinker.prototype.getMatchers = function () {\n            if (!this.matchers) {\n                var tagBuilder = this.getTagBuilder();\n                var matchers = [\n                    new HashtagMatcher({ tagBuilder: tagBuilder, serviceName: this.hashtag }),\n                    new EmailMatcher({ tagBuilder: tagBuilder }),\n                    new PhoneMatcher({ tagBuilder: tagBuilder }),\n                    new MentionMatcher({ tagBuilder: tagBuilder, serviceName: this.mention }),\n                    new UrlMatcher({ tagBuilder: tagBuilder, stripPrefix: this.stripPrefix, stripTrailingSlash: this.stripTrailingSlash, decodePercentEncoding: this.decodePercentEncoding })\n                ];\n                return (this.matchers = matchers);\n            }\n            else {\n                return this.matchers;\n            }\n        };\n        /**\n         * Returns the {@link #tagBuilder} instance for this Autolinker instance,\n         * lazily instantiating it if it does not yet exist.\n         *\n         * @private\n         * @return {Autolinker.AnchorTagBuilder}\n         */\n        Autolinker.prototype.getTagBuilder = function () {\n            var tagBuilder = this.tagBuilder;\n            if (!tagBuilder) {\n                tagBuilder = this.tagBuilder = new AnchorTagBuilder({\n                    newWindow: this.newWindow,\n                    truncate: this.truncate,\n                    className: this.className\n                });\n            }\n            return tagBuilder;\n        };\n        /**\n         * @static\n         * @property {String} version\n         *\n         * The Autolinker version number in the form major.minor.patch\n         *\n         * Ex: 0.25.1\n         */\n        Autolinker.version = '3.11.0';\n        /**\n         * For backwards compatibility with Autolinker 1.x, the AnchorTagBuilder\n         * class is provided as a static on the Autolinker class.\n         */\n        Autolinker.AnchorTagBuilder = AnchorTagBuilder;\n        /**\n         * For backwards compatibility with Autolinker 1.x, the HtmlTag class is\n         * provided as a static on the Autolinker class.\n         */\n        Autolinker.HtmlTag = HtmlTag;\n        /**\n         * For backwards compatibility with Autolinker 1.x, the Matcher classes are\n         * provided as statics on the Autolinker class.\n         */\n        Autolinker.matcher = {\n            Email: EmailMatcher,\n            Hashtag: HashtagMatcher,\n            Matcher: Matcher,\n            Mention: MentionMatcher,\n            Phone: PhoneMatcher,\n            Url: UrlMatcher\n        };\n        /**\n         * For backwards compatibility with Autolinker 1.x, the Match classes are\n         * provided as statics on the Autolinker class.\n         */\n        Autolinker.match = {\n            Email: EmailMatch,\n            Hashtag: HashtagMatch,\n            Match: Match,\n            Mention: MentionMatch,\n            Phone: PhoneMatch,\n            Url: UrlMatch\n        };\n        return Autolinker;\n    }());\n\n    return Autolinker;\n\n}));\n\n\n//# sourceMappingURL=Autolinker.js.map\n\nexport default tmp.Autolinker;\n","    /**\n     * Representation of <Camera> from KML\n     * @alias KmlCamera\n     * @constructor\n     *\n     * @param {Cartesian3} position camera position\n     * @param {HeadingPitchRoll} headingPitchRoll camera orientation\n     */\n    function KmlCamera(position, headingPitchRoll) {\n        this.position = position;\n        this.headingPitchRoll = headingPitchRoll;\n    }\nexport default KmlCamera;\n","    /**\n     * @alias KmlLookAt\n     * @constructor\n     *\n     * @param {Cartesian3} position camera position\n     * @param {HeadingPitchRange} headingPitchRange camera orientation\n     */\n    function KmlLookAt(position, headingPitchRange) {\n        this.position = position;\n        this.headingPitchRange = headingPitchRange;\n    }\nexport default KmlLookAt;\n","import defined from '../Core/defined.js';\nimport Event from '../Core/Event.js';\n    /**\n     * @alias KmlTour\n     * @constructor\n     *\n     * @param {String} name name parsed from KML\n     * @param {String} id id parsed from KML\n     * @param {Array} playlist array with KMLTourFlyTos, KMLTourWaits and KMLTourSoundCues\n     */\n    function KmlTour(name, id) {\n        /**\n         * Id of kml gx:Tour entry\n         * @type String\n         */\n        this.id = id;\n        /**\n         * Tour name\n         * @type String\n         */\n        this.name = name;\n        /**\n         * Index of current entry from playlist\n         * @type Number\n         */\n        this.playlistIndex = 0;\n        /**\n         * Array of playlist entries\n         * @type Array\n         */\n        this.playlist = [];\n        /**\n         * Event will be called when tour starts to play,\n         * before any playlist entry starts to play.\n         * @type Event\n         */\n        this.tourStart = new Event();\n        /**\n         * Event will be called when all playlist entries are\n         * played, or tour playback being canceled.\n         *\n         * If tour playback was terminated, event callback will\n         * be called with terminated=true parameter.\n         * @type Event\n         */\n        this.tourEnd = new Event();\n        /**\n         * Event will be called when entry from playlist starts to play.\n         *\n         * Event callback will be called with curent entry as first parameter.\n         * @type Event\n         */\n        this.entryStart = new Event();\n        /**\n         * Event will be called when entry from playlist ends to play.\n         *\n         * Event callback will be called with following parameters:\n         * 1. entry - entry\n         * 2. terminated - true if playback was terminated by calling {@link KmlTour#stop}\n         * @type Event\n         */\n        this.entryEnd = new Event();\n\n        this._activeEntries = [];\n    }\n\n    /**\n     * Add entry to this tour playlist.\n     *\n     * @param {KmlTourFlyTo|KmlTourWait} entry an entry to add to the playlist.\n     */\n    KmlTour.prototype.addPlaylistEntry = function(entry) {\n        this.playlist.push(entry);\n    };\n\n    /**\n     * Play this tour.\n     *\n     * @param {Viewer} viewer viewer widget.\n     * @param {Object} [cameraOptions] these options will be merged with {@link Camera#flyTo}\n     * options for FlyTo playlist entries.\n     */\n    KmlTour.prototype.play = function(viewer, cameraOptions) {\n        this.tourStart.raiseEvent();\n\n        var tour = this;\n        playEntry.call(this, viewer, cameraOptions, function(terminated) {\n            tour.playlistIndex = 0;\n            // Stop nonblocking entries\n            if (!terminated) {\n                cancelAllEntries(tour._activeEntries);\n            }\n            tour.tourEnd.raiseEvent(terminated);\n        });\n    };\n\n    /**\n     * Stop curently playing tour.\n     */\n    KmlTour.prototype.stop = function() {\n        cancelAllEntries(this._activeEntries);\n    };\n\n    // Stop all activeEntries.\n    function cancelAllEntries(activeEntries) {\n        for(var entry = activeEntries.pop(); entry !== undefined; entry = activeEntries.pop()) {\n            entry.stop();\n        }\n    }\n\n    // Play playlist entry.\n    // This function is called recursevly with playNext and iterates over all entries from playlist.\n    function playEntry(viewer, cameraOptions, allDone) {\n        var entry = this.playlist[this.playlistIndex];\n        if (entry) {\n            var _playNext = playNext.bind(this, viewer, cameraOptions, allDone);\n            this._activeEntries.push(entry);\n            this.entryStart.raiseEvent(entry);\n            if (entry.blocking) {\n                entry.play(_playNext, viewer.scene.camera, cameraOptions);\n            }\n            else {\n                var tour = this;\n                entry.play(function() {\n                    tour.entryEnd.raiseEvent(entry);\n                    var indx = tour._activeEntries.indexOf(entry);\n                    if (indx >= 0) {\n                        tour._activeEntries.splice(indx, 1);\n                    }\n                });\n                _playNext(viewer, cameraOptions, allDone);\n            }\n        }\n        else if(defined(allDone)) {\n            allDone(false);\n        }\n    }\n\n    // Increment playlistIndex and call playEntry if terminated isn't true.\n    function playNext(viewer, cameraOptions, allDone, terminated) {\n        var entry = this.playlist[this.playlistIndex];\n        this.entryEnd.raiseEvent(entry, terminated);\n\n        if (terminated) {\n            allDone(terminated);\n        }\n        else {\n            var indx = this._activeEntries.indexOf(entry);\n            if (indx >= 0) {\n                this._activeEntries.splice(indx, 1);\n            }\n            this.playlistIndex++;\n            playEntry.call(this, viewer, cameraOptions, allDone);\n        }\n    }\nexport default KmlTour;\n","import BoundingSphere from '../Core/BoundingSphere.js';\nimport combine from '../Core/combine.js';\nimport defined from '../Core/defined.js';\nimport EasingFunction from '../Core/EasingFunction.js';\n    /**\n     * @alias KmlTourFlyTo\n     * @constructor\n     *\n     * @param {Number} duration entry duration\n     * @param {String} flyToMode KML fly to mode: bounce, smooth, etc\n     * @param {KmlCamera|KmlLookAt} view KmlCamera or KmlLookAt\n     */\n    function KmlTourFlyTo(duration, flyToMode, view) {\n        this.type = 'KmlTourFlyTo';\n        this.blocking = true;\n        this.activeCamera = null;\n        this.activeCallback = null;\n\n        this.duration = duration;\n        this.view = view;\n        this.flyToMode = flyToMode;\n    }\n\n    /**\n     * Play this playlist entry\n     *\n     * @param {KmlTourFlyTo~DoneCallback} done function which will be called when playback ends\n     * @param {Camera} camera Cesium camera\n     * @param {Object} [cameraOptions] which will be merged with camera flyTo options. See {@link Camera#flyTo}\n     */\n    KmlTourFlyTo.prototype.play = function(done, camera, cameraOptions) {\n        this.activeCamera = camera;\n        if (defined(done) && done !== null) {\n            var self = this;\n            this.activeCallback = function(terminated) {\n                delete self.activeCallback;\n                delete self.activeCamera;\n                done(defined(terminated) ? false : terminated);\n            };\n        }\n\n        var options = this.getCameraOptions(cameraOptions);\n        if (this.view.headingPitchRoll) {\n            camera.flyTo(options);\n        }\n        else if (this.view.headingPitchRange) {\n            var target = new BoundingSphere(this.view.position);\n            camera.flyToBoundingSphere(target, options);\n        }\n    };\n\n    /**\n     * Stop execution of curent entry. Cancel camera flyTo\n     */\n    KmlTourFlyTo.prototype.stop = function() {\n        if (defined(this.activeCamera)) {\n            this.activeCamera.cancelFlight();\n        }\n        if (defined(this.activeCallback)) {\n            this.activeCallback(true);\n        }\n    };\n\n    /**\n     * Returns options for {@link Camera#flyTo} or {@link Camera#flyToBoundingSphere}\n     * depends on this.view type.\n     *\n     * @param {Object} cameraOptions options to merge with generated. See {@link Camera#flyTo}\n     * @returns {Object} {@link Camera#flyTo} or {@link Camera#flyToBoundingSphere} options\n     */\n    KmlTourFlyTo.prototype.getCameraOptions = function(cameraOptions) {\n        var options = {\n            duration: this.duration\n        };\n\n        if (defined(this.activeCallback)) {\n            options.complete = this.activeCallback;\n        }\n\n        if (this.flyToMode === 'smooth' ) {\n            options.easingFunction = EasingFunction.LINEAR_NONE;\n        }\n\n        if (this.view.headingPitchRoll) {\n            options.destination = this.view.position;\n            options.orientation = this.view.headingPitchRoll;\n        }\n        else if (this.view.headingPitchRange) {\n            options.offset = this.view.headingPitchRange;\n        }\n\n        if (defined(cameraOptions)) {\n            options = combine(options, cameraOptions);\n        }\n        return options;\n    };\n\n    /**\n     * A function that will be executed when the flight completes.\n     * @callback KmlTourFlyTo~DoneCallback\n     *\n     * @param {Boolean} terminated true if {@link KmlTourFlyTo#stop} was\n     * called before entry done playback.\n     */\nexport default KmlTourFlyTo;\n","import defined from '../Core/defined.js';\n    /**\n     * @alias KmlTourWait\n     * @constructor\n     *\n     * @param {Number} duration entry duration\n     */\n    function KmlTourWait(duration) {\n        this.type = 'KmlTourWait';\n        this.blocking = true;\n        this.duration = duration;\n\n        this.timeout = null;\n    }\n\n    /**\n     * Play this playlist entry\n     *\n     * @param {KmlTourWait~DoneCallback} done function which will be called when playback ends\n     */\n    KmlTourWait.prototype.play = function(done) {\n        var self = this;\n        this.activeCallback = done;\n        this.timeout = setTimeout(function() {\n            delete self.activeCallback;\n            done(false);\n        }, this.duration * 1000);\n    };\n\n    /**\n     * Stop execution of curent entry, cancel curent timeout\n     */\n    KmlTourWait.prototype.stop = function() {\n        clearTimeout(this.timeout);\n        if (defined(this.activeCallback)) {\n            this.activeCallback(true);\n        }\n    };\n\n    /**\n     * A function which will be called when playback ends.\n     *\n     * @callback KmlTourWait~DoneCallback\n     * @param {Boolean} terminated true if {@link KmlTourWait#stop} was\n     * called before entry done playback.\n     */\nexport default KmlTourWait;\n","import ArcType from '../Core/ArcType.js';\nimport AssociativeArray from '../Core/AssociativeArray.js';\nimport BoundingRectangle from '../Core/BoundingRectangle.js';\nimport Cartesian2 from '../Core/Cartesian2.js';\nimport Cartesian3 from '../Core/Cartesian3.js';\nimport Cartographic from '../Core/Cartographic.js';\nimport ClockRange from '../Core/ClockRange.js';\nimport ClockStep from '../Core/ClockStep.js';\nimport clone from '../Core/clone.js';\nimport Color from '../Core/Color.js';\nimport createGuid from '../Core/createGuid.js';\nimport Credit from '../Core/Credit.js';\nimport defaultValue from '../Core/defaultValue.js';\nimport defined from '../Core/defined.js';\nimport defineProperties from '../Core/defineProperties.js';\nimport DeveloperError from '../Core/DeveloperError.js';\nimport Ellipsoid from '../Core/Ellipsoid.js';\nimport Event from '../Core/Event.js';\nimport getExtensionFromUri from '../Core/getExtensionFromUri.js';\nimport getFilenameFromUri from '../Core/getFilenameFromUri.js';\nimport getTimestamp from '../Core/getTimestamp.js';\nimport HeadingPitchRange from '../Core/HeadingPitchRange.js';\nimport HeadingPitchRoll from '../Core/HeadingPitchRoll.js';\nimport Iso8601 from '../Core/Iso8601.js';\nimport JulianDate from '../Core/JulianDate.js';\nimport CesiumMath from '../Core/Math.js';\nimport NearFarScalar from '../Core/NearFarScalar.js';\nimport objectToQuery from '../Core/objectToQuery.js';\nimport oneTimeWarning from '../Core/oneTimeWarning.js';\nimport PinBuilder from '../Core/PinBuilder.js';\nimport PolygonHierarchy from '../Core/PolygonHierarchy.js';\nimport queryToObject from '../Core/queryToObject.js';\nimport Rectangle from '../Core/Rectangle.js';\nimport Resource from '../Core/Resource.js';\nimport RuntimeError from '../Core/RuntimeError.js';\nimport TimeInterval from '../Core/TimeInterval.js';\nimport TimeIntervalCollection from '../Core/TimeIntervalCollection.js';\nimport HeightReference from '../Scene/HeightReference.js';\nimport HorizontalOrigin from '../Scene/HorizontalOrigin.js';\nimport LabelStyle from '../Scene/LabelStyle.js';\nimport SceneMode from '../Scene/SceneMode.js';\nimport Autolinker from '../ThirdParty/Autolinker.js';\nimport Uri from '../ThirdParty/Uri.js';\nimport when from '../ThirdParty/when.js';\nimport zip from '../ThirdParty/zip.js';\nimport BillboardGraphics from './BillboardGraphics.js';\nimport CompositePositionProperty from './CompositePositionProperty.js';\nimport DataSource from './DataSource.js';\nimport DataSourceClock from './DataSourceClock.js';\nimport Entity from './Entity.js';\nimport EntityCluster from './EntityCluster.js';\nimport EntityCollection from './EntityCollection.js';\nimport KmlCamera from './KmlCamera.js';\nimport KmlLookAt from './KmlLookAt.js';\nimport KmlTour from './KmlTour.js';\nimport KmlTourFlyTo from './KmlTourFlyTo.js';\nimport KmlTourWait from './KmlTourWait.js';\nimport LabelGraphics from './LabelGraphics.js';\nimport PathGraphics from './PathGraphics.js';\nimport PolygonGraphics from './PolygonGraphics.js';\nimport PolylineGraphics from './PolylineGraphics.js';\nimport PositionPropertyArray from './PositionPropertyArray.js';\nimport RectangleGraphics from './RectangleGraphics.js';\nimport ReferenceProperty from './ReferenceProperty.js';\nimport SampledPositionProperty from './SampledPositionProperty.js';\nimport ScaledPositionProperty from './ScaledPositionProperty.js';\nimport TimeIntervalCollectionProperty from './TimeIntervalCollectionProperty.js';\nimport WallGraphics from './WallGraphics.js';\n\n    //This is by no means an exhaustive list of MIME types.\n    //The purpose of this list is to be able to accurately identify content embedded\n    //in KMZ files. Eventually, we can make this configurable by the end user so they can add\n    //there own content types if they have KMZ files that require it.\n    var MimeTypes = {\n        avi : 'video/x-msvideo',\n        bmp : 'image/bmp',\n        bz2 : 'application/x-bzip2',\n        chm : 'application/vnd.ms-htmlhelp',\n        css : 'text/css',\n        csv : 'text/csv',\n        doc : 'application/msword',\n        dvi : 'application/x-dvi',\n        eps : 'application/postscript',\n        flv : 'video/x-flv',\n        gif : 'image/gif',\n        gz : 'application/x-gzip',\n        htm : 'text/html',\n        html : 'text/html',\n        ico : 'image/vnd.microsoft.icon',\n        jnlp : 'application/x-java-jnlp-file',\n        jpeg : 'image/jpeg',\n        jpg : 'image/jpeg',\n        m3u : 'audio/x-mpegurl',\n        m4v : 'video/mp4',\n        mathml : 'application/mathml+xml',\n        mid : 'audio/midi',\n        midi : 'audio/midi',\n        mov : 'video/quicktime',\n        mp3 : 'audio/mpeg',\n        mp4 : 'video/mp4',\n        mp4v : 'video/mp4',\n        mpeg : 'video/mpeg',\n        mpg : 'video/mpeg',\n        odp : 'application/vnd.oasis.opendocument.presentation',\n        ods : 'application/vnd.oasis.opendocument.spreadsheet',\n        odt : 'application/vnd.oasis.opendocument.text',\n        ogg : 'application/ogg',\n        pdf : 'application/pdf',\n        png : 'image/png',\n        pps : 'application/vnd.ms-powerpoint',\n        ppt : 'application/vnd.ms-powerpoint',\n        ps : 'application/postscript',\n        qt : 'video/quicktime',\n        rdf : 'application/rdf+xml',\n        rss : 'application/rss+xml',\n        rtf : 'application/rtf',\n        svg : 'image/svg+xml',\n        swf : 'application/x-shockwave-flash',\n        text : 'text/plain',\n        tif : 'image/tiff',\n        tiff : 'image/tiff',\n        txt : 'text/plain',\n        wav : 'audio/x-wav',\n        wma : 'audio/x-ms-wma',\n        wmv : 'video/x-ms-wmv',\n        xml : 'application/xml',\n        zip : 'application/zip',\n\n        detectFromFilename : function(filename) {\n            var ext = filename.toLowerCase();\n            ext = getExtensionFromUri(ext);\n            return MimeTypes[ext];\n        }\n    };\n\n    var parser;\n    if (typeof DOMParser !== 'undefined') {\n        parser = new DOMParser();\n    }\n\n    var autolinker = new Autolinker({\n        stripPrefix : false,\n        email : false,\n        replaceFn : function(match) {\n            if (!match.protocolUrlMatch) {\n                //Prevent matching of non-explicit urls.\n                //i.e. foo.id won't match but http://foo.id will\n                return false;\n            }\n        }\n    });\n\n    var BILLBOARD_SIZE = 32;\n\n    var BILLBOARD_NEAR_DISTANCE = 2414016;\n    var BILLBOARD_NEAR_RATIO = 1.0;\n    var BILLBOARD_FAR_DISTANCE = 1.6093e+7;\n    var BILLBOARD_FAR_RATIO = 0.1;\n\n    var kmlNamespaces = [null, undefined, 'http://www.opengis.net/kml/2.2', 'http://earth.google.com/kml/2.2', 'http://earth.google.com/kml/2.1', 'http://earth.google.com/kml/2.0'];\n    var gxNamespaces = ['http://www.google.com/kml/ext/2.2'];\n    var atomNamespaces = ['http://www.w3.org/2005/Atom'];\n    var namespaces = {\n        kml : kmlNamespaces,\n        gx : gxNamespaces,\n        atom : atomNamespaces,\n        kmlgx : kmlNamespaces.concat(gxNamespaces)\n    };\n\n    // Ensure Specs/Data/KML/unsupported.kml is kept up to date with these supported types\n    var featureTypes = {\n        Document : processDocument,\n        Folder : processFolder,\n        Placemark : processPlacemark,\n        NetworkLink : processNetworkLink,\n        GroundOverlay : processGroundOverlay,\n        PhotoOverlay : processUnsupportedFeature,\n        ScreenOverlay : processUnsupportedFeature,\n        Tour : processTour\n    };\n\n    function DeferredLoading(dataSource) {\n        this._dataSource = dataSource;\n        this._deferred = when.defer();\n        this._stack = [];\n        this._promises = [];\n        this._timeoutSet = false;\n        this._used = false;\n\n        this._started = 0;\n        this._timeThreshold = 1000; // Initial load is 1 second\n    }\n\n    defineProperties(DeferredLoading.prototype, {\n        dataSource : {\n            get : function() {\n                return this._dataSource;\n            }\n        }\n    });\n\n    DeferredLoading.prototype.addNodes = function(nodes, processingData) {\n        this._stack.push({\n            nodes: nodes,\n            index: 0,\n            processingData: processingData\n        });\n        this._used = true;\n    };\n\n    DeferredLoading.prototype.addPromise = function(promise) {\n        this._promises.push(promise);\n    };\n\n    DeferredLoading.prototype.wait = function() {\n        // Case where we had a non-document/folder as the root\n        var deferred = this._deferred;\n        if (!this._used) {\n            deferred.resolve();\n        }\n\n        return when.join(deferred.promise, when.all(this._promises));\n    };\n\n    DeferredLoading.prototype.process = function() {\n        var isFirstCall = (this._stack.length === 1);\n        if (isFirstCall) {\n            this._started = KmlDataSource._getTimestamp();\n        }\n\n        return this._process(isFirstCall);\n    };\n\n    DeferredLoading.prototype._giveUpTime = function() {\n        if (this._timeoutSet) {\n            // Timeout was already set so just return\n            return;\n        }\n\n        this._timeoutSet = true;\n        this._timeThreshold = 50; // After the first load lower threshold to 0.5 seconds\n        var that = this;\n        setTimeout(function() {\n            that._timeoutSet = false;\n            that._started = KmlDataSource._getTimestamp();\n            that._process(true);\n        }, 0);\n    };\n\n    DeferredLoading.prototype._nextNode = function() {\n        var stack = this._stack;\n        var top = stack[stack.length-1];\n        var index = top.index;\n        var nodes = top.nodes;\n        if (index === nodes.length) {\n            return;\n        }\n        ++top.index;\n\n        return nodes[index];\n    };\n\n    DeferredLoading.prototype._pop = function() {\n        var stack = this._stack;\n        stack.pop();\n\n        // Return false if we are done\n        if (stack.length === 0) {\n            this._deferred.resolve();\n            return false;\n        }\n\n        return true;\n    };\n\n    DeferredLoading.prototype._process = function(isFirstCall) {\n        var dataSource = this.dataSource;\n        var processingData = this._stack[this._stack.length-1].processingData;\n\n        var child = this._nextNode();\n        while(defined(child)) {\n            var featureProcessor = featureTypes[child.localName];\n            if(defined(featureProcessor) &&\n               ((namespaces.kml.indexOf(child.namespaceURI) !== -1) || (namespaces.gx.indexOf(child.namespaceURI) !== -1))) {\n                featureProcessor(dataSource, child, processingData, this);\n\n                // Give up time and continue loading later\n                if (this._timeoutSet || (KmlDataSource._getTimestamp() > (this._started + this._timeThreshold))) {\n                    this._giveUpTime();\n                    return;\n                }\n            }\n\n            child = this._nextNode();\n        }\n\n        // If we are a recursive call from a subfolder, just return so the parent folder can continue processing\n        // If we aren't then make another call to processNodes because there is stuff still left in the queue\n        if (this._pop() && isFirstCall) {\n            this._process(true);\n        }\n    };\n\n    function isZipFile(blob) {\n        var magicBlob = blob.slice(0, Math.min(4, blob.size));\n        var deferred = when.defer();\n        var reader = new FileReader();\n        reader.addEventListener('load', function() {\n            deferred.resolve(new DataView(reader.result).getUint32(0, false) === 0x504b0304);\n        });\n        reader.addEventListener('error', function() {\n            deferred.reject(reader.error);\n        });\n        reader.readAsArrayBuffer(magicBlob);\n        return deferred.promise;\n    }\n\n    function readBlobAsText(blob) {\n        var deferred = when.defer();\n        var reader = new FileReader();\n        reader.addEventListener('load', function() {\n            deferred.resolve(reader.result);\n        });\n        reader.addEventListener('error', function() {\n            deferred.reject(reader.error);\n        });\n        reader.readAsText(blob);\n        return deferred.promise;\n    }\n\n    function insertNamespaces(text) {\n        var namespaceMap = {\n            xsi : 'http://www.w3.org/2001/XMLSchema-instance'\n        };\n        var firstPart, lastPart, reg, declaration;\n\n        for (var key in namespaceMap) {\n            if (namespaceMap.hasOwnProperty(key)) {\n                reg = RegExp('[< ]' + key + ':');\n                declaration = 'xmlns:' + key + '=';\n                if (reg.test(text) && text.indexOf(declaration) === -1) {\n                    if (!defined(firstPart)) {\n                        firstPart = text.substr(0, text.indexOf('<kml') + 4);\n                        lastPart = text.substr(firstPart.length);\n                    }\n                    firstPart += ' ' + declaration + '\"' + namespaceMap[key] + '\"';\n                }\n            }\n        }\n\n        if (defined(firstPart)) {\n            text = firstPart + lastPart;\n        }\n\n        return text;\n    }\n\n    function removeDuplicateNamespaces(text) {\n        var index = text.indexOf('xmlns:');\n        var endDeclaration = text.indexOf('>', index);\n        var namespace, startIndex, endIndex;\n\n        while ((index !== -1) && (index < endDeclaration)) {\n            namespace = text.slice(index, text.indexOf('\\\"', index));\n            startIndex = index;\n            index = text.indexOf(namespace, index + 1);\n            if (index !== -1) {\n                endIndex = text.indexOf('\\\"', (text.indexOf('\\\"', index) + 1));\n                text = text.slice(0, index -1) + text.slice(endIndex + 1, text.length);\n                index = text.indexOf('xmlns:', startIndex - 1);\n            } else {\n                index = text.indexOf('xmlns:', startIndex + 1);\n            }\n        }\n\n        return text;\n    }\n\n    function loadXmlFromZip(entry, uriResolver, deferred) {\n        entry.getData(new zip.TextWriter(), function(text) {\n            text = insertNamespaces(text);\n            text = removeDuplicateNamespaces(text);\n            uriResolver.kml = parser.parseFromString(text, 'application/xml');\n            deferred.resolve();\n        });\n    }\n\n    function loadDataUriFromZip(entry, uriResolver, deferred) {\n        var mimeType = defaultValue(MimeTypes.detectFromFilename(entry.filename), 'application/octet-stream');\n        entry.getData(new zip.Data64URIWriter(mimeType), function(dataUri) {\n            uriResolver[entry.filename] = dataUri;\n            deferred.resolve();\n        });\n    }\n\n    function embedDataUris(div, elementType, attributeName, uriResolver) {\n        var keys = uriResolver.keys;\n        var baseUri = new Uri('.');\n        var elements = div.querySelectorAll(elementType);\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var value = element.getAttribute(attributeName);\n            var uri = new Uri(value).resolve(baseUri).toString();\n            var index = keys.indexOf(uri);\n            if (index !== -1) {\n                var key = keys[index];\n                element.setAttribute(attributeName, uriResolver[key]);\n                if (elementType === 'a' && element.getAttribute('download') === null) {\n                    element.setAttribute('download', key);\n                }\n            }\n        }\n    }\n\n    function applyBasePath(div, elementType, attributeName, sourceResource) {\n        var elements = div.querySelectorAll(elementType);\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var value = element.getAttribute(attributeName);\n            var resource = resolveHref(value, sourceResource);\n            element.setAttribute(attributeName, resource.url);\n        }\n    }\n\n    // an optional context is passed to allow for some malformed kmls (those with multiple geometries with same ids) to still parse\n    // correctly, as they do in Google Earth.\n    function createEntity(node, entityCollection, context) {\n        var id = queryStringAttribute(node, 'id');\n        id = defined(id) && id.length !== 0 ? id : createGuid();\n        if (defined(context)) {\n            id = context + id;\n        }\n\n        // If we have a duplicate ID just generate one.\n        // This isn't valid KML but Google Earth handles this case.\n        var entity = entityCollection.getById(id);\n        if (defined(entity)) {\n            id = createGuid();\n            if (defined(context)) {\n                id = context + id;\n            }\n        }\n\n        entity = entityCollection.add(new Entity({id : id}));\n        if (!defined(entity.kml)) {\n            entity.addProperty('kml');\n            entity.kml = new KmlFeatureData();\n        }\n        return entity;\n    }\n\n    function isExtrudable(altitudeMode, gxAltitudeMode) {\n        return altitudeMode === 'absolute' || altitudeMode === 'relativeToGround' || gxAltitudeMode === 'relativeToSeaFloor';\n    }\n\n    function readCoordinate(value, ellipsoid) {\n        //Google Earth treats empty or missing coordinates as 0.\n        if (!defined(value)) {\n            return Cartesian3.fromDegrees(0, 0, 0, ellipsoid);\n        }\n\n        var digits = value.match(/[^\\s,\\n]+/g);\n        if (!defined(digits)) {\n            return Cartesian3.fromDegrees(0, 0, 0, ellipsoid);\n        }\n\n        var longitude = parseFloat(digits[0]);\n        var latitude = parseFloat(digits[1]);\n        var height = parseFloat(digits[2]);\n\n        longitude = isNaN(longitude) ? 0.0 : longitude;\n        latitude = isNaN(latitude) ? 0.0 : latitude;\n        height = isNaN(height) ? 0.0 : height;\n\n        return Cartesian3.fromDegrees(longitude, latitude, height, ellipsoid);\n    }\n\n    function readCoordinates(element, ellipsoid) {\n        if (!defined(element)) {\n            return undefined;\n        }\n\n        var tuples = element.textContent.match(/[^\\s\\n]+/g);\n        if (!defined(tuples)) {\n            return undefined;\n        }\n\n        var length = tuples.length;\n        var result = new Array(length);\n        var resultIndex = 0;\n        for (var i = 0; i < length; i++) {\n            result[resultIndex++] = readCoordinate(tuples[i], ellipsoid);\n        }\n        return result;\n    }\n\n    function queryNumericAttribute(node, attributeName) {\n        if (!defined(node)) {\n            return undefined;\n        }\n\n        var value = node.getAttribute(attributeName);\n        if (value !== null) {\n            var result = parseFloat(value);\n            return !isNaN(result) ? result : undefined;\n        }\n        return undefined;\n    }\n\n    function queryStringAttribute(node, attributeName) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var value = node.getAttribute(attributeName);\n        return value !== null ? value : undefined;\n    }\n\n    function queryFirstNode(node, tagName, namespace) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var childNodes = node.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                return child;\n            }\n        }\n        return undefined;\n    }\n\n    function queryNodes(node, tagName, namespace) {\n        if (!defined(node)) {\n            return undefined;\n        }\n        var result = [];\n        var childNodes = node.getElementsByTagNameNS('*', tagName);\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                result.push(child);\n            }\n        }\n        return result;\n    }\n\n    function queryChildNodes(node, tagName, namespace) {\n        if (!defined(node)) {\n            return [];\n        }\n        var result = [];\n        var childNodes = node.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === tagName && namespace.indexOf(child.namespaceURI) !== -1) {\n                result.push(child);\n            }\n        }\n        return result;\n    }\n\n    function queryNumericValue(node, tagName, namespace) {\n        var resultNode = queryFirstNode(node, tagName, namespace);\n        if (defined(resultNode)) {\n            var result = parseFloat(resultNode.textContent);\n            return !isNaN(result) ? result : undefined;\n        }\n        return undefined;\n    }\n\n    function queryStringValue(node, tagName, namespace) {\n        var result = queryFirstNode(node, tagName, namespace);\n        if (defined(result)) {\n            return result.textContent.trim();\n        }\n        return undefined;\n    }\n\n    function queryBooleanValue(node, tagName, namespace) {\n        var result = queryFirstNode(node, tagName, namespace);\n        if (defined(result)) {\n            var value = result.textContent.trim();\n            return value === '1' || /^true$/i.test(value);\n        }\n        return undefined;\n    }\n\n    function resolveHref(href, sourceResource, uriResolver) {\n        if (!defined(href)) {\n            return undefined;\n        }\n\n        var resource;\n        if (defined(uriResolver)) {\n            var blob = uriResolver[href];\n            if (defined(blob)) {\n                resource = new Resource({\n                    url: blob\n                });\n            } else {\n                // Needed for multiple levels of KML files in a KMZ\n                var baseUri = new Uri(sourceResource.getUrlComponent());\n                var uri = new Uri(href);\n                blob = uriResolver[uri.resolve(baseUri)];\n                if (defined(blob)) {\n                    resource = new Resource({\n                        url: blob\n                    });\n                }\n            }\n        }\n\n        if (!defined(resource)) {\n            resource = sourceResource.getDerivedResource({\n                url: href\n            });\n        }\n\n        return resource;\n    }\n\n    var colorOptions = {\n        maximumRed : undefined,\n        red : undefined,\n        maximumGreen : undefined,\n        green : undefined,\n        maximumBlue : undefined,\n        blue : undefined\n    };\n\n    function parseColorString(value, isRandom) {\n        if (!defined(value) || /^\\s*$/gm.test(value)) {\n            return undefined;\n        }\n\n        if (value[0] === '#') {\n            value = value.substring(1);\n        }\n\n        var alpha = parseInt(value.substring(0, 2), 16) / 255.0;\n        var blue = parseInt(value.substring(2, 4), 16) / 255.0;\n        var green = parseInt(value.substring(4, 6), 16) / 255.0;\n        var red = parseInt(value.substring(6, 8), 16) / 255.0;\n\n        if (!isRandom) {\n            return new Color(red, green, blue, alpha);\n        }\n\n        if (red > 0) {\n            colorOptions.maximumRed = red;\n            colorOptions.red = undefined;\n        } else {\n            colorOptions.maximumRed = undefined;\n            colorOptions.red = 0;\n        }\n        if (green > 0) {\n            colorOptions.maximumGreen = green;\n            colorOptions.green = undefined;\n        } else {\n            colorOptions.maximumGreen = undefined;\n            colorOptions.green = 0;\n        }\n        if (blue > 0) {\n            colorOptions.maximumBlue = blue;\n            colorOptions.blue = undefined;\n        } else {\n            colorOptions.maximumBlue = undefined;\n            colorOptions.blue = 0;\n        }\n        colorOptions.alpha = alpha;\n        return Color.fromRandom(colorOptions);\n    }\n\n    function queryColorValue(node, tagName, namespace) {\n        var value = queryStringValue(node, tagName, namespace);\n        if (!defined(value)) {\n            return undefined;\n        }\n        return parseColorString(value, queryStringValue(node, 'colorMode', namespace) === 'random');\n    }\n\n    function processTimeStamp(featureNode) {\n        var node = queryFirstNode(featureNode, 'TimeStamp', namespaces.kmlgx);\n        var whenString = queryStringValue(node, 'when', namespaces.kmlgx);\n\n        if (!defined(node) || !defined(whenString) || whenString.length === 0) {\n            return undefined;\n        }\n\n        //According to the KML spec, a TimeStamp represents a \"single moment in time\"\n        //However, since Cesium animates much differently than Google Earth, that doesn't\n        //Make much sense here.  Instead, we use the TimeStamp as the moment the feature\n        //comes into existence.  This works much better and gives a similar feel to\n        //GE's experience.\n        var when = JulianDate.fromIso8601(whenString);\n        var result = new TimeIntervalCollection();\n        result.addInterval(new TimeInterval({\n            start : when,\n            stop : Iso8601.MAXIMUM_VALUE\n        }));\n        return result;\n    }\n\n    function processTimeSpan(featureNode) {\n        var node = queryFirstNode(featureNode, 'TimeSpan', namespaces.kmlgx);\n        if (!defined(node)) {\n            return undefined;\n        }\n        var result;\n\n        var beginNode = queryFirstNode(node, 'begin', namespaces.kmlgx);\n        var beginDate = defined(beginNode) ? JulianDate.fromIso8601(beginNode.textContent) : undefined;\n\n        var endNode = queryFirstNode(node, 'end', namespaces.kmlgx);\n        var endDate = defined(endNode) ? JulianDate.fromIso8601(endNode.textContent) : undefined;\n\n        if (defined(beginDate) && defined(endDate)) {\n            if (JulianDate.lessThan(endDate, beginDate)) {\n                var tmp = beginDate;\n                beginDate = endDate;\n                endDate = tmp;\n            }\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : beginDate,\n                stop : endDate\n            }));\n        } else if (defined(beginDate)) {\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : beginDate,\n                stop : Iso8601.MAXIMUM_VALUE\n            }));\n        } else if (defined(endDate)) {\n            result = new TimeIntervalCollection();\n            result.addInterval(new TimeInterval({\n                start : Iso8601.MINIMUM_VALUE,\n                stop : endDate\n            }));\n        }\n\n        return result;\n    }\n\n    function createDefaultBillboard() {\n        var billboard = new BillboardGraphics();\n        billboard.width = BILLBOARD_SIZE;\n        billboard.height = BILLBOARD_SIZE;\n        billboard.scaleByDistance = new NearFarScalar(BILLBOARD_NEAR_DISTANCE, BILLBOARD_NEAR_RATIO, BILLBOARD_FAR_DISTANCE, BILLBOARD_FAR_RATIO);\n        billboard.pixelOffsetScaleByDistance = new NearFarScalar(BILLBOARD_NEAR_DISTANCE, BILLBOARD_NEAR_RATIO, BILLBOARD_FAR_DISTANCE, BILLBOARD_FAR_RATIO);\n        return billboard;\n    }\n\n    function createDefaultPolygon() {\n        var polygon = new PolygonGraphics();\n        polygon.outline = true;\n        polygon.outlineColor = Color.WHITE;\n        return polygon;\n    }\n\n    function createDefaultLabel() {\n        var label = new LabelGraphics();\n        label.translucencyByDistance = new NearFarScalar(3000000, 1.0, 5000000, 0.0);\n        label.pixelOffset = new Cartesian2(17, 0);\n        label.horizontalOrigin = HorizontalOrigin.LEFT;\n        label.font = '16px sans-serif';\n        label.style = LabelStyle.FILL_AND_OUTLINE;\n        return label;\n    }\n\n    function getIconHref(iconNode, dataSource, sourceResource, uriResolver, canRefresh) {\n        var href = queryStringValue(iconNode, 'href', namespaces.kml);\n        if (!defined(href) || (href.length === 0)) {\n            return undefined;\n        }\n\n        if (href.indexOf('root://icons/palette-') === 0) {\n            var palette = href.charAt(21);\n\n            // Get the icon number\n            var x = defaultValue(queryNumericValue(iconNode, 'x', namespaces.gx), 0);\n            var y = defaultValue(queryNumericValue(iconNode, 'y', namespaces.gx), 0);\n            x = Math.min(x / 32, 7);\n            y = 7 - Math.min(y / 32, 7);\n            var iconNum = (8 * y) + x;\n\n            href = 'https://maps.google.com/mapfiles/kml/pal' + palette + '/icon' + iconNum + '.png';\n        }\n\n        var hrefResource = resolveHref(href, sourceResource, uriResolver);\n\n        if (canRefresh) {\n            var refreshMode = queryStringValue(iconNode, 'refreshMode', namespaces.kml);\n            var viewRefreshMode = queryStringValue(iconNode, 'viewRefreshMode', namespaces.kml);\n            if (refreshMode === 'onInterval' || refreshMode === 'onExpire') {\n                oneTimeWarning('kml-refreshMode-' + refreshMode, 'KML - Unsupported Icon refreshMode: ' + refreshMode);\n            } else if (viewRefreshMode === 'onStop' || viewRefreshMode === 'onRegion') {\n                oneTimeWarning('kml-refreshMode-' + viewRefreshMode, 'KML - Unsupported Icon viewRefreshMode: ' + viewRefreshMode);\n            }\n\n            var viewBoundScale = defaultValue(queryStringValue(iconNode, 'viewBoundScale', namespaces.kml), 1.0);\n            var defaultViewFormat = (viewRefreshMode === 'onStop') ? 'BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]' : '';\n            var viewFormat = defaultValue(queryStringValue(iconNode, 'viewFormat', namespaces.kml), defaultViewFormat);\n            var httpQuery = queryStringValue(iconNode, 'httpQuery', namespaces.kml);\n            if (defined(viewFormat)) {\n                hrefResource.setQueryParameters(queryToObject(cleanupString(viewFormat)));\n            }\n            if (defined(httpQuery)) {\n                hrefResource.setQueryParameters(queryToObject(cleanupString(httpQuery)));\n            }\n\n            var ellipsoid = dataSource._ellipsoid;\n            processNetworkLinkQueryString(hrefResource, dataSource._camera, dataSource._canvas, viewBoundScale, dataSource._lastCameraView.bbox, ellipsoid);\n\n            return hrefResource;\n        }\n\n        return hrefResource;\n    }\n\n    function processBillboardIcon(dataSource, node, targetEntity, sourceResource, uriResolver) {\n        var scale = queryNumericValue(node, 'scale', namespaces.kml);\n        var heading = queryNumericValue(node, 'heading', namespaces.kml);\n        var color = queryColorValue(node, 'color', namespaces.kml);\n\n        var iconNode = queryFirstNode(node, 'Icon', namespaces.kml);\n        var icon = getIconHref(iconNode, dataSource, sourceResource, uriResolver, false);\n\n        // If icon tags are present but blank, we do not want to show an icon\n        if (defined(iconNode) && !defined(icon)) {\n            icon = false;\n        }\n\n        var x = queryNumericValue(iconNode, 'x', namespaces.gx);\n        var y = queryNumericValue(iconNode, 'y', namespaces.gx);\n        var w = queryNumericValue(iconNode, 'w', namespaces.gx);\n        var h = queryNumericValue(iconNode, 'h', namespaces.gx);\n\n        var hotSpotNode = queryFirstNode(node, 'hotSpot', namespaces.kml);\n        var hotSpotX = queryNumericAttribute(hotSpotNode, 'x');\n        var hotSpotY = queryNumericAttribute(hotSpotNode, 'y');\n        var hotSpotXUnit = queryStringAttribute(hotSpotNode, 'xunits');\n        var hotSpotYUnit = queryStringAttribute(hotSpotNode, 'yunits');\n\n        var billboard = targetEntity.billboard;\n        if (!defined(billboard)) {\n            billboard = createDefaultBillboard();\n            targetEntity.billboard = billboard;\n        }\n\n        billboard.image = icon;\n        billboard.scale = scale;\n        billboard.color = color;\n\n        if (defined(x) || defined(y) || defined(w) || defined(h)) {\n            billboard.imageSubRegion = new BoundingRectangle(x, y, w, h);\n        }\n\n        //GE treats a heading of zero as no heading\n        //You can still point north using a 360 degree angle (or any multiple of 360)\n        if (defined(heading) && heading !== 0) {\n            billboard.rotation = CesiumMath.toRadians(-heading);\n            billboard.alignedAxis = Cartesian3.UNIT_Z;\n        }\n\n        //Hotpot is the KML equivalent of pixel offset\n        //The hotspot origin is the lower left, but we leave\n        //our billboard origin at the center and simply\n        //modify the pixel offset to take this into account\n        scale = defaultValue(scale, 1.0);\n\n        var xOffset;\n        var yOffset;\n        if (defined(hotSpotX)) {\n            if (hotSpotXUnit === 'pixels') {\n                xOffset = -hotSpotX * scale;\n            } else if (hotSpotXUnit === 'insetPixels') {\n                xOffset = (hotSpotX - BILLBOARD_SIZE) * scale;\n            } else if (hotSpotXUnit === 'fraction') {\n                xOffset = -hotSpotX * BILLBOARD_SIZE * scale;\n            }\n            xOffset += BILLBOARD_SIZE * 0.5 * scale;\n        }\n\n        if (defined(hotSpotY)) {\n            if (hotSpotYUnit === 'pixels') {\n                yOffset = hotSpotY * scale;\n            } else if (hotSpotYUnit === 'insetPixels') {\n                yOffset = (-hotSpotY + BILLBOARD_SIZE) * scale;\n            } else if (hotSpotYUnit === 'fraction') {\n                yOffset = hotSpotY * BILLBOARD_SIZE * scale;\n            }\n\n            yOffset -= BILLBOARD_SIZE * 0.5 * scale;\n        }\n\n        if (defined(xOffset) || defined(yOffset)) {\n            billboard.pixelOffset = new Cartesian2(xOffset, yOffset);\n        }\n    }\n\n    function applyStyle(dataSource, styleNode, targetEntity, sourceResource, uriResolver) {\n        for (var i = 0, len = styleNode.childNodes.length; i < len; i++) {\n            var node = styleNode.childNodes.item(i);\n            if (node.localName === 'IconStyle') {\n                processBillboardIcon(dataSource, node, targetEntity, sourceResource, uriResolver);\n            } else if (node.localName === 'LabelStyle') {\n                var label = targetEntity.label;\n                if (!defined(label)) {\n                    label = createDefaultLabel();\n                    targetEntity.label = label;\n                }\n                label.scale = defaultValue(queryNumericValue(node, 'scale', namespaces.kml), label.scale);\n                label.fillColor = defaultValue(queryColorValue(node, 'color', namespaces.kml), label.fillColor);\n                label.text = targetEntity.name;\n            } else if (node.localName === 'LineStyle') {\n                var polyline = targetEntity.polyline;\n                if (!defined(polyline)) {\n                    polyline = new PolylineGraphics();\n                    targetEntity.polyline = polyline;\n                }\n                polyline.width = queryNumericValue(node, 'width', namespaces.kml);\n                polyline.material = queryColorValue(node, 'color', namespaces.kml);\n                if (defined(queryColorValue(node, 'outerColor', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:outerColor', 'KML - gx:outerColor is not supported in a LineStyle');\n                }\n                if (defined(queryNumericValue(node, 'outerWidth', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:outerWidth', 'KML - gx:outerWidth is not supported in a LineStyle');\n                }\n                if (defined(queryNumericValue(node, 'physicalWidth', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:physicalWidth', 'KML - gx:physicalWidth is not supported in a LineStyle');\n                }\n                if (defined(queryBooleanValue(node, 'labelVisibility', namespaces.gx))) {\n                    oneTimeWarning('kml-gx:labelVisibility', 'KML - gx:labelVisibility is not supported in a LineStyle');\n                }\n            } else if (node.localName === 'PolyStyle') {\n                var polygon = targetEntity.polygon;\n                if (!defined(polygon)) {\n                    polygon = createDefaultPolygon();\n                    targetEntity.polygon = polygon;\n                }\n                polygon.material = defaultValue(queryColorValue(node, 'color', namespaces.kml), polygon.material);\n                polygon.fill = defaultValue(queryBooleanValue(node, 'fill', namespaces.kml), polygon.fill);\n                polygon.outline = defaultValue(queryBooleanValue(node, 'outline', namespaces.kml), polygon.outline);\n            } else if (node.localName === 'BalloonStyle') {\n                var bgColor = defaultValue(parseColorString(queryStringValue(node, 'bgColor', namespaces.kml)), Color.WHITE);\n                var textColor = defaultValue(parseColorString(queryStringValue(node, 'textColor', namespaces.kml)), Color.BLACK);\n                var text = queryStringValue(node, 'text', namespaces.kml);\n\n                //This is purely an internal property used in style processing,\n                //it never ends up on the final entity.\n                targetEntity.addProperty('balloonStyle');\n                targetEntity.balloonStyle = {\n                    bgColor : bgColor,\n                    textColor : textColor,\n                    text : text\n                };\n            } else if (node.localName === 'ListStyle') {\n                var listItemType = queryStringValue(node, 'listItemType', namespaces.kml);\n                if (listItemType === 'radioFolder' || listItemType === 'checkOffOnly') {\n                    oneTimeWarning('kml-listStyle-' + listItemType, 'KML - Unsupported ListStyle with listItemType: ' + listItemType);\n                }\n            }\n        }\n    }\n\n    //Processes and merges any inline styles for the provided node into the provided entity.\n    function computeFinalStyle(dataSource, placeMark, styleCollection, sourceResource, uriResolver) {\n        var result = new Entity();\n        var styleEntity;\n\n        //Google earth seems to always use the last inline Style/StyleMap only\n        var styleIndex = -1;\n        var childNodes = placeMark.childNodes;\n        var length = childNodes.length;\n        for (var q = 0; q < length; q++) {\n            var child = childNodes[q];\n            if (child.localName === 'Style' || child.localName === 'StyleMap') {\n                styleIndex = q;\n            }\n        }\n\n        if (styleIndex !== -1) {\n            var inlineStyleNode = childNodes[styleIndex];\n            if (inlineStyleNode.localName === 'Style') {\n                applyStyle(dataSource, inlineStyleNode, result, sourceResource, uriResolver);\n            } else { // StyleMap\n                var pairs = queryChildNodes(inlineStyleNode, 'Pair', namespaces.kml);\n                for (var p = 0; p < pairs.length; p++) {\n                    var pair = pairs[p];\n                    var key = queryStringValue(pair, 'key', namespaces.kml);\n                    if (key === 'normal') {\n                        var styleUrl = queryStringValue(pair, 'styleUrl', namespaces.kml);\n                        if (defined(styleUrl)) {\n                            styleEntity = styleCollection.getById(styleUrl);\n                            if (!defined(styleEntity)) {\n                                styleEntity = styleCollection.getById('#' + styleUrl);\n                            }\n                            if (defined(styleEntity)) {\n                                result.merge(styleEntity);\n                            }\n                        } else {\n                            var node = queryFirstNode(pair, 'Style', namespaces.kml);\n                            applyStyle(dataSource, node, result, sourceResource, uriResolver);\n                        }\n                    } else {\n                        oneTimeWarning('kml-styleMap-' + key, 'KML - Unsupported StyleMap key: ' + key);\n                    }\n                }\n            }\n        }\n\n        //Google earth seems to always use the first external style only.\n        var externalStyle = queryStringValue(placeMark, 'styleUrl', namespaces.kml);\n        if (defined(externalStyle)) {\n            var id = externalStyle;\n            if (externalStyle[0] !== '#' && externalStyle.indexOf('#') !== -1) {\n                var tokens = externalStyle.split('#');\n                var uri = tokens[0];\n                var resource = sourceResource.getDerivedResource({\n                    url: uri\n                });\n\n                id = resource.getUrlComponent() + '#' + tokens[1];\n            }\n\n            styleEntity = styleCollection.getById(id);\n            if (!defined(styleEntity)) {\n                styleEntity = styleCollection.getById('#' + id);\n            }\n            if (defined(styleEntity)) {\n                result.merge(styleEntity);\n            }\n        }\n\n        return result;\n    }\n\n    //Asynchronously processes an external style file.\n    function processExternalStyles(dataSource, resource, styleCollection) {\n        return resource.fetchXML().then(function(styleKml) {\n            return processStyles(dataSource, styleKml, styleCollection, resource, true);\n        });\n    }\n\n    //Processes all shared and external styles and stores\n    //their id into the provided styleCollection.\n    //Returns an array of promises that will resolve when\n    //each style is loaded.\n    function processStyles(dataSource, kml, styleCollection, sourceResource, isExternal, uriResolver) {\n        var i;\n        var id;\n        var styleEntity;\n\n        var node;\n        var styleNodes = queryNodes(kml, 'Style', namespaces.kml);\n        if (defined(styleNodes)) {\n            var styleNodesLength = styleNodes.length;\n            for (i = 0; i < styleNodesLength; i++) {\n                node = styleNodes[i];\n                id = queryStringAttribute(node, 'id');\n                if (defined(id)) {\n                    id = '#' + id;\n                    if (isExternal && defined(sourceResource)) {\n                        id = sourceResource.getUrlComponent() + id;\n                    }\n                    if (!defined(styleCollection.getById(id))) {\n                        styleEntity = new Entity({\n                            id : id\n                        });\n                        styleCollection.add(styleEntity);\n                        applyStyle(dataSource, node, styleEntity, sourceResource, uriResolver);\n                    }\n                }\n            }\n        }\n\n        var styleMaps = queryNodes(kml, 'StyleMap', namespaces.kml);\n        if (defined(styleMaps)) {\n            var styleMapsLength = styleMaps.length;\n            for (i = 0; i < styleMapsLength; i++) {\n                var styleMap = styleMaps[i];\n                id = queryStringAttribute(styleMap, 'id');\n                if (defined(id)) {\n                    var pairs = queryChildNodes(styleMap, 'Pair', namespaces.kml);\n                    for (var p = 0; p < pairs.length; p++) {\n                        var pair = pairs[p];\n                        var key = queryStringValue(pair, 'key', namespaces.kml);\n                        if (key === 'normal') {\n                            id = '#' + id;\n                            if (isExternal && defined(sourceResource)) {\n                                id = sourceResource.getUrlComponent() + id;\n                            }\n                            if (!defined(styleCollection.getById(id))) {\n                                styleEntity = styleCollection.getOrCreateEntity(id);\n\n                                var styleUrl = queryStringValue(pair, 'styleUrl', namespaces.kml);\n                                if (defined(styleUrl)) {\n                                    if (styleUrl[0] !== '#') {\n                                        styleUrl = '#' + styleUrl;\n                                    }\n\n                                    if (isExternal && defined(sourceResource)) {\n                                        styleUrl = sourceResource.getUrlComponent() + styleUrl;\n                                    }\n                                    var base = styleCollection.getById(styleUrl);\n\n                                    if (defined(base)) {\n                                        styleEntity.merge(base);\n                                    }\n                                } else {\n                                    node = queryFirstNode(pair, 'Style', namespaces.kml);\n                                    applyStyle(dataSource, node, styleEntity, sourceResource, uriResolver);\n                                }\n                            }\n                        } else {\n                            oneTimeWarning('kml-styleMap-' + key, 'KML - Unsupported StyleMap key: ' + key);\n                        }\n                    }\n                }\n            }\n        }\n\n        var promises = [];\n        var styleUrlNodes = kml.getElementsByTagName('styleUrl');\n        var styleUrlNodesLength = styleUrlNodes.length;\n        for (i = 0; i < styleUrlNodesLength; i++) {\n            var styleReference = styleUrlNodes[i].textContent;\n            if (styleReference[0] !== '#') {\n                //According to the spec, all local styles should start with a #\n                //and everything else is an external style that has a # seperating\n                //the URL of the document and the style.  However, Google Earth\n                //also accepts styleUrls without a # as meaning a local style.\n                var tokens = styleReference.split('#');\n                if (tokens.length === 2) {\n                    var uri = tokens[0];\n                    var resource = sourceResource.getDerivedResource({\n                        url: uri\n                    });\n\n                    promises.push(processExternalStyles(dataSource, resource, styleCollection));\n                }\n            }\n        }\n\n        return promises;\n    }\n\n    function createDropLine(entityCollection, entity, styleEntity) {\n        var entityPosition = new ReferenceProperty(entityCollection, entity.id, ['position']);\n        var surfacePosition = new ScaledPositionProperty(entity.position);\n        entity.polyline = defined(styleEntity.polyline) ? styleEntity.polyline.clone() : new PolylineGraphics();\n        entity.polyline.positions = new PositionPropertyArray([entityPosition, surfacePosition]);\n    }\n\n    function heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode) {\n        if (!defined(altitudeMode) && !defined(gxAltitudeMode) || altitudeMode === 'clampToGround') {\n            return HeightReference.CLAMP_TO_GROUND;\n        }\n\n        if (altitudeMode === 'relativeToGround') {\n            return HeightReference.RELATIVE_TO_GROUND;\n        }\n\n        if (altitudeMode === 'absolute') {\n            return HeightReference.NONE;\n        }\n\n        if (gxAltitudeMode === 'clampToSeaFloor') {\n            oneTimeWarning('kml-gx:altitudeMode-clampToSeaFloor', 'KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround.');\n            return HeightReference.CLAMP_TO_GROUND;\n        }\n\n        if (gxAltitudeMode === 'relativeToSeaFloor') {\n            oneTimeWarning('kml-gx:altitudeMode-relativeToSeaFloor', 'KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround.');\n            return HeightReference.RELATIVE_TO_GROUND;\n        }\n\n        if (defined(altitudeMode)) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown <kml:altitudeMode>:' + altitudeMode + ', using <kml:altitudeMode>:CLAMP_TO_GROUND.');\n        } else {\n            oneTimeWarning('kml-gx:altitudeMode-unknown', 'KML - Unknown <gx:altitudeMode>:' + gxAltitudeMode + ', using <kml:altitudeMode>:CLAMP_TO_GROUND.');\n        }\n\n        // Clamp to ground is the default\n        return HeightReference.CLAMP_TO_GROUND;\n    }\n\n    function createPositionPropertyFromAltitudeMode(property, altitudeMode, gxAltitudeMode) {\n        if (gxAltitudeMode === 'relativeToSeaFloor' || altitudeMode === 'absolute' || altitudeMode === 'relativeToGround') {\n            //Just return the ellipsoid referenced property until we support MSL\n            return property;\n        }\n\n        if ((defined(altitudeMode) && altitudeMode !== 'clampToGround') || //\n            (defined(gxAltitudeMode) && gxAltitudeMode !== 'clampToSeaFloor')) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + defaultValue(altitudeMode, gxAltitudeMode));\n        }\n\n        // Clamp to ground is the default\n        return new ScaledPositionProperty(property);\n    }\n\n    function createPositionPropertyArrayFromAltitudeMode(properties, altitudeMode, gxAltitudeMode, ellipsoid) {\n        if (!defined(properties)) {\n            return undefined;\n        }\n\n        if (gxAltitudeMode === 'relativeToSeaFloor' || altitudeMode === 'absolute' || altitudeMode === 'relativeToGround') {\n            //Just return the ellipsoid referenced property until we support MSL\n            return properties;\n        }\n\n        if ((defined(altitudeMode) && altitudeMode !== 'clampToGround') || //\n            (defined(gxAltitudeMode) && gxAltitudeMode !== 'clampToSeaFloor')) {\n            oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + defaultValue(altitudeMode, gxAltitudeMode));\n        }\n\n        // Clamp to ground is the default\n        var propertiesLength = properties.length;\n        for (var i = 0; i < propertiesLength; i++) {\n            var property = properties[i];\n            ellipsoid.scaleToGeodeticSurface(property, property);\n        }\n        return properties;\n    }\n\n    function processPositionGraphics(dataSource, entity, styleEntity, heightReference) {\n        var label = entity.label;\n        if (!defined(label)) {\n            label = defined(styleEntity.label) ? styleEntity.label.clone() : createDefaultLabel();\n            entity.label = label;\n        }\n        label.text = entity.name;\n\n        var billboard = entity.billboard;\n        if (!defined(billboard)) {\n            billboard = defined(styleEntity.billboard) ? styleEntity.billboard.clone() : createDefaultBillboard();\n            entity.billboard = billboard;\n        }\n\n        if (!defined(billboard.image)) {\n            billboard.image = dataSource._pinBuilder.fromColor(Color.YELLOW, 64);\n\n        // If there were empty <Icon> tags in the KML, then billboard.image was set to false above\n        // However, in this case, the false value would have been converted to a property afterwards\n        // Thus, we check if billboard.image is defined with value of false\n        } else if (!billboard.image.getValue()) {\n            billboard.image = undefined;\n        }\n\n        var scale = 1.0;\n        if (defined(billboard.scale)) {\n            scale = billboard.scale.getValue();\n            if (scale !== 0) {\n                label.pixelOffset = new Cartesian2((scale * 16) + 1, 0);\n            } else {\n                //Minor tweaks to better match Google Earth.\n                label.pixelOffset = undefined;\n                label.horizontalOrigin = undefined;\n            }\n        }\n\n        if (defined(heightReference) && dataSource._clampToGround) {\n            billboard.heightReference = heightReference;\n            label.heightReference = heightReference;\n        }\n    }\n\n    function processPathGraphics(entity, styleEntity) {\n        var path = entity.path;\n        if (!defined(path)) {\n            path = new PathGraphics();\n            path.leadTime = 0;\n            entity.path = path;\n        }\n\n        var polyline = styleEntity.polyline;\n        if (defined(polyline)) {\n            path.material = polyline.material;\n            path.width = polyline.width;\n        }\n    }\n\n    function processPoint(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var coordinatesString = queryStringValue(geometryNode, 'coordinates', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var ellipsoid = dataSource._ellipsoid;\n        var position = readCoordinate(coordinatesString, ellipsoid);\n\n        entity.position = position;\n        processPositionGraphics(dataSource, entity, styleEntity, heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode));\n\n        if (extrude && isExtrudable(altitudeMode, gxAltitudeMode)) {\n            createDropLine(entityCollection, entity, styleEntity);\n        }\n\n        return true;\n    }\n\n    function processLineStringOrLinearRing(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var coordinatesNode = queryFirstNode(geometryNode, 'coordinates', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var tessellate = queryBooleanValue(geometryNode, 'tessellate', namespaces.kml);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n        var zIndex = queryNumericValue(geometryNode, 'drawOrder', namespaces.gx);\n\n        var ellipsoid = dataSource._ellipsoid;\n        var coordinates = readCoordinates(coordinatesNode, ellipsoid);\n        var polyline = styleEntity.polyline;\n        if (canExtrude && extrude) {\n            var wall = new WallGraphics();\n            entity.wall = wall;\n            wall.positions = coordinates;\n            var polygon = styleEntity.polygon;\n\n            if (defined(polygon)) {\n                wall.fill = polygon.fill;\n                wall.material = polygon.material;\n            }\n\n            //Always outline walls so they show up in 2D.\n            wall.outline = true;\n            if (defined(polyline)) {\n                wall.outlineColor = defined(polyline.material) ? polyline.material.color : Color.WHITE;\n                wall.outlineWidth = polyline.width;\n            } else if (defined(polygon)) {\n                wall.outlineColor = defined(polygon.material) ? polygon.material.color : Color.WHITE;\n            }\n        } else if (dataSource._clampToGround && !canExtrude && tessellate) {\n            var polylineGraphics = new PolylineGraphics();\n            polylineGraphics.clampToGround = true;\n            entity.polyline = polylineGraphics;\n            polylineGraphics.positions = coordinates;\n            if (defined(polyline)) {\n                polylineGraphics.material = defined(polyline.material) ? polyline.material.color.getValue(Iso8601.MINIMUM_VALUE) : Color.WHITE;\n                polylineGraphics.width = defaultValue(polyline.width, 1.0);\n            } else {\n                polylineGraphics.material = Color.WHITE;\n                polylineGraphics.width = 1.0;\n            }\n            polylineGraphics.zIndex = zIndex;\n        } else {\n            if (defined(zIndex)) {\n                oneTimeWarning('kml-gx:drawOrder', 'KML - gx:drawOrder is not supported in LineStrings when clampToGround is false');\n            }\n\n            polyline = defined(polyline) ? polyline.clone() : new PolylineGraphics();\n            entity.polyline = polyline;\n            polyline.positions = createPositionPropertyArrayFromAltitudeMode(coordinates, altitudeMode, gxAltitudeMode, ellipsoid);\n            if (!tessellate || canExtrude) {\n                polyline.arcType = ArcType.NONE;\n            }\n        }\n\n        return true;\n    }\n\n    function processPolygon(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var outerBoundaryIsNode = queryFirstNode(geometryNode, 'outerBoundaryIs', namespaces.kml);\n        var linearRingNode = queryFirstNode(outerBoundaryIsNode, 'LinearRing', namespaces.kml);\n        var coordinatesNode = queryFirstNode(linearRingNode, 'coordinates', namespaces.kml);\n        var ellipsoid = dataSource._ellipsoid;\n        var coordinates = readCoordinates(coordinatesNode, ellipsoid);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n\n        var polygon = defined(styleEntity.polygon) ? styleEntity.polygon.clone() : createDefaultPolygon();\n\n        var polyline = styleEntity.polyline;\n        if (defined(polyline)) {\n            polygon.outlineColor = defined(polyline.material) ? polyline.material.color : Color.WHITE;\n            polygon.outlineWidth = polyline.width;\n        }\n        entity.polygon = polygon;\n\n        if (canExtrude) {\n            polygon.perPositionHeight = true;\n            polygon.extrudedHeight = extrude ? 0 : undefined;\n        } else if (!dataSource._clampToGround) {\n            polygon.height = 0;\n        }\n\n        if (defined(coordinates)) {\n            var hierarchy = new PolygonHierarchy(coordinates);\n            var innerBoundaryIsNodes = queryChildNodes(geometryNode, 'innerBoundaryIs', namespaces.kml);\n            for (var j = 0; j < innerBoundaryIsNodes.length; j++) {\n                linearRingNode = queryChildNodes(innerBoundaryIsNodes[j], 'LinearRing', namespaces.kml);\n                for (var k = 0; k < linearRingNode.length; k++) {\n                    coordinatesNode = queryFirstNode(linearRingNode[k], 'coordinates', namespaces.kml);\n                    coordinates = readCoordinates(coordinatesNode, ellipsoid);\n                    if (defined(coordinates)) {\n                        hierarchy.holes.push(new PolygonHierarchy(coordinates));\n                    }\n                }\n            }\n            polygon.hierarchy = hierarchy;\n        }\n\n        return true;\n    }\n\n    function processTrack(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        var altitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.kml);\n        var gxAltitudeMode = queryStringValue(geometryNode, 'altitudeMode', namespaces.gx);\n        var coordNodes = queryChildNodes(geometryNode, 'coord', namespaces.gx);\n        var angleNodes = queryChildNodes(geometryNode, 'angles', namespaces.gx);\n        var timeNodes = queryChildNodes(geometryNode, 'when', namespaces.kml);\n        var extrude = queryBooleanValue(geometryNode, 'extrude', namespaces.kml);\n        var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n        var ellipsoid = dataSource._ellipsoid;\n\n        if (angleNodes.length > 0) {\n            oneTimeWarning('kml-gx:angles', 'KML - gx:angles are not supported in gx:Tracks');\n        }\n\n        var length = Math.min(coordNodes.length, timeNodes.length);\n        var coordinates = [];\n        var times = [];\n        for (var i = 0; i < length; i++) {\n            var position = readCoordinate(coordNodes[i].textContent, ellipsoid);\n            coordinates.push(position);\n            times.push(JulianDate.fromIso8601(timeNodes[i].textContent));\n        }\n        var property = new SampledPositionProperty();\n        property.addSamples(times, coordinates);\n        entity.position = property;\n        processPositionGraphics(dataSource, entity, styleEntity, heightReferenceFromAltitudeMode(altitudeMode, gxAltitudeMode));\n        processPathGraphics(entity, styleEntity);\n\n        entity.availability = new TimeIntervalCollection();\n\n        if (timeNodes.length > 0) {\n            entity.availability.addInterval(new TimeInterval({\n                start : times[0],\n                stop : times[times.length - 1]\n            }));\n        }\n\n        if (canExtrude && extrude) {\n            createDropLine(entityCollection, entity, styleEntity);\n        }\n\n        return true;\n    }\n\n    function addToMultiTrack(times, positions, composite, availability, dropShowProperty, extrude, altitudeMode, gxAltitudeMode, includeEndPoints) {\n        var start = times[0];\n        var stop = times[times.length - 1];\n\n        var data = new SampledPositionProperty();\n        data.addSamples(times, positions);\n\n        composite.intervals.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints,\n            data : createPositionPropertyFromAltitudeMode(data, altitudeMode, gxAltitudeMode)\n        }));\n        availability.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints\n        }));\n        dropShowProperty.intervals.addInterval(new TimeInterval({\n            start : start,\n            stop : stop,\n            isStartIncluded : includeEndPoints,\n            isStopIncluded : includeEndPoints,\n            data : extrude\n        }));\n    }\n\n    function processMultiTrack(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        // Multitrack options do not work in GE as detailed in the spec,\n        // rather than altitudeMode being at the MultiTrack level,\n        // GE just defers all settings to the underlying track.\n\n        var interpolate = queryBooleanValue(geometryNode, 'interpolate', namespaces.gx);\n        var trackNodes = queryChildNodes(geometryNode, 'Track', namespaces.gx);\n\n        var times;\n        var lastStop;\n        var lastStopPosition;\n        var needDropLine = false;\n        var dropShowProperty = new TimeIntervalCollectionProperty();\n        var availability = new TimeIntervalCollection();\n        var composite = new CompositePositionProperty();\n        var ellipsoid = dataSource._ellipsoid;\n        for (var i = 0, len = trackNodes.length; i < len; i++) {\n            var trackNode = trackNodes[i];\n            var timeNodes = queryChildNodes(trackNode, 'when', namespaces.kml);\n            var coordNodes = queryChildNodes(trackNode, 'coord', namespaces.gx);\n            var altitudeMode = queryStringValue(trackNode, 'altitudeMode', namespaces.kml);\n            var gxAltitudeMode = queryStringValue(trackNode, 'altitudeMode', namespaces.gx);\n            var canExtrude = isExtrudable(altitudeMode, gxAltitudeMode);\n            var extrude = queryBooleanValue(trackNode, 'extrude', namespaces.kml);\n\n            var length = Math.min(coordNodes.length, timeNodes.length);\n\n            var positions = [];\n            times = [];\n            for (var x = 0; x < length; x++) {\n                var position = readCoordinate(coordNodes[x].textContent, ellipsoid);\n                positions.push(position);\n                times.push(JulianDate.fromIso8601(timeNodes[x].textContent));\n            }\n\n            if (interpolate) {\n                //If we are interpolating, then we need to fill in the end of\n                //the last track and the beginning of this one with a sampled\n                //property.  From testing in Google Earth, this property\n                //is never extruded and always absolute.\n                if (defined(lastStop)) {\n                    addToMultiTrack([lastStop, times[0]], [lastStopPosition, positions[0]], composite, availability, dropShowProperty, false, 'absolute', undefined, false);\n                }\n                lastStop = times[length - 1];\n                lastStopPosition = positions[positions.length - 1];\n            }\n\n            addToMultiTrack(times, positions, composite, availability, dropShowProperty, canExtrude && extrude, altitudeMode, gxAltitudeMode, true);\n            needDropLine = needDropLine || (canExtrude && extrude);\n        }\n\n        entity.availability = availability;\n        entity.position = composite;\n        processPositionGraphics(dataSource, entity, styleEntity);\n        processPathGraphics(entity, styleEntity);\n        if (needDropLine) {\n            createDropLine(entityCollection, entity, styleEntity);\n            entity.polyline.show = dropShowProperty;\n        }\n\n        return true;\n    }\n\n    var geometryTypes = {\n        Point : processPoint,\n        LineString : processLineStringOrLinearRing,\n        LinearRing : processLineStringOrLinearRing,\n        Polygon : processPolygon,\n        Track : processTrack,\n        MultiTrack : processMultiTrack,\n        MultiGeometry : processMultiGeometry,\n        Model : processUnsupportedGeometry\n    };\n\n    function processMultiGeometry(dataSource, entityCollection, geometryNode, entity, styleEntity, context) {\n        var childNodes = geometryNode.childNodes;\n        var hasGeometry = false;\n        for (var i = 0, len = childNodes.length; i < len; i++) {\n            var childNode = childNodes.item(i);\n            var geometryProcessor = geometryTypes[childNode.localName];\n            if (defined(geometryProcessor)) {\n                var childEntity = createEntity(childNode, entityCollection, context);\n                childEntity.parent = entity;\n                childEntity.name = entity.name;\n                childEntity.availability = entity.availability;\n                childEntity.description = entity.description;\n                childEntity.kml = entity.kml;\n                if (geometryProcessor(dataSource, entityCollection, childNode, childEntity, styleEntity)) {\n                    hasGeometry = true;\n                }\n            }\n        }\n\n        return hasGeometry;\n    }\n\n    function processUnsupportedGeometry(dataSource, entityCollection, geometryNode, entity, styleEntity) {\n        oneTimeWarning('kml-unsupportedGeometry', 'KML - Unsupported geometry: ' + geometryNode.localName);\n        return false;\n    }\n\n    function processExtendedData(node, entity) {\n        var extendedDataNode = queryFirstNode(node, 'ExtendedData', namespaces.kml);\n\n        if (!defined(extendedDataNode)) {\n            return undefined;\n        }\n\n        if (defined(queryFirstNode(extendedDataNode, 'SchemaData', namespaces.kml))) {\n            oneTimeWarning('kml-schemaData', 'KML - SchemaData is unsupported');\n        }\n        if (defined(queryStringAttribute(extendedDataNode, 'xmlns:prefix'))) {\n            oneTimeWarning('kml-extendedData', 'KML - ExtendedData with xmlns:prefix is unsupported');\n        }\n\n        var result = {};\n        var dataNodes = queryChildNodes(extendedDataNode, 'Data', namespaces.kml);\n        if (defined(dataNodes)) {\n            var length = dataNodes.length;\n            for (var i = 0; i < length; i++) {\n                var dataNode = dataNodes[i];\n                var name = queryStringAttribute(dataNode, 'name');\n                if (defined(name)) {\n                    result[name] = {\n                        displayName : queryStringValue(dataNode, 'displayName', namespaces.kml),\n                        value : queryStringValue(dataNode, 'value', namespaces.kml)\n                    };\n                }\n            }\n        }\n        entity.kml.extendedData = result;\n    }\n\n    var scratchDiv;\n    if (typeof document !== 'undefined') {\n        scratchDiv = document.createElement('div');\n    }\n\n    function processDescription(node, entity, styleEntity, uriResolver, sourceResource) {\n        var i;\n        var key;\n        var keys;\n\n        var kmlData = entity.kml;\n        var extendedData = kmlData.extendedData;\n        var description = queryStringValue(node, 'description', namespaces.kml);\n\n        var balloonStyle = defaultValue(entity.balloonStyle, styleEntity.balloonStyle);\n\n        var background = Color.WHITE;\n        var foreground = Color.BLACK;\n        var text = description;\n\n        if (defined(balloonStyle)) {\n            background = defaultValue(balloonStyle.bgColor, Color.WHITE);\n            foreground = defaultValue(balloonStyle.textColor, Color.BLACK);\n            text = defaultValue(balloonStyle.text, description);\n        }\n\n        var value;\n        if (defined(text)) {\n            text = text.replace('$[name]', defaultValue(entity.name, ''));\n            text = text.replace('$[description]', defaultValue(description, ''));\n            text = text.replace('$[address]', defaultValue(kmlData.address, ''));\n            text = text.replace('$[Snippet]', defaultValue(kmlData.snippet, ''));\n            text = text.replace('$[id]', entity.id);\n\n            //While not explicitly defined by the OGC spec, in Google Earth\n            //The appearance of geDirections adds the directions to/from links\n            //We simply replace this string with nothing.\n            text = text.replace('$[geDirections]', '');\n\n            if (defined(extendedData)) {\n                var matches = text.match(/\\$\\[.+?\\]/g);\n                if (matches !== null) {\n                    for (i = 0; i < matches.length; i++) {\n                        var token = matches[i];\n                        var propertyName = token.substr(2, token.length - 3);\n                        var isDisplayName = /\\/displayName$/.test(propertyName);\n                        propertyName = propertyName.replace(/\\/displayName$/, '');\n\n                        value = extendedData[propertyName];\n                        if (defined(value)) {\n                            value = isDisplayName ? value.displayName : value.value;\n                        }\n                        if (defined(value)) {\n                            text = text.replace(token, defaultValue(value, ''));\n                        }\n                    }\n                }\n            }\n        } else if (defined(extendedData)) {\n            //If no description exists, build a table out of the extended data\n            keys = Object.keys(extendedData);\n            if (keys.length > 0) {\n                text = '<table class=\"cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter\"><tbody>';\n                for (i = 0; i < keys.length; i++) {\n                    key = keys[i];\n                    value = extendedData[key];\n                    text += '<tr><th>' + defaultValue(value.displayName, key) + '</th><td>' + defaultValue(value.value, '') + '</td></tr>';\n                }\n                text += '</tbody></table>';\n            }\n        }\n\n        if (!defined(text)) {\n            //No description\n            return;\n        }\n\n        //Turns non-explicit links into clickable links.\n        text = autolinker.link(text);\n\n        //Use a temporary div to manipulate the links\n        //so that they open in a new window.\n        scratchDiv.innerHTML = text;\n        var links = scratchDiv.querySelectorAll('a');\n        for (i = 0; i < links.length; i++) {\n            links[i].setAttribute('target', '_blank');\n        }\n\n        //Rewrite any KMZ embedded urls\n        if (defined(uriResolver) && uriResolver.keys.length > 1) {\n            embedDataUris(scratchDiv, 'a', 'href', uriResolver);\n            embedDataUris(scratchDiv, 'img', 'src', uriResolver);\n        }\n\n        //Make relative urls absolute using the sourceResource\n        applyBasePath(scratchDiv, 'a', 'href', sourceResource);\n        applyBasePath(scratchDiv, 'img', 'src', sourceResource);\n\n        var tmp = '<div class=\"cesium-infoBox-description-lighter\" style=\"';\n        tmp += 'overflow:auto;';\n        tmp += 'word-wrap:break-word;';\n        tmp += 'background-color:' + background.toCssColorString() + ';';\n        tmp += 'color:' + foreground.toCssColorString() + ';';\n        tmp += '\">';\n        tmp += scratchDiv.innerHTML + '</div>';\n        scratchDiv.innerHTML = '';\n\n        //Set the final HTML as the description.\n        entity.description = tmp;\n    }\n\n    function processFeature(dataSource, featureNode, processingData) {\n        var entityCollection = processingData.entityCollection;\n        var parent = processingData.parentEntity;\n        var sourceResource = processingData.sourceResource;\n        var uriResolver = processingData.uriResolver;\n\n        var entity = createEntity(featureNode, entityCollection, processingData.context);\n        var kmlData = entity.kml;\n        var styleEntity = computeFinalStyle(dataSource, featureNode, processingData.styleCollection, sourceResource, uriResolver);\n\n        var name = queryStringValue(featureNode, 'name', namespaces.kml);\n        entity.name = name;\n        entity.parent = parent;\n\n        var availability = processTimeSpan(featureNode);\n        if (!defined(availability)) {\n            availability = processTimeStamp(featureNode);\n        }\n        entity.availability = availability;\n\n        mergeAvailabilityWithParent(entity);\n\n        // Per KML spec \"A Feature is visible only if it and all its ancestors are visible.\"\n        function ancestryIsVisible(parentEntity) {\n            if (!parentEntity) {\n                return true;\n            }\n            return parentEntity.show && ancestryIsVisible(parentEntity.parent);\n        }\n\n        var visibility = queryBooleanValue(featureNode, 'visibility', namespaces.kml);\n        entity.show = ancestryIsVisible(parent) && defaultValue(visibility, true);\n        //var open = queryBooleanValue(featureNode, 'open', namespaces.kml);\n\n        var authorNode = queryFirstNode(featureNode, 'author', namespaces.atom);\n        var author = kmlData.author;\n        author.name = queryStringValue(authorNode, 'name', namespaces.atom);\n        author.uri = queryStringValue(authorNode, 'uri', namespaces.atom);\n        author.email = queryStringValue(authorNode, 'email', namespaces.atom);\n\n        var linkNode = queryFirstNode(featureNode, 'link', namespaces.atom);\n        var link = kmlData.link;\n        link.href = queryStringAttribute(linkNode, 'href');\n        link.hreflang = queryStringAttribute(linkNode, 'hreflang');\n        link.rel = queryStringAttribute(linkNode, 'rel');\n        link.type = queryStringAttribute(linkNode, 'type');\n        link.title = queryStringAttribute(linkNode, 'title');\n        link.length = queryStringAttribute(linkNode, 'length');\n\n        kmlData.address = queryStringValue(featureNode, 'address', namespaces.kml);\n        kmlData.phoneNumber = queryStringValue(featureNode, 'phoneNumber', namespaces.kml);\n        kmlData.snippet = queryStringValue(featureNode, 'Snippet', namespaces.kml);\n\n        processExtendedData(featureNode, entity);\n        processDescription(featureNode, entity, styleEntity, uriResolver, sourceResource);\n\n        var ellipsoid = dataSource._ellipsoid;\n        processLookAt(featureNode, entity, ellipsoid);\n        processCamera(featureNode, entity, ellipsoid);\n\n        if (defined(queryFirstNode(featureNode, 'Region', namespaces.kml))) {\n            oneTimeWarning('kml-region', 'KML - Placemark Regions are unsupported');\n        }\n\n        return {\n            entity : entity,\n            styleEntity : styleEntity\n        };\n    }\n\n    function processDocument(dataSource, node, processingData, deferredLoading) {\n        deferredLoading.addNodes(node.childNodes, processingData);\n        deferredLoading.process();\n    }\n\n    function processFolder(dataSource, node, processingData, deferredLoading) {\n        var r = processFeature(dataSource, node, processingData);\n        var newProcessingData = clone(processingData);\n        newProcessingData.parentEntity = r.entity;\n        processDocument(dataSource, node, newProcessingData, deferredLoading);\n    }\n\n    function processPlacemark(dataSource, placemark, processingData, deferredLoading) {\n        var r = processFeature(dataSource, placemark, processingData);\n        var entity = r.entity;\n        var styleEntity = r.styleEntity;\n\n        var hasGeometry = false;\n        var childNodes = placemark.childNodes;\n        for (var i = 0, len = childNodes.length; i < len && !hasGeometry; i++) {\n            var childNode = childNodes.item(i);\n            var geometryProcessor = geometryTypes[childNode.localName];\n            if (defined(geometryProcessor)) {\n                // pass the placemark entity id as a context for case of defining multiple child entities together to handle case\n                // where some malformed kmls reuse the same id across placemarks, which works in GE, but is not technically to spec.\n                geometryProcessor(dataSource, processingData.entityCollection, childNode, entity, styleEntity, entity.id);\n                hasGeometry = true;\n            }\n        }\n\n        if (!hasGeometry) {\n            entity.merge(styleEntity);\n            processPositionGraphics(dataSource, entity, styleEntity);\n        }\n    }\n\n    var playlistNodeProcessors = {\n        FlyTo: processTourFlyTo,\n        Wait: processTourWait,\n        SoundCue: processTourUnsupportedNode,\n        AnimatedUpdate: processTourUnsupportedNode,\n        TourControl: processTourUnsupportedNode\n    };\n\n    function processTour(dataSource, node, processingData, deferredLoading) {\n        var name = queryStringValue(node, 'name', namespaces.kml);\n        var id = queryStringAttribute(node, 'id');\n        var tour = new KmlTour(name, id);\n\n        var playlistNode = queryFirstNode(node, 'Playlist', namespaces.gx);\n        if(playlistNode) {\n            var ellipsoid = dataSource._ellipsoid;\n            var childNodes = playlistNode.childNodes;\n            for(var i = 0; i < childNodes.length; i++) {\n                var entryNode = childNodes[i];\n                if (entryNode.localName) {\n                    var playlistNodeProcessor = playlistNodeProcessors[entryNode.localName];\n                    if (playlistNodeProcessor) {\n                        playlistNodeProcessor(tour, entryNode, ellipsoid);\n                    }\n                    else {\n                        console.log('Unknown KML Tour playlist entry type ' + entryNode.localName);\n                    }\n                }\n            }\n        }\n\n        if (!defined(dataSource.kmlTours)) {\n            dataSource.kmlTours = [];\n        }\n\n        dataSource.kmlTours.push(tour);\n    }\n\n    function processTourUnsupportedNode(tour, entryNode) {\n        oneTimeWarning('KML Tour unsupported node ' + entryNode.localName);\n    }\n\n    function processTourWait(tour, entryNode) {\n        var duration = queryNumericValue(entryNode, 'duration', namespaces.gx);\n        tour.addPlaylistEntry(new KmlTourWait(duration));\n    }\n\n    function processTourFlyTo(tour, entryNode, ellipsoid) {\n        var duration = queryNumericValue(entryNode, 'duration', namespaces.gx);\n        var flyToMode = queryStringValue(entryNode, 'flyToMode', namespaces.gx);\n\n        var t = {kml: {}};\n\n        processLookAt(entryNode, t, ellipsoid);\n        processCamera(entryNode, t, ellipsoid);\n\n        var view = t.kml.lookAt || t.kml.camera;\n\n        var flyto = new KmlTourFlyTo(duration, flyToMode, view);\n        tour.addPlaylistEntry(flyto);\n    }\n\n    function processCamera(featureNode, entity, ellipsoid) {\n        var camera = queryFirstNode(featureNode, 'Camera', namespaces.kml);\n        if(defined(camera)) {\n            var lon = defaultValue(queryNumericValue(camera, 'longitude', namespaces.kml), 0.0);\n            var lat = defaultValue(queryNumericValue(camera, 'latitude', namespaces.kml), 0.0);\n            var altitude = defaultValue(queryNumericValue(camera, 'altitude', namespaces.kml), 0.0);\n\n            var heading = defaultValue(queryNumericValue(camera, 'heading', namespaces.kml), 0.0);\n            var tilt = defaultValue(queryNumericValue(camera, 'tilt', namespaces.kml), 0.0);\n            var roll = defaultValue(queryNumericValue(camera, 'roll', namespaces.kml), 0.0);\n\n            var position = Cartesian3.fromDegrees(lon, lat, altitude, ellipsoid);\n            var hpr = HeadingPitchRoll.fromDegrees(heading, tilt - 90.0, roll);\n\n            entity.kml.camera = new KmlCamera(position, hpr);\n        }\n    }\n\n    function processLookAt(featureNode, entity, ellipsoid) {\n        var lookAt = queryFirstNode(featureNode, 'LookAt', namespaces.kml);\n        if(defined(lookAt)) {\n            var lon = defaultValue(queryNumericValue(lookAt, 'longitude', namespaces.kml), 0.0);\n            var lat = defaultValue(queryNumericValue(lookAt, 'latitude', namespaces.kml), 0.0);\n            var altitude = defaultValue(queryNumericValue(lookAt, 'altitude', namespaces.kml), 0.0);\n            var heading = queryNumericValue(lookAt, 'heading', namespaces.kml);\n            var tilt = queryNumericValue(lookAt, 'tilt', namespaces.kml);\n            var range = defaultValue(queryNumericValue(lookAt, 'range', namespaces.kml), 0.0);\n\n            tilt = CesiumMath.toRadians(defaultValue(tilt, 0.0));\n            heading = CesiumMath.toRadians(defaultValue(heading, 0.0));\n\n            var hpr = new HeadingPitchRange(heading, tilt - CesiumMath.PI_OVER_TWO, range);\n            var viewPoint = Cartesian3.fromDegrees(lon, lat, altitude, ellipsoid);\n\n            entity.kml.lookAt = new KmlLookAt(viewPoint, hpr);\n        }\n    }\n\n    function processGroundOverlay(dataSource, groundOverlay, processingData, deferredLoading) {\n        var r = processFeature(dataSource, groundOverlay, processingData);\n        var entity = r.entity;\n\n        var geometry;\n        var isLatLonQuad = false;\n\n        var ellipsoid = dataSource._ellipsoid;\n        var positions = readCoordinates(queryFirstNode(groundOverlay, 'LatLonQuad', namespaces.gx), ellipsoid);\n        var zIndex = queryNumericValue(groundOverlay, 'drawOrder', namespaces.kml);\n        if (defined(positions)) {\n            geometry = createDefaultPolygon();\n            geometry.hierarchy = new PolygonHierarchy(positions);\n            geometry.zIndex = zIndex;\n            entity.polygon = geometry;\n            isLatLonQuad = true;\n        } else {\n            geometry = new RectangleGraphics();\n            geometry.zIndex = zIndex;\n            entity.rectangle = geometry;\n\n            var latLonBox = queryFirstNode(groundOverlay, 'LatLonBox', namespaces.kml);\n            if (defined(latLonBox)) {\n                var west = queryNumericValue(latLonBox, 'west', namespaces.kml);\n                var south = queryNumericValue(latLonBox, 'south', namespaces.kml);\n                var east = queryNumericValue(latLonBox, 'east', namespaces.kml);\n                var north = queryNumericValue(latLonBox, 'north', namespaces.kml);\n\n                if (defined(west)) {\n                    west = CesiumMath.negativePiToPi(CesiumMath.toRadians(west));\n                }\n                if (defined(south)) {\n                    south = CesiumMath.clampToLatitudeRange(CesiumMath.toRadians(south));\n                }\n                if (defined(east)) {\n                    east = CesiumMath.negativePiToPi(CesiumMath.toRadians(east));\n                }\n                if (defined(north)) {\n                    north = CesiumMath.clampToLatitudeRange(CesiumMath.toRadians(north));\n                }\n                geometry.coordinates = new Rectangle(west, south, east, north);\n\n                var rotation = queryNumericValue(latLonBox, 'rotation', namespaces.kml);\n                if (defined(rotation)) {\n                    var rotationRadians = CesiumMath.toRadians(rotation);\n                    geometry.rotation = rotationRadians;\n                    geometry.stRotation = rotationRadians;\n                }\n            }\n        }\n\n        var iconNode = queryFirstNode(groundOverlay, 'Icon', namespaces.kml);\n        var href = getIconHref(iconNode, dataSource, processingData.sourceResource, processingData.uriResolver, true);\n        if (defined(href)) {\n            if (isLatLonQuad) {\n                oneTimeWarning('kml-gx:LatLonQuad', 'KML - gx:LatLonQuad Icon does not support texture projection.');\n            }\n            var x = queryNumericValue(iconNode, 'x', namespaces.gx);\n            var y = queryNumericValue(iconNode, 'y', namespaces.gx);\n            var w = queryNumericValue(iconNode, 'w', namespaces.gx);\n            var h = queryNumericValue(iconNode, 'h', namespaces.gx);\n\n            if (defined(x) || defined(y) || defined(w) || defined(h)) {\n                oneTimeWarning('kml-groundOverlay-xywh', 'KML - gx:x, gx:y, gx:w, gx:h aren\\'t supported for GroundOverlays');\n            }\n\n            geometry.material = href;\n            geometry.material.color = queryColorValue(groundOverlay, 'color', namespaces.kml);\n            geometry.material.transparent = true;\n        } else {\n            geometry.material = queryColorValue(groundOverlay, 'color', namespaces.kml);\n        }\n\n        var altitudeMode = queryStringValue(groundOverlay, 'altitudeMode', namespaces.kml);\n\n        if (defined(altitudeMode)) {\n            if (altitudeMode === 'absolute') {\n                //Use height above ellipsoid until we support MSL.\n                geometry.height = queryNumericValue(groundOverlay, 'altitude', namespaces.kml);\n                geometry.zIndex = undefined;\n            } else if (altitudeMode !== 'clampToGround') {\n                oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + altitudeMode);\n            }\n            // else just use the default of 0 until we support 'clampToGround'\n        } else {\n            altitudeMode = queryStringValue(groundOverlay, 'altitudeMode', namespaces.gx);\n            if (altitudeMode === 'relativeToSeaFloor') {\n                oneTimeWarning('kml-altitudeMode-relativeToSeaFloor', 'KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute.');\n                geometry.height = queryNumericValue(groundOverlay, 'altitude', namespaces.kml);\n                geometry.zIndex = undefined;\n            } else if (altitudeMode === 'clampToSeaFloor') {\n                oneTimeWarning('kml-altitudeMode-clampToSeaFloor', 'KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround.');\n            } else if (defined(altitudeMode)) {\n                oneTimeWarning('kml-altitudeMode-unknown', 'KML - Unknown altitudeMode: ' + altitudeMode);\n            }\n        }\n    }\n\n    function processUnsupportedFeature(dataSource, node, processingData, deferredLoading) {\n        dataSource._unsupportedNode.raiseEvent(dataSource, processingData.parentEntity, node, processingData.entityCollection,\n            processingData.styleCollection, processingData.sourceResource, processingData.uriResolver);\n        oneTimeWarning('kml-unsupportedFeature-' + node.nodeName, 'KML - Unsupported feature: ' + node.nodeName);\n    }\n\n    var RefreshMode = {\n        INTERVAL : 0,\n        EXPIRE : 1,\n        STOP : 2\n    };\n\n    function cleanupString(s) {\n        if (!defined(s) || s.length === 0) {\n            return '';\n        }\n\n        var sFirst = s[0];\n        if (sFirst === '&' || sFirst === '?') {\n            s = s.substring(1);\n        }\n\n        return s;\n    }\n\n    var zeroRectangle = new Rectangle();\n    var scratchCartographic = new Cartographic();\n    var scratchCartesian2 = new Cartesian2();\n    var scratchCartesian3 = new Cartesian3();\n\n    function processNetworkLinkQueryString(resource, camera, canvas, viewBoundScale, bbox, ellipsoid) {\n        function fixLatitude(value) {\n            if (value < -CesiumMath.PI_OVER_TWO) {\n                return -CesiumMath.PI_OVER_TWO;\n            } else if (value > CesiumMath.PI_OVER_TWO) {\n                return CesiumMath.PI_OVER_TWO;\n            }\n            return value;\n        }\n\n        function fixLongitude(value) {\n            if (value > CesiumMath.PI) {\n                return value - CesiumMath.TWO_PI;\n            } else if (value < -CesiumMath.PI) {\n                return value + CesiumMath.TWO_PI;\n            }\n\n            return value;\n        }\n\n        var queryString = objectToQuery(resource.queryParameters);\n\n        // objectToQuery escapes [ and ], so fix that\n        queryString = queryString.replace(/%5B/g, '[').replace(/%5D/g, ']');\n\n        if (defined(camera) && camera._mode !== SceneMode.MORPHING) {\n            var centerCartesian;\n            var centerCartographic;\n\n            bbox = defaultValue(bbox, zeroRectangle);\n            if (defined(canvas)) {\n                scratchCartesian2.x = canvas.clientWidth * 0.5;\n                scratchCartesian2.y = canvas.clientHeight * 0.5;\n                centerCartesian = camera.pickEllipsoid(scratchCartesian2, ellipsoid, scratchCartesian3);\n            }\n\n            if (defined(centerCartesian)) {\n                centerCartographic = ellipsoid.cartesianToCartographic(centerCartesian, scratchCartographic);\n            } else {\n                centerCartographic = Rectangle.center(bbox, scratchCartographic);\n                centerCartesian = ellipsoid.cartographicToCartesian(centerCartographic);\n            }\n\n            if (defined(viewBoundScale) && !CesiumMath.equalsEpsilon(viewBoundScale, 1.0, CesiumMath.EPSILON9)) {\n                var newHalfWidth = bbox.width * viewBoundScale * 0.5;\n                var newHalfHeight = bbox.height * viewBoundScale * 0.5;\n                bbox = new Rectangle(fixLongitude(centerCartographic.longitude - newHalfWidth),\n                    fixLatitude(centerCartographic.latitude - newHalfHeight),\n                    fixLongitude(centerCartographic.longitude + newHalfWidth),\n                    fixLatitude(centerCartographic.latitude + newHalfHeight)\n                );\n            }\n\n            queryString = queryString.replace('[bboxWest]', CesiumMath.toDegrees(bbox.west).toString());\n            queryString = queryString.replace('[bboxSouth]', CesiumMath.toDegrees(bbox.south).toString());\n            queryString = queryString.replace('[bboxEast]', CesiumMath.toDegrees(bbox.east).toString());\n            queryString = queryString.replace('[bboxNorth]', CesiumMath.toDegrees(bbox.north).toString());\n\n            var lon = CesiumMath.toDegrees(centerCartographic.longitude).toString();\n            var lat = CesiumMath.toDegrees(centerCartographic.latitude).toString();\n            queryString = queryString.replace('[lookatLon]', lon);\n            queryString = queryString.replace('[lookatLat]', lat);\n            queryString = queryString.replace('[lookatTilt]', CesiumMath.toDegrees(camera.pitch).toString());\n            queryString = queryString.replace('[lookatHeading]', CesiumMath.toDegrees(camera.heading).toString());\n            queryString = queryString.replace('[lookatRange]', Cartesian3.distance(camera.positionWC, centerCartesian));\n            queryString = queryString.replace('[lookatTerrainLon]', lon);\n            queryString = queryString.replace('[lookatTerrainLat]', lat);\n            queryString = queryString.replace('[lookatTerrainAlt]', centerCartographic.height.toString());\n\n            ellipsoid.cartesianToCartographic(camera.positionWC, scratchCartographic);\n            queryString = queryString.replace('[cameraLon]', CesiumMath.toDegrees(scratchCartographic.longitude).toString());\n            queryString = queryString.replace('[cameraLat]', CesiumMath.toDegrees(scratchCartographic.latitude).toString());\n            queryString = queryString.replace('[cameraAlt]', CesiumMath.toDegrees(scratchCartographic.height).toString());\n\n            var frustum = camera.frustum;\n            var aspectRatio = frustum.aspectRatio;\n            var horizFov = '';\n            var vertFov = '';\n            if (defined(aspectRatio)) {\n                var fov = CesiumMath.toDegrees(frustum.fov);\n                if (aspectRatio > 1.0) {\n                    horizFov = fov;\n                    vertFov = fov / aspectRatio;\n                } else {\n                    vertFov = fov;\n                    horizFov = fov * aspectRatio;\n                }\n            }\n            queryString = queryString.replace('[horizFov]', horizFov.toString());\n            queryString = queryString.replace('[vertFov]', vertFov.toString());\n        } else {\n            queryString = queryString.replace('[bboxWest]', '-180');\n            queryString = queryString.replace('[bboxSouth]', '-90');\n            queryString = queryString.replace('[bboxEast]', '180');\n            queryString = queryString.replace('[bboxNorth]', '90');\n\n            queryString = queryString.replace('[lookatLon]', '');\n            queryString = queryString.replace('[lookatLat]', '');\n            queryString = queryString.replace('[lookatRange]', '');\n            queryString = queryString.replace('[lookatTilt]', '');\n            queryString = queryString.replace('[lookatHeading]', '');\n            queryString = queryString.replace('[lookatTerrainLon]', '');\n            queryString = queryString.replace('[lookatTerrainLat]', '');\n            queryString = queryString.replace('[lookatTerrainAlt]', '');\n\n            queryString = queryString.replace('[cameraLon]', '');\n            queryString = queryString.replace('[cameraLat]', '');\n            queryString = queryString.replace('[cameraAlt]', '');\n            queryString = queryString.replace('[horizFov]', '');\n            queryString = queryString.replace('[vertFov]', '');\n        }\n\n        if (defined(canvas)) {\n            queryString = queryString.replace('[horizPixels]', canvas.clientWidth);\n            queryString = queryString.replace('[vertPixels]', canvas.clientHeight);\n        } else {\n            queryString = queryString.replace('[horizPixels]', '');\n            queryString = queryString.replace('[vertPixels]', '');\n        }\n\n        queryString = queryString.replace('[terrainEnabled]', '1');\n        queryString = queryString.replace('[clientVersion]', '1');\n        queryString = queryString.replace('[kmlVersion]', '2.2');\n        queryString = queryString.replace('[clientName]', 'Cesium');\n        queryString = queryString.replace('[language]', 'English');\n\n        resource.setQueryParameters(queryToObject(queryString));\n    }\n\n    function processNetworkLink(dataSource, node, processingData, deferredLoading) {\n        var r = processFeature(dataSource, node, processingData);\n        var networkEntity = r.entity;\n\n        var sourceResource = processingData.sourceResource;\n        var uriResolver = processingData.uriResolver;\n\n        var link = queryFirstNode(node, 'Link', namespaces.kml);\n\n        if (!defined(link)) {\n            link = queryFirstNode(node, 'Url', namespaces.kml);\n        }\n        if (defined(link)) {\n            var href = queryStringValue(link, 'href', namespaces.kml);\n            var viewRefreshMode;\n            var viewBoundScale;\n            if (defined(href)) {\n                var newSourceUri = href;\n                href = resolveHref(href, sourceResource, processingData.uriResolver);\n\n                // We need to pass in the original path if resolveHref returns a data uri because the network link\n                //  references a document in a KMZ archive\n                if (/^data:/.test(href.getUrlComponent())) {\n                    // So if sourceUri isn't the kmz file, then its another kml in the archive, so resolve it\n                    if (!/\\.kmz/i.test(sourceResource.getUrlComponent())) {\n                        newSourceUri = sourceResource.getDerivedResource({\n                            url: newSourceUri\n                        });\n                    }\n                } else {\n                    newSourceUri = href.clone(); // Not a data uri so use the fully qualified uri\n                    viewRefreshMode = queryStringValue(link, 'viewRefreshMode', namespaces.kml);\n                    viewBoundScale = defaultValue(queryStringValue(link, 'viewBoundScale', namespaces.kml), 1.0);\n                    var defaultViewFormat = (viewRefreshMode === 'onStop') ? 'BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]' : '';\n                    var viewFormat = defaultValue(queryStringValue(link, 'viewFormat', namespaces.kml), defaultViewFormat);\n                    var httpQuery = queryStringValue(link, 'httpQuery', namespaces.kml);\n                    if (defined(viewFormat)) {\n                        href.setQueryParameters(queryToObject(cleanupString(viewFormat)));\n                    }\n                    if (defined(httpQuery)) {\n                        href.setQueryParameters(queryToObject(cleanupString(httpQuery)));\n                    }\n\n                    var ellipsoid = dataSource._ellipsoid;\n                    processNetworkLinkQueryString(href, dataSource._camera, dataSource._canvas, viewBoundScale, dataSource._lastCameraView.bbox, ellipsoid);\n                }\n\n                var options = {\n                    sourceUri : newSourceUri,\n                    uriResolver : uriResolver,\n                    context : networkEntity.id\n                };\n                var networkLinkCollection = new EntityCollection();\n                var promise = load(dataSource, networkLinkCollection, href, options).then(function(rootElement) {\n                    var entities = dataSource._entityCollection;\n                    var newEntities = networkLinkCollection.values;\n                    entities.suspendEvents();\n                    for (var i = 0; i < newEntities.length; i++) {\n                        var newEntity = newEntities[i];\n                        if (!defined(newEntity.parent)) {\n                            newEntity.parent = networkEntity;\n                            mergeAvailabilityWithParent(newEntity);\n                        }\n\n                        entities.add(newEntity);\n                    }\n                    entities.resumeEvents();\n\n                    // Add network links to a list if we need they will need to be updated\n                    var refreshMode = queryStringValue(link, 'refreshMode', namespaces.kml);\n                    var refreshInterval = defaultValue(queryNumericValue(link, 'refreshInterval', namespaces.kml), 0);\n                    if ((refreshMode === 'onInterval' && refreshInterval > 0 ) || (refreshMode === 'onExpire') || (viewRefreshMode === 'onStop')) {\n                        var networkLinkControl = queryFirstNode(rootElement, 'NetworkLinkControl', namespaces.kml);\n                        var hasNetworkLinkControl = defined(networkLinkControl);\n\n                        var now = JulianDate.now();\n                        var networkLinkInfo = {\n                            id : createGuid(),\n                            href : href,\n                            cookie : {},\n                            lastUpdated : now,\n                            updating : false,\n                            entity : networkEntity,\n                            viewBoundScale : viewBoundScale,\n                            needsUpdate : false,\n                            cameraUpdateTime : now\n                        };\n\n                        var minRefreshPeriod = 0;\n                        if (hasNetworkLinkControl) {\n                            networkLinkInfo.cookie = queryToObject(defaultValue(queryStringValue(networkLinkControl, 'cookie', namespaces.kml), ''));\n                            minRefreshPeriod = defaultValue(queryNumericValue(networkLinkControl, 'minRefreshPeriod', namespaces.kml), 0);\n                        }\n\n                        if (refreshMode === 'onInterval') {\n                            if (hasNetworkLinkControl) {\n                                refreshInterval = Math.max(minRefreshPeriod, refreshInterval);\n                            }\n                            networkLinkInfo.refreshMode = RefreshMode.INTERVAL;\n                            networkLinkInfo.time = refreshInterval;\n                        } else if (refreshMode === 'onExpire') {\n                            var expires;\n                            if (hasNetworkLinkControl) {\n                                expires = queryStringValue(networkLinkControl, 'expires', namespaces.kml);\n                            }\n                            if (defined(expires)) {\n                                try {\n                                    var date = JulianDate.fromIso8601(expires);\n                                    var diff = JulianDate.secondsDifference(date, now);\n                                    if (diff > 0 && diff < minRefreshPeriod) {\n                                        JulianDate.addSeconds(now, minRefreshPeriod, date);\n                                    }\n                                    networkLinkInfo.refreshMode = RefreshMode.EXPIRE;\n                                    networkLinkInfo.time = date;\n                                } catch (e) {\n                                    oneTimeWarning('kml-refreshMode-onInterval-onExpire', 'KML - NetworkLinkControl expires is not a valid date');\n                                }\n                            } else {\n                                oneTimeWarning('kml-refreshMode-onExpire', 'KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element');\n                            }\n                        } else if (dataSource._camera) { // Only allow onStop refreshes if we have a camera\n                            networkLinkInfo.refreshMode = RefreshMode.STOP;\n                            networkLinkInfo.time = defaultValue(queryNumericValue(link, 'viewRefreshTime', namespaces.kml), 0);\n                        } else {\n                            oneTimeWarning('kml-refrehMode-onStop-noCamera', 'A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource');\n                        }\n\n                        if (defined(networkLinkInfo.refreshMode)) {\n                            dataSource._networkLinks.set(networkLinkInfo.id, networkLinkInfo);\n                        }\n                    } else if (viewRefreshMode === 'onRegion') {\n                        oneTimeWarning('kml-refrehMode-onRegion', 'KML - Unsupported viewRefreshMode: onRegion');\n                    }\n                }).otherwise(function(error) {\n                    oneTimeWarning('An error occured during loading ' + href.url);\n                    dataSource._error.raiseEvent(dataSource, error);\n                });\n\n                deferredLoading.addPromise(promise);\n            }\n        }\n    }\n\n    function processFeatureNode(dataSource, node, processingData, deferredLoading) {\n        var featureProcessor = featureTypes[node.localName];\n        if (defined(featureProcessor)) {\n            return featureProcessor(dataSource, node, processingData, deferredLoading);\n        }\n\n        return processUnsupportedFeature(dataSource, node, processingData, deferredLoading);\n    }\n\n    function loadKml(dataSource, entityCollection, kml, sourceResource, uriResolver, context) {\n        entityCollection.removeAll();\n\n        var documentElement = kml.documentElement;\n        var document = documentElement.localName === 'Document' ? documentElement : queryFirstNode(documentElement, 'Document', namespaces.kml);\n        var name = queryStringValue(document, 'name', namespaces.kml);\n        if (!defined(name)) {\n            name = getFilenameFromUri(sourceResource.getUrlComponent());\n        }\n\n        // Only set the name from the root document\n        if (!defined(dataSource._name)) {\n            dataSource._name = name;\n        }\n\n        var deferredLoading = new KmlDataSource._DeferredLoading(dataSource);\n        var styleCollection = new EntityCollection(dataSource);\n        return when.all(processStyles(dataSource, kml, styleCollection, sourceResource, false, uriResolver)).then(function() {\n            var element = kml.documentElement;\n            if (element.localName === 'kml') {\n                var childNodes = element.childNodes;\n                for (var i = 0; i < childNodes.length; i++) {\n                    var tmp = childNodes[i];\n                    if (defined(featureTypes[tmp.localName])) {\n                        element = tmp;\n                        break;\n                    }\n                }\n            }\n\n            var processingData = {\n                parentEntity: undefined,\n                entityCollection: entityCollection,\n                styleCollection: styleCollection,\n                sourceResource: sourceResource,\n                uriResolver: uriResolver,\n                context: context\n            };\n\n            entityCollection.suspendEvents();\n            processFeatureNode(dataSource, element, processingData, deferredLoading);\n            entityCollection.resumeEvents();\n\n            return deferredLoading.wait()\n                .then(function() {\n                    return kml.documentElement;\n                });\n        });\n    }\n\n    function loadKmz(dataSource, entityCollection, blob, sourceResource) {\n        var deferred = when.defer();\n        zip.createReader(new zip.BlobReader(blob), function(reader) {\n            reader.getEntries(function(entries) {\n                var promises = [];\n                var uriResolver = {};\n                var docEntry;\n                var docDefer;\n                for (var i = 0; i < entries.length; i++) {\n                    var entry = entries[i];\n                    if (!entry.directory) {\n                        var innerDefer = when.defer();\n                        promises.push(innerDefer.promise);\n                        if (/\\.kml$/i.test(entry.filename)) {\n                            // We use the first KML document we come across\n                            //  https://developers.google.com/kml/documentation/kmzarchives\n                            // Unless we come across a .kml file at the root of the archive because GE does this\n                            if (!defined(docEntry) || !/\\//i.test(entry.filename)) {\n                                if (defined(docEntry)) {\n                                    // We found one at the root so load the initial kml as a data uri\n                                    loadDataUriFromZip(docEntry, uriResolver, docDefer);\n                                }\n                                docEntry = entry;\n                                docDefer = innerDefer;\n                            } else {\n                                // Wasn't the first kml and wasn't at the root\n                                loadDataUriFromZip(entry, uriResolver, innerDefer);\n                            }\n                        } else {\n                            loadDataUriFromZip(entry, uriResolver, innerDefer);\n                        }\n                    }\n                }\n\n                // Now load the root KML document\n                if (defined(docEntry)) {\n                    loadXmlFromZip(docEntry, uriResolver, docDefer);\n                }\n                when.all(promises).then(function() {\n                    reader.close();\n                    if (!defined(uriResolver.kml)) {\n                        deferred.reject(new RuntimeError('KMZ file does not contain a KML document.'));\n                        return;\n                    }\n                    uriResolver.keys = Object.keys(uriResolver);\n                    return loadKml(dataSource, entityCollection, uriResolver.kml, sourceResource, uriResolver);\n                }).then(deferred.resolve).otherwise(deferred.reject);\n            });\n        }, function(e) {\n            deferred.reject(e);\n        });\n\n        return deferred.promise;\n    }\n\n    function load(dataSource, entityCollection, data, options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var sourceUri = options.sourceUri;\n        var uriResolver = options.uriResolver;\n        var context = options.context;\n\n        var promise = data;\n        if (typeof data === 'string' || (data instanceof Resource)) {\n            data = Resource.createIfNeeded(data);\n            promise = data.fetchBlob();\n            sourceUri = defaultValue(sourceUri, data.clone());\n\n            // Add resource credits to our list of credits to display\n            var resourceCredits = dataSource._resourceCredits;\n            var credits = data.credits;\n            if (defined(credits)) {\n                var length = credits.length;\n                for (var i = 0; i < length; i++) {\n                    resourceCredits.push(credits[i]);\n                }\n            }\n        } else {\n            sourceUri = defaultValue(sourceUri, Resource.DEFAULT.clone());\n        }\n\n        sourceUri = Resource.createIfNeeded(sourceUri);\n\n        return when(promise)\n            .then(function(dataToLoad) {\n                if (dataToLoad instanceof Blob) {\n                    return isZipFile(dataToLoad).then(function(isZip) {\n                        if (isZip) {\n                            return loadKmz(dataSource, entityCollection, dataToLoad, sourceUri);\n                        }\n                        return readBlobAsText(dataToLoad).then(function(text) {\n                            //There's no official way to validate if a parse was successful.\n                            //The following check detects the error on various browsers.\n\n                            //Insert missing namespaces\n                            text = insertNamespaces(text);\n\n                            //Remove Duplicate Namespaces\n                            text = removeDuplicateNamespaces(text);\n\n                            //IE raises an exception\n                            var kml;\n                            var error;\n                            try {\n                                kml = parser.parseFromString(text, 'application/xml');\n                            } catch (e) {\n                                error = e.toString();\n                            }\n\n                            //The parse succeeds on Chrome and Firefox, but the error\n                            //handling is different in each.\n                            if (defined(error) || kml.body || kml.documentElement.tagName === 'parsererror') {\n                                //Firefox has error information as the firstChild nodeValue.\n                                var msg = defined(error) ? error : kml.documentElement.firstChild.nodeValue;\n\n                                //Chrome has it in the body text.\n                                if (!msg) {\n                                    msg = kml.body.innerText;\n                                }\n\n                                //Return the error\n                                throw new RuntimeError(msg);\n                            }\n                            return loadKml(dataSource, entityCollection, kml, sourceUri, uriResolver, context);\n                        });\n                    });\n                }\n                return loadKml(dataSource, entityCollection, dataToLoad, sourceUri, uriResolver, context);\n            })\n            .otherwise(function(error) {\n                dataSource._error.raiseEvent(dataSource, error);\n                console.log(error);\n                return when.reject(error);\n            });\n    }\n\n    /**\n     * A {@link DataSource} which processes Keyhole Markup Language 2.2 (KML).\n     * <p>\n     * KML support in Cesium is incomplete, but a large amount of the standard,\n     * as well as Google's <code>gx</code> extension namespace, is supported. See Github issue\n     * {@link https://github.com/AnalyticalGraphicsInc/cesium/issues/873|#873} for a\n     * detailed list of what is and isn't support. Cesium will also write information to the\n     * console when it encounters most unsupported features.\n     * </p>\n     * <p>\n     * Non visual feature data, such as <code>atom:author</code> and <code>ExtendedData</code>\n     * is exposed via an instance of {@link KmlFeatureData}, which is added to each {@link Entity}\n     * under the <code>kml</code> property.\n     * </p>\n     *\n     * @alias KmlDataSource\n     * @constructor\n     *\n     * @param {Object} options An object with the following properties:\n     * @param {Camera} options.camera The camera that is used for viewRefreshModes and sending camera properties to network links.\n     * @param {Canvas} options.canvas The canvas that is used for sending viewer properties to network links.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     *\n     * @see {@link http://www.opengeospatial.org/standards/kml/|Open Geospatial Consortium KML Standard}\n     * @see {@link https://developers.google.com/kml/|Google KML Documentation}\n     *\n     * @demo {@link https://sandcastle.cesium.com/index.html?src=KML.html|Cesium Sandcastle KML Demo}\n     *\n     * @example\n     * var viewer = new Cesium.Viewer('cesiumContainer');\n     * viewer.dataSources.add(Cesium.KmlDataSource.load('../../SampleData/facilities.kmz',\n     *      {\n     *           camera: viewer.scene.camera,\n     *           canvas: viewer.scene.canvas\n     *      })\n     * );\n     */\n    function KmlDataSource(options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var camera = options.camera;\n        var canvas = options.canvas;\n\n        \n\n        this._changed = new Event();\n        this._error = new Event();\n        this._loading = new Event();\n        this._refresh = new Event();\n        this._unsupportedNode = new Event();\n\n        this._clock = undefined;\n        this._entityCollection = new EntityCollection(this);\n        this._name = undefined;\n        this._isLoading = false;\n        this._pinBuilder = new PinBuilder();\n        this._networkLinks = new AssociativeArray();\n        this._entityCluster = new EntityCluster();\n\n        this._canvas = canvas;\n        this._camera = camera;\n        this._lastCameraView = {\n            position : defined(camera) ? Cartesian3.clone(camera.positionWC) : undefined,\n            direction : defined(camera) ? Cartesian3.clone(camera.directionWC) : undefined,\n            up : defined(camera) ? Cartesian3.clone(camera.upWC) : undefined,\n            bbox : defined(camera) ? camera.computeViewRectangle() : Rectangle.clone(Rectangle.MAX_VALUE)\n        };\n\n        this._ellipsoid = defaultValue(options.ellipsoid, Ellipsoid.WGS84);\n\n        // User specified credit\n        var credit = options.credit;\n        if (typeof credit === 'string') {\n            credit = new Credit(credit);\n        }\n        this._credit = credit;\n\n        // Create a list of Credit's from the resource that the user can't remove\n        this._resourceCredits = [];\n    }\n\n    /**\n     * Creates a Promise to a new instance loaded with the provided KML data.\n     *\n     * @param {Resource|String|Document|Blob} data A url, parsed KML document, or Blob containing binary KMZ data or a parsed KML document.\n     * @param {Object} options An object with the following properties:\n     * @param {Camera} options.camera The camera that is used for viewRefreshModes and sending camera properties to network links.\n     * @param {Canvas} options.canvas The canvas that is used for sending viewer properties to network links.\n     * @param {String} [options.sourceUri] Overrides the url to use for resolving relative links and other KML network features.\n     * @param {Boolean} [options.clampToGround=false] true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     * @param {Credit|String} [options.credit] A credit for the data source, which is displayed on the canvas.\n     *\n     * @returns {Promise.<KmlDataSource>} A promise that will resolve to a new KmlDataSource instance once the KML is loaded.\n     */\n    KmlDataSource.load = function(data, options) {\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        var dataSource = new KmlDataSource(options);\n        return dataSource.load(data, options);\n    };\n\n    defineProperties(KmlDataSource.prototype, {\n        /**\n         * Gets or sets a human-readable name for this instance.\n         * This will be automatically be set to the KML document name on load.\n         * @memberof KmlDataSource.prototype\n         * @type {String}\n         */\n        name : {\n            get : function() {\n                return this._name;\n            },\n            set : function(value) {\n                if (this._name !== value) {\n                    this._name = value;\n                    this._changed.raiseEvent(this);\n                }\n            }\n        },\n        /**\n         * Gets the clock settings defined by the loaded KML. This represents the total\n         * availability interval for all time-dynamic data. If the KML does not contain\n         * time-dynamic data, this value is undefined.\n         * @memberof KmlDataSource.prototype\n         * @type {DataSourceClock}\n         */\n        clock : {\n            get : function() {\n                return this._clock;\n            }\n        },\n        /**\n         * Gets the collection of {@link Entity} instances.\n         * @memberof KmlDataSource.prototype\n         * @type {EntityCollection}\n         */\n        entities : {\n            get : function() {\n                return this._entityCollection;\n            }\n        },\n        /**\n         * Gets a value indicating if the data source is currently loading data.\n         * @memberof KmlDataSource.prototype\n         * @type {Boolean}\n         */\n        isLoading : {\n            get : function() {\n                return this._isLoading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the underlying data changes.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        changedEvent : {\n            get : function() {\n                return this._changed;\n            }\n        },\n        /**\n         * Gets an event that will be raised if an error is encountered during processing.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        errorEvent : {\n            get : function() {\n                return this._error;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source either starts or stops loading.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        loadingEvent : {\n            get : function() {\n                return this._loading;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source refreshes a network link.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        refreshEvent : {\n            get : function() {\n                return this._refresh;\n            }\n        },\n        /**\n         * Gets an event that will be raised when the data source finds an unsupported node type.\n         * @memberof KmlDataSource.prototype\n         * @type {Event}\n         */\n        unsupportedNodeEvent : {\n            get : function() {\n                return this._unsupportedNode;\n            }\n        },\n        /**\n         * Gets whether or not this data source should be displayed.\n         * @memberof KmlDataSource.prototype\n         * @type {Boolean}\n         */\n        show : {\n            get : function() {\n                return this._entityCollection.show;\n            },\n            set : function(value) {\n                this._entityCollection.show = value;\n            }\n        },\n\n        /**\n         * Gets or sets the clustering options for this data source. This object can be shared between multiple data sources.\n         *\n         * @memberof KmlDataSource.prototype\n         * @type {EntityCluster}\n         */\n        clustering : {\n            get : function() {\n                return this._entityCluster;\n            },\n            set : function(value) {\n                \n                this._entityCluster = value;\n            }\n        },\n        /**\n         * Gets the credit that will be displayed for the data source\n         * @memberof KmlDataSource.prototype\n         * @type {Credit}\n         */\n        credit : {\n            get : function() {\n                return this._credit;\n            }\n        }\n    });\n\n    /**\n     * Asynchronously loads the provided KML data, replacing any existing data.\n     *\n     * @param {Resource|String|Document|Blob} data A url, parsed KML document, or Blob containing binary KMZ data or a parsed KML document.\n     * @param {Object} [options] An object with the following properties:\n     * @param {Resource|String} [options.sourceUri] Overrides the url to use for resolving relative links and other KML network features.\n     * @param {Boolean} [options.clampToGround=false] true if we want the geometry features (Polygons, LineStrings and LinearRings) clamped to the ground. If true, lines will use corridors so use Entity.corridor instead of Entity.polyline.\n     * @param {Ellipsoid} [options.ellipsoid=Ellipsoid.WGS84] The global ellipsoid used for geographical calculations.\n     *\n     * @returns {Promise.<KmlDataSource>} A promise that will resolve to this instances once the KML is loaded.\n     */\n    KmlDataSource.prototype.load = function(data, options) {\n        \n\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\n        DataSource.setLoading(this, true);\n\n        var oldName = this._name;\n        this._name = undefined;\n        this._clampToGround = defaultValue(options.clampToGround, false);\n\n        var that = this;\n        return load(this, this._entityCollection, data, options).then(function() {\n            var clock;\n\n            var availability = that._entityCollection.computeAvailability();\n\n            var start = availability.start;\n            var stop = availability.stop;\n            var isMinStart = JulianDate.equals(start, Iso8601.MINIMUM_VALUE);\n            var isMaxStop = JulianDate.equals(stop, Iso8601.MAXIMUM_VALUE);\n            if (!isMinStart || !isMaxStop) {\n                var date;\n\n                //If start is min time just start at midnight this morning, local time\n                if (isMinStart) {\n                    date = new Date();\n                    date.setHours(0, 0, 0, 0);\n                    start = JulianDate.fromDate(date);\n                }\n\n                //If stop is max value just stop at midnight tonight, local time\n                if (isMaxStop) {\n                    date = new Date();\n                    date.setHours(24, 0, 0, 0);\n                    stop = JulianDate.fromDate(date);\n                }\n\n                clock = new DataSourceClock();\n                clock.startTime = start;\n                clock.stopTime = stop;\n                clock.currentTime = JulianDate.clone(start);\n                clock.clockRange = ClockRange.LOOP_STOP;\n                clock.clockStep = ClockStep.SYSTEM_CLOCK_MULTIPLIER;\n                clock.multiplier = Math.round(Math.min(Math.max(JulianDate.secondsDifference(stop, start) / 60, 1), 3.15569e7));\n            }\n\n            var changed = false;\n            if (clock !== that._clock) {\n                that._clock = clock;\n                changed = true;\n            }\n\n            if (oldName !== that._name) {\n                changed = true;\n            }\n\n            if (changed) {\n                that._changed.raiseEvent(that);\n            }\n\n            DataSource.setLoading(that, false);\n\n            return that;\n        }).otherwise(function(error) {\n            DataSource.setLoading(that, false);\n            that._error.raiseEvent(that, error);\n            console.log(error);\n            return when.reject(error);\n        });\n    };\n\n    function mergeAvailabilityWithParent(child) {\n        var parent = child.parent;\n        if (defined(parent)) {\n            var parentAvailability = parent.availability;\n            if (defined(parentAvailability)) {\n                var childAvailability = child.availability;\n                if (defined(childAvailability)) {\n                    childAvailability.intersect(parentAvailability);\n                } else {\n                    child.availability = parentAvailability;\n                }\n            }\n        }\n    }\n\n    function getNetworkLinkUpdateCallback(dataSource, networkLink, newEntityCollection, networkLinks, processedHref) {\n        return function(rootElement) {\n            if (!networkLinks.contains(networkLink.id)) {\n                // Got into the odd case where a parent network link was updated while a child\n                //  network link update was in flight, so just throw it away.\n                return;\n            }\n            var remove = false;\n            var networkLinkControl = queryFirstNode(rootElement, 'NetworkLinkControl', namespaces.kml);\n            var hasNetworkLinkControl = defined(networkLinkControl);\n\n            var minRefreshPeriod = 0;\n            if (hasNetworkLinkControl) {\n                if (defined(queryFirstNode(networkLinkControl, 'Update', namespaces.kml))) {\n                    oneTimeWarning('kml-networkLinkControl-update', 'KML - NetworkLinkControl updates aren\\'t supported.');\n                    networkLink.updating = false;\n                    networkLinks.remove(networkLink.id);\n                    return;\n                }\n                networkLink.cookie = queryToObject(defaultValue(queryStringValue(networkLinkControl, 'cookie', namespaces.kml), ''));\n                minRefreshPeriod = defaultValue(queryNumericValue(networkLinkControl, 'minRefreshPeriod', namespaces.kml), 0);\n            }\n\n            var now = JulianDate.now();\n            var refreshMode = networkLink.refreshMode;\n            if (refreshMode === RefreshMode.INTERVAL) {\n                if (defined(networkLinkControl)) {\n                    networkLink.time = Math.max(minRefreshPeriod, networkLink.time);\n                }\n            } else if (refreshMode === RefreshMode.EXPIRE) {\n                var expires;\n                if (defined(networkLinkControl)) {\n                    expires = queryStringValue(networkLinkControl, 'expires', namespaces.kml);\n                }\n                if (defined(expires)) {\n                    try {\n                        var date = JulianDate.fromIso8601(expires);\n                        var diff = JulianDate.secondsDifference(date, now);\n                        if (diff > 0 && diff < minRefreshPeriod) {\n                            JulianDate.addSeconds(now, minRefreshPeriod, date);\n                        }\n                        networkLink.time = date;\n                    } catch (e) {\n                        oneTimeWarning('kml-networkLinkControl-expires', 'KML - NetworkLinkControl expires is not a valid date');\n                        remove = true;\n                    }\n                } else {\n                    oneTimeWarning('kml-refreshMode-onExpire', 'KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element');\n                    remove = true;\n                }\n            }\n\n            var networkLinkEntity = networkLink.entity;\n            var entityCollection = dataSource._entityCollection;\n            var newEntities = newEntityCollection.values;\n\n            function removeChildren(entity) {\n                entityCollection.remove(entity);\n                var children = entity._children;\n                var count = children.length;\n                for (var i = 0; i < count; ++i) {\n                    removeChildren(children[i]);\n                }\n            }\n\n            // Remove old entities\n            entityCollection.suspendEvents();\n            var entitiesCopy = entityCollection.values.slice();\n            var i;\n            for (i = 0; i < entitiesCopy.length; ++i) {\n                var entityToRemove = entitiesCopy[i];\n                if (entityToRemove.parent === networkLinkEntity) {\n                    entityToRemove.parent = undefined;\n                    removeChildren(entityToRemove);\n                }\n            }\n            entityCollection.resumeEvents();\n\n            // Add new entities\n            entityCollection.suspendEvents();\n            for (i = 0; i < newEntities.length; i++) {\n                var newEntity = newEntities[i];\n                if (!defined(newEntity.parent)) {\n                    newEntity.parent = networkLinkEntity;\n                    mergeAvailabilityWithParent(newEntity);\n                }\n                entityCollection.add(newEntity);\n            }\n            entityCollection.resumeEvents();\n\n            // No refresh information remove it, otherwise update lastUpdate time\n            if (remove) {\n                networkLinks.remove(networkLink.id);\n            } else {\n                networkLink.lastUpdated = now;\n            }\n\n            var availability = entityCollection.computeAvailability();\n\n            var start = availability.start;\n            var stop = availability.stop;\n            var isMinStart = JulianDate.equals(start, Iso8601.MINIMUM_VALUE);\n            var isMaxStop = JulianDate.equals(stop, Iso8601.MAXIMUM_VALUE);\n            if (!isMinStart || !isMaxStop) {\n                var clock = dataSource._clock;\n\n                if (clock.startTime !== start || clock.stopTime !== stop) {\n                    clock.startTime = start;\n                    clock.stopTime = stop;\n                    dataSource._changed.raiseEvent(dataSource);\n                }\n            }\n\n            networkLink.updating = false;\n            networkLink.needsUpdate = false;\n            dataSource._refresh.raiseEvent(dataSource, processedHref.getUrlComponent(true));\n        };\n    }\n\n    var entitiesToIgnore = new AssociativeArray();\n\n    /**\n     * Updates any NetworkLink that require updating\n     * @function\n     *\n     * @param {JulianDate} time The simulation time.\n     * @returns {Boolean} True if this data source is ready to be displayed at the provided time, false otherwise.\n     */\n    KmlDataSource.prototype.update = function(time) {\n        var networkLinks = this._networkLinks;\n        if (networkLinks.length === 0) {\n            return true;\n        }\n\n        var now = JulianDate.now();\n        var that = this;\n\n        entitiesToIgnore.removeAll();\n\n        function recurseIgnoreEntities(entity) {\n            var children = entity._children;\n            var count = children.length;\n            for (var i = 0; i < count; ++i) {\n                var child = children[i];\n                entitiesToIgnore.set(child.id, child);\n                recurseIgnoreEntities(child);\n            }\n        }\n\n        var cameraViewUpdate = false;\n        var lastCameraView = this._lastCameraView;\n        var camera = this._camera;\n        if (defined(camera) &&\n            !(camera.positionWC.equalsEpsilon(lastCameraView.position, CesiumMath.EPSILON7) &&\n            camera.directionWC.equalsEpsilon(lastCameraView.direction, CesiumMath.EPSILON7) &&\n            camera.upWC.equalsEpsilon(lastCameraView.up, CesiumMath.EPSILON7))) {\n\n            // Camera has changed so update the last view\n            lastCameraView.position = Cartesian3.clone(camera.positionWC);\n            lastCameraView.direction = Cartesian3.clone(camera.directionWC);\n            lastCameraView.up = Cartesian3.clone(camera.upWC);\n            lastCameraView.bbox = camera.computeViewRectangle();\n            cameraViewUpdate = true;\n        }\n\n        var newNetworkLinks = new AssociativeArray();\n        var changed = false;\n        networkLinks.values.forEach(function(networkLink) {\n            var entity = networkLink.entity;\n            if (entitiesToIgnore.contains(entity.id)) {\n                return;\n            }\n\n            if (!networkLink.updating) {\n                var doUpdate = false;\n                if (networkLink.refreshMode === RefreshMode.INTERVAL) {\n                    if (JulianDate.secondsDifference(now, networkLink.lastUpdated) > networkLink.time) {\n                        doUpdate = true;\n                    }\n                }\n                else if (networkLink.refreshMode === RefreshMode.EXPIRE) {\n                    if (JulianDate.greaterThan(now, networkLink.time)) {\n                        doUpdate = true;\n                    }\n\n                } else if (networkLink.refreshMode === RefreshMode.STOP) {\n                    if (cameraViewUpdate) {\n                        networkLink.needsUpdate = true;\n                        networkLink.cameraUpdateTime = now;\n                    }\n\n                    if (networkLink.needsUpdate && JulianDate.secondsDifference(now, networkLink.cameraUpdateTime) >= networkLink.time) {\n                        doUpdate = true;\n                    }\n                }\n\n                if (doUpdate) {\n                    recurseIgnoreEntities(entity);\n                    networkLink.updating = true;\n                    var newEntityCollection = new EntityCollection();\n                    var href = networkLink.href.clone();\n\n                    href.setQueryParameters(networkLink.cookie);\n                    var ellipsoid = defaultValue(that._ellipsoid, Ellipsoid.WGS84);\n                    processNetworkLinkQueryString(href, that._camera, that._canvas, networkLink.viewBoundScale, lastCameraView.bbox, ellipsoid);\n\n                    load(that, newEntityCollection, href, {context : entity.id})\n                        .then(getNetworkLinkUpdateCallback(that, networkLink, newEntityCollection, newNetworkLinks, href))\n                        .otherwise(function(error) {\n                            var msg = 'NetworkLink ' + networkLink.href + ' refresh failed: ' + error;\n                            console.log(msg);\n                            that._error.raiseEvent(that, msg);\n                        });\n                    changed = true;\n                }\n            }\n            newNetworkLinks.set(networkLink.id, networkLink);\n        });\n\n        if (changed) {\n            this._networkLinks = newNetworkLinks;\n            this._changed.raiseEvent(this);\n        }\n\n        return true;\n    };\n\n    /**\n     * Contains KML Feature data loaded into the <code>Entity.kml</code> property by {@link KmlDataSource}.\n     * @alias KmlFeatureData\n     * @constructor\n     */\n    function KmlFeatureData() {\n        /**\n         * Gets the atom syndication format author field.\n         * @type Object\n         */\n        this.author = {\n            /**\n             * Gets the name.\n             * @type String\n             * @alias author.name\n             * @memberof! KmlFeatureData#\n             * @property author.name\n             */\n            name : undefined,\n            /**\n             * Gets the URI.\n             * @type String\n             * @alias author.uri\n             * @memberof! KmlFeatureData#\n             * @property author.uri\n             */\n            uri : undefined,\n            /**\n             * Gets the email.\n             * @type String\n             * @alias author.email\n             * @memberof! KmlFeatureData#\n             * @property author.email\n             */\n            email : undefined\n        };\n\n        /**\n         * Gets the link.\n         * @type Object\n         */\n        this.link = {\n            /**\n             * Gets the href.\n             * @type String\n             * @alias link.href\n             * @memberof! KmlFeatureData#\n             * @property link.href\n             */\n            href : undefined,\n            /**\n             * Gets the language of the linked resource.\n             * @type String\n             * @alias link.hreflang\n             * @memberof! KmlFeatureData#\n             * @property link.hreflang\n             */\n            hreflang : undefined,\n            /**\n             * Gets the link relation.\n             * @type String\n             * @alias link.rel\n             * @memberof! KmlFeatureData#\n             * @property link.rel\n             */\n            rel : undefined,\n            /**\n             * Gets the link type.\n             * @type String\n             * @alias link.type\n             * @memberof! KmlFeatureData#\n             * @property link.type\n             */\n            type : undefined,\n            /**\n             * Gets the link title.\n             * @type String\n             * @alias link.title\n             * @memberof! KmlFeatureData#\n             * @property link.title\n             */\n            title : undefined,\n            /**\n             * Gets the link length.\n             * @type String\n             * @alias link.length\n             * @memberof! KmlFeatureData#\n             * @property link.length\n             */\n            length : undefined\n        };\n\n        /**\n         * Gets the unstructured address field.\n         * @type String\n         */\n        this.address = undefined;\n        /**\n         * Gets the phone number.\n         * @type String\n         */\n        this.phoneNumber = undefined;\n        /**\n         * Gets the snippet.\n         * @type String\n         */\n        this.snippet = undefined;\n        /**\n         * Gets the extended data, parsed into a JSON object.\n         * Currently only the <code>Data</code> property is supported.\n         * <code>SchemaData</code> and custom data are ignored.\n         * @type String\n         */\n        this.extendedData = undefined;\n    }\n\n    // For testing\n    KmlDataSource._DeferredLoading = DeferredLoading;\n    KmlDataSource._getTimestamp = getTimestamp;\n\nexport default KmlDataSource;\n"],"sourceRoot":""}