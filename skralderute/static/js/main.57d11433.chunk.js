(this.webpackJsonppuma=this.webpackJsonppuma||[]).push([[0],{125:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(9),l=a.n(o),i=(a(96),a(97),a(70)),c=a(170),u=a(172),s=a(29),d=Object(i.a)((function(e){return{root:{flexGrow:1},appbar:{backgroundColor:"rgb(37, 167, 167)"},title:{flexGrow:1,textAlign:"center",fontFamily:"'Fredericka the Great', cursive"}}}));function m(){var e=d();return r.a.createElement("div",{className:e.root},r.a.createElement(c.a,{position:"static",className:e.appbar},r.a.createElement(u.a,null,r.a.createElement(s.a,{variant:"h4",className:e.title},"TRIPPIN"))))}var p=a(14),g=a(178),f=a(174),b=a(177),v=a(176),y=a(175),h=a(173),E=a(73),w=a.n(E),j=Object(i.a)((function(e){return{button:{position:"fixed",bottom:15,right:10,zIndex:200,backgroundColor:"rgb(37, 167, 167)"}}}));function k(){var e=j(),t=r.a.useState(!1),a=Object(p.a)(t,2),n=a[0],o=a[1],l=function(){o(!1)};return r.a.createElement("div",null,r.a.createElement(h.a,{className:e.button,color:"primary","aria-label":"add",onClick:function(){o(!0)}},r.a.createElement(w.a,{fontSize:"large"})),r.a.createElement(f.a,{open:n,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(y.a,{id:"alert-dialog-title"},"Velkommen"),r.a.createElement(v.a,null,r.a.createElement("p",null,"Ruteoptimering til t\xf8mning af glascontainere ud fra fyldningsgrad som m\xe5les med sensorer"),r.a.createElement("ul",null,r.a.createElement("li",null,"Tryk p\xe5 ",r.a.createElement("img",{alt:"trafic",width:"25px",src:"data:image/svg+xml;charset=utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22%23333333%22%20preserveAspectRatio%3D%22xMidYMid%20meet%22%20viewBox%3D%22-2%20-2%2022%2022%22%3E%0D%0A%3Cpath%20d%3D%22M13%2C4.1L12%2C3H6L5%2C4.1l-2%2C9.8L4%2C15h10l1-1.1L13%2C4.1z%20M10%2C13H8v-3h2V13z%20M10%2C8H8V5h2V8z%22%2F%3E%0D%0A%3C%2Fsvg%3E"})," for at f\xe5 vist trafikken")),r.a.createElement("p",null,"Bruger ",r.a.createElement("a",{href:"http://project-osrm.org/",target:"_blank",rel:"noopener noreferrer"},"OSRM")," til at l\xf8se Travelling Salesman problemet med data fra Open Street Map.")),r.a.createElement(b.a,null,r.a.createElement(g.a,{onClick:l,color:"primary",autoFocus:!0},"Ok"))))}var C=a(17),x=a(50),O=a.n(x),S=a(74),M=a.n(S),F=a(51),N=a.n(F),L=function(e){return r.a.createElement("div",{className:"route-info"},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Antal stops"),r.a.createElement("td",null,e.stops)),r.a.createElement("tr",null,r.a.createElement("td",null,"L\xe6ngde"),r.a.createElement("td",null,e.distance," km")),r.a.createElement("tr",null,r.a.createElement("td",null,"Tid"),r.a.createElement("td",null,e.duration)))))},z=a(49),T=a(194),A=a(179),D=a(180),B=a(181),_=a(182),I=a(75),R=a.n(I),V=Object(i.a)({header:{textAlign:"center",margin:0,padding:17,color:"white",backgroundColor:"rgb(37, 167, 167)"},list:{width:250},btn:{position:"fixed",bottom:85,right:10,zIndex:100,backgroundColor:"rgb(37, 167, 167)"}});function W(e){var t,a=V(),n=r.a.useState({top:!1,left:!1,bottom:!1,right:!1}),o=Object(p.a)(n,2),l=o[0],i=o[1],c=function(e,t){return function(a){("keydown"!==a.type||"Tab"!==a.key&&"Shift"!==a.key)&&i(Object(C.a)({},l,Object(z.a)({},e,t)))}};return r.a.createElement("div",null,r.a.createElement(h.a,{className:a.btn,color:"primary","aria-label":"add",onClick:c("right",!0)},r.a.createElement(R.a,{fontSize:"large"})),r.a.createElement(T.a,{anchor:"right",open:l.right,onClose:c("right",!1)},(t="right",r.a.createElement("div",{className:a.list,role:"presentation",onClick:c(t,!1),onKeyDown:c(t,!1)},r.a.createElement("h3",{className:a.header},"Stop p\xe5 ruten"),r.a.createElement(A.a,null),r.a.createElement(D.a,null,e.waypoints.sort((function(e,t){return e.waypoint_index>t.waypoint_index?1:-1})).map((function(t,a){return r.a.createElement(B.a,{button:!0,key:a,onMouseEnter:function(){return e.entered(t)},onMouseLeave:function(){return e.leaved(t)},onClick:function(){return e.clicked([t.lng,t.lat])}},r.a.createElement(_.a,{primary:t.address?"".concat(t.waypoint_index,". ").concat(t.address.split(",")[0]):"".concat(t.waypoint_index,". Ukendt vejnavn")}))})))))))}var J=a(183),P=a(185),Z=a(184),G=a(186),H=a(76),Y=a.n(H),q=Object(i.a)((function(e){return{root:{width:"100%",color:"white"},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12},valueCell:{wordBreak:"break-word",padding:"8px !important"}}}));function K(e){var t=q();"string"===typeof e.data.location?JSON.parse(e.data.location):e.data.location;var a=e.data.lat,n=e.data.lng;return r.a.createElement("div",{className:t.root},r.a.createElement(J.a,{className:t.card,variant:"outlined"},r.a.createElement(Z.a,null,r.a.createElement(s.a,{className:t.title,color:"textPrimary",gutterBottom:!0},"Fyldningsgrad: ",e.data.waste_distance,"%"),r.a.createElement(s.a,{className:t.title,color:"textSecondary",gutterBottom:!0},e.data.address.split(",")[0])),r.a.createElement(P.a,null,r.a.createElement(G.a,{style:{marginLeft:"auto"},onClick:function(){return window.open("http://maps.google.com?daddr=".concat(a,",").concat(n,"&amp;ll="))},size:"small"},r.a.createElement(Y.a,null)))))}var U=a(4),$=a(195),X=Object(i.a)({root:{width:400,maxWidth:"calc(80vw - 45px) !important",position:"fixed",bottom:10,left:10,margin:"auto",zIndex:100,backgroundColor:"rgba(255,255,255,0.3)",padding:20,color:"grey"},button:{backgroundColor:"rgb(22,200,200)"}}),Q=Object(U.a)({root:{color:"grey",background:"linear-gradient(90deg, rgba(4,252,35,1) 0%, rgba(255,250,6,1) 50%, rgba(247,0,0,1) 100%)",paddingTop:3,paddingBottom:3,borderRadius:10,height:8},thumb:{height:24,width:24,backgroundColor:"#fff",border:"2px solid currentColor",marginTop:-8,marginLeft:-12,"&:focus,&:hover,&$active":{boxShadow:"inherit"}},active:{},valueLabel:{left:"calc(-50% + 4px)"},track:{top:5,height:4,borderRadius:4},rail:{top:5,height:4,borderRadius:4}})($.a);function ee(e){return"".concat(e,"%")}function te(e){var t=X(),a=r.a.useState([0,100]),n=Object(p.a)(a,2),o=n[0],l=n[1];return r.a.createElement("div",{className:t.root},r.a.createElement(s.a,{style:{textAlign:"center"},id:"range-slider",gutterBottom:!0},"Fyldningsgrad"),r.a.createElement(Q,{value:o,onChange:function(t,a){l(a),e.changed(a[0],a[1])},valueLabelDisplay:"on","aria-labelledby":"range-slider",getAriaValueText:ee}))}var ae=a(187),ne=Object(U.a)({colorPrimary:{backgroundColor:"#b2dfdb"},barColorPrimary:{backgroundColor:"#00695c"}})(ae.a),re=Object(i.a)((function(e){return{root:{position:"fixed",top:56,zIndex:1,width:"100%"}}}));function oe(){var e=re();return r.a.createElement("div",{className:e.root},r.a.createElement(ne,null))}var le=a(188),ie=a(190),ce=a(192),ue=a(191),se=a(193),de=a(189),me=Object(i.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2),backgroundColor:"rgb(22,200,200)"}}}));function pe(e){var t=me(),a=r.a.useState(!0),n=Object(p.a)(a,2),o=n[0],l=n[1],i=r.a.useState({}),c=Object(p.a)(i,2),u=c[0],s=c[1];return r.a.createElement("div",null,r.a.createElement(f.a,{open:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(v.a,null,r.a.createElement(le.a,{id:"alert-dialog-description"},r.a.createElement(de.a,{component:"main",maxWidth:"xs"},r.a.createElement(ie.a,null),r.a.createElement("div",{className:t.paper},r.a.createElement("form",{className:t.form,noValidate:!0},r.a.createElement(ce.a,{onChange:function(e){s(Object(C.a)({},u,{user:e.target.value}))},variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"user",label:"Brugernavn",name:"user",autoComplete:"user",autoFocus:!0}),r.a.createElement(ce.a,{onChange:function(e){s(Object(C.a)({},u,{password:e.target.value}))},variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Kodeord",type:"password",id:"password",autoComplete:"current-password"}),r.a.createElement(ue.a,{control:r.a.createElement(se.a,{value:"remember",color:"primary"}),label:"Husk mig"}),r.a.createElement(g.a,{fullWidth:!0,type:"submit",variant:"contained",color:"primary",className:t.submit,onClick:function(t){t.preventDefault(),l(!1),e.clicked(u)}},"Log ind"))))))))}var ge=a(77),fe=a.n(ge),be=a(37),ve={mapboxAccessToken:"pk.eyJ1IjoiZnJlZGVyaWtzYmVyZy1naXMiLCJhIjoiY2sydm5nZDRjMDZoMDNobzd5aDV1MGhzZiJ9.vnExgTJMSYvWSFA3FsBlRA",wasteControl:{url:"https://api.wastecontrol.dk"},osrm:{url:"https://rute.frb-data.dk",origin:[12.49771,55.669111]}},ye=(a(123),a(124),{width:"100vw",height:"calc(100vh - 56px)",position:"absolute"}),he={layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"rgb(22,200,200)","line-width":4}},Ee={layout:{"text-field":["get","waypoint_index"],"text-font":["Open Sans Regular","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#6F6F6F"}},we={layout:{},paint:{"circle-radius":10,"circle-color":{property:"waste_distance",stops:[[0,"rgb(4,252,35)"],[50,"rgb(255,250,6)"],[100,"rgb(247,0,0)"]]}}},je=function(){var e=Object(n.useState)(),t=Object(p.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(),c=Object(p.a)(i,2),u=c[0],s=c[1],d=Object(n.useState)([]),m=Object(p.a)(d,2),g=m[0],f=m[1],b=Object(n.useState)([]),v=Object(p.a)(b,2),y=v[0],h=v[1],E=Object(n.useState)(),w=Object(p.a)(E,2),j=w[0],k=w[1],x=Object(n.useState)(!1),S=Object(p.a)(x,2),F=S[0],z=S[1],T=Object(n.useState)(),A=Object(p.a)(T,2),D=A[0],B=A[1],_=Object(n.useRef)(null);Object(n.useEffect)((function(){O.a.accessToken=ve.mapboxAccessToken;a||function(e){var t=e.setMap,a=e.mapContainer,n=new O.a.Map({container:a.current,style:"mapbox://styles/mapbox/light-v10",center:[12.52489,55.68168],zoom:13,attributionControl:!1});n.on("load",(function(){t(n),n.resize(),n.addControl(new M.a,"top-left"),n.on("click","containers",(function(e){u&&(u.remove(),s(null)),n.getCanvas().style.cursor="pointer",R(n,r.a.createElement(K,{data:e.features[0].properties}),e.lngLat)})),n.on("mouseenter","containers",(function(e){n.getCanvas().style.cursor="pointer"})),n.on("mouseleave","containers",(function(){n.getCanvas().style.cursor=""}))}))}({setMap:o,mapContainer:_})}),[a,u]),Object(n.useEffect)((function(){D&&(localStorage.setItem("waste_jwt",D),V(D))}),[D]),Object(n.useEffect)((function(){a&&G(a,["containers","containersLabel","route"]);var e=g.filter((function(e){return!0===e.include}));if(e.length>0){var t=P(e,"lat","lng");G(a,"containers"),Z(a,"containers","circle",t,we.layout,we.paint);var n=e.map((function(e){return[e.lng,e.lat]}));J(a,n).then((function(t){var n=Object(p.a)(t,2),r=n[0],o=n[1];Z(a,"route","line",o,he.layout,he.paint);var l=e.map((function(e){var t=fe()(Object(be.point)([e.lng,e.lat],Object(C.a)({},e)),r);return Object(C.a)({},e,{waypoint_index:t.properties.waypoint_index,location:[e.lng,e.lat]})}));h(l),Z(a,"containersLabel","symbol",P(l,"lat","lng"),Ee.layout,Ee.paint)}))}}),[g]);var I,R=function(e,t,a){var n=document.createElement("div");l.a.render(t,n);var r=new O.a.Popup({closeButton:!0}).setDOMContent(n).setLngLat(a).addTo(e);return s(r),r},V=function(e){z(!0),N.a.get(ve.wasteControl.url+"/containers",{params:{},headers:{Authorization:"Bearer "+e}}).then((function(e){var t=e.data.map((function(e){return Object(C.a)({},e,{include:!0})}));f(t),z(!1)})).catch((function(e){console.log(e)}))},J=function(e,t){z(!0);var a="".concat(ve.osrm.url,"/trip/v1/driving/").concat(ve.osrm.origin,";").concat(t.join(";"),"?roundtrip=true&geometries=geojson&overview=full");return N.a.get(a).then((function(e){var t=Math.round(e.data.trips[0].distance/1e3*10)/10,a=e.data.trips[0].duration/60,n="".concat(Math.floor(a/60)," h ").concat(Math.round(a%60)," min");k({stops:e.data.waypoints.length-1,distance:t,duration:n});var r={type:"FeatureCollection",features:e.data.waypoints.map((function(e){return Object(C.a)({},e,{index:e.waypoint_index+1})})).map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:e.location},properties:Object(C.a)({},e)}}))},o=e.data.trips[0].geometry;return z(!1),[r,o]}))},P=function(e,t,a){return{type:"FeatureCollection",features:e.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e[a],e[t]]},properties:Object(C.a)({},e)}}))}},Z=function(e,t,a,n){for(var r,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},i=e.getStyle().layers,c=0;c<i.length;c++)if("symbol"===i[c].type){r=i[c].id;break}e.addSource(t,{type:"geojson",data:n}),e.addLayer({id:t,type:a,source:t,layout:o,paint:l},"line"===a?r:null)},G=function(e,t){Array.isArray(t)?t.forEach((function(t){e.getSource(t)&&(e.removeLayer(t),e.removeSource(t))})):e.getSource(t)&&(e.removeLayer(t),e.removeSource(t))};return r.a.createElement("div",null,r.a.createElement(pe,{clicked:function(e){!function(e){N.a.post(ve.wasteControl.url+"/login",{username:e.user,password:e.password}).then((function(e){return B(e.data.token)})).catch((function(e){return console.log(e)}))}(e)}}),r.a.createElement("div",{ref:function(e){return _.current=e},style:ye},F?r.a.createElement(oe,null):null,j?r.a.createElement(L,{stops:j.stops,distance:j.distance,duration:j.duration}):null,y.length>0?r.a.createElement(W,{waypoints:y,entered:function(e){u&&(u.remove(),s(null)),R(a,r.a.createElement(K,{data:e}),e.location),a.flyTo({center:e.location})},leaved:function(){u.remove(),s(null)},clicked:function(e){a.flyTo({center:e,zoom:16})}}):null,r.a.createElement(te,{changed:function(e,t){I&&clearTimeout(I),I=setTimeout((function(){var a=g.map((function(a){return a.waste_distance>=e&&a.waste_distance<=t?Object(C.a)({},a,{include:!0}):Object(C.a)({},a,{include:!1})}));f(a)}),300)}})))},ke=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(m,null),r.a.createElement(k,null),r.a.createElement(je,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(ke,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},91:function(e,t,a){e.exports=a(125)},96:function(e,t,a){},97:function(e,t,a){}},[[91,1,2]]]);
//# sourceMappingURL=main.57d11433.chunk.js.map